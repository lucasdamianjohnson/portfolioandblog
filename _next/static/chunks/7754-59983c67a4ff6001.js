"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7754],{81523:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return o}});let n=r(18993);function o(e){let{reason:t,children:r}=e;if("undefined"==typeof window)throw new n.BailoutToCSRError(t);return r}},70049:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return i}});let n=r(57437),o=r(20544);function i(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let r=(0,o.getExpectedRequestStore)("next/dynamic css"),i=[];if(r.reactLoadableManifest&&t){let e=r.reactLoadableManifest;for(let r of t){if(!e[r])continue;let t=e[r].files.filter(e=>e.endsWith(".css"));i.push(...t)}}return 0===i.length?null:(0,n.jsx)(n.Fragment,{children:i.map(e=>(0,n.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:r.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},60599:function(e,t,r){r.d(t,{g:function(){return o}});var n=r(79290);function o(e,t,r,o){let i=class extends n.ShaderMaterial{constructor(i={}){let l=Object.entries(e);super({uniforms:l.reduce((e,[t,r])=>{let o=n.UniformsUtils.clone({[t]:{value:r}});return{...e,...o}},{}),vertexShader:t,fragmentShader:r}),this.key="",l.forEach(([e])=>Object.defineProperty(this,e,{get:()=>this.uniforms[e].value,set:t=>this.uniforms[e].value=t})),Object.assign(this,i),o&&o(this)}};return i.key=n.MathUtils.generateUUID(),i}},26961:function(e,t,r){r.d(t,{dv:function(){return Y},ib:function(){return eh},wI:function(){return et}});var n=r(68014),o=r(71329),i=r(2265),l=r(79290),a=r(16467),c=r(43224);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach(function(t){!function(e,t,r){var n;(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let u=new l.Quaternion;new l.Euler;let f=new l.Vector3;new l.Object3D;let p=new l.Matrix4,m=new l.Vector3,v=new l.Quaternion,y=new l.Vector3,g=e=>{let[t,r,n]=e;return new l.Vector3(t,r,n)},b=({x:e,y:t,z:r,w:n})=>u.set(e,t,r,n),h=e=>Array.isArray(e)?new n.Vector3(e[0],e[1],e[2]):"number"==typeof e?new n.Vector3(e,e,e):new n.Vector3(e.x,e.y,e.z),E={fixed:1,dynamic:0,kinematicPosition:2,kinematicVelocity:3},x=e=>E[e],C=(e,t)=>{let r=Array.from(e);for(let n=0;n<e.length/3;n++)r[3*n]*=t.x,r[3*n+1]*=t.y,r[3*n+2]*=t.z;return r},w=e=>e?e instanceof l.Quaternion?[e.x,e.y,e.z,e.w]:e instanceof l.Vector3||e instanceof l.Euler?[e.x,e.y,e.z]:Array.isArray(e)?e:[e]:[0];function j(e){let t=(0,i.useRef)();return void 0===t.current&&(t.current={value:"function"==typeof e?e():e}),t.current.value}let M=e=>{let t=(0,i.useRef)(e),r=(0,i.useRef)(0),n=(0,i.useRef)(0);(0,i.useEffect)(()=>{t.current=e},[e]),(0,i.useEffect)(()=>{let e=()=>{let o=performance.now(),i=o-n.current;r.current=requestAnimationFrame(e),t.current(i/1e3),n.current=o};return r.current=requestAnimationFrame(e),()=>cancelAnimationFrame(r.current)},[])},R=({onStep:e,updatePriority:t})=>((0,o.F)((t,r)=>{e(r)},t),null),S=({onStep:e})=>(M(t=>{e(t)}),null);var P=(0,i.memo)(({onStep:e,type:t,updatePriority:r})=>"independent"===t?i.createElement(S,{onStep:e}):i.createElement(R,{onStep:e,updatePriority:r}));function F(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if(({}).hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.includes(r)||({}).propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}let O=["mass","linearDamping","angularDamping","type","onCollisionEnter","onCollisionExit","onIntersectionEnter","onIntersectionExit","onContactForce","children","canSleep","ccd","gravityScale","softCcdPrediction"],B=(e,t,r)=>{let n=t.slice();if("heightfield"===e){let e=n[3];return e.x*=r.x,e.x*=r.y,e.x*=r.z,n}if("trimesh"===e||"convexHull"===e)return n[0]=C(n[0],r),n;let o=[r.x,r.y,r.z,r.x,r.x];return n.map((e,t)=>o[t]*e)},D=(e,t,r,o)=>{let i=B(e.shape,e.args,r),l=n.ColliderDesc[e.shape](...i);return t.createCollider(l,null==o?void 0:o())},A=["shape","args"],I="Please pick ONLY ONE of the `density`, `mass` and `massProperties` options.",k=(e,t)=>{if(void 0!==t.density){if(void 0!==t.mass||void 0!==t.massProperties)throw Error(I);e.setDensity(t.density);return}if(void 0!==t.mass){if(void 0!==t.massProperties)throw Error(I);e.setMass(t.mass);return}void 0!==t.massProperties&&e.setMassProperties(t.massProperties.mass,t.massProperties.centerOfMass,t.massProperties.principalAngularInertia,t.massProperties.angularInertiaLocalFrame)},T={sensor:(e,t)=>{e.setSensor(t)},collisionGroups:(e,t)=>{e.setCollisionGroups(t)},solverGroups:(e,t)=>{e.setSolverGroups(t)},friction:(e,t)=>{e.setFriction(t)},frictionCombineRule:(e,t)=>{e.setFrictionCombineRule(t)},restitution:(e,t)=>{e.setRestitution(t)},restitutionCombineRule:(e,t)=>{e.setRestitutionCombineRule(t)},activeCollisionTypes:(e,t)=>{e.setActiveCollisionTypes(t)},contactSkin:(e,t)=>{e.setContactSkin(t)},quaternion:()=>{},position:()=>{},rotation:()=>{},scale:()=>{}},N=Object.keys(T),W=(e,t,r)=>{let n=r.get(e.handle);if(n){var o;let r=n.object.parent.getWorldScale(f),i=null===(o=n.worldParent)||void 0===o?void 0:o.matrixWorld.clone().invert();n.object.updateWorldMatrix(!0,!1),p.copy(n.object.matrixWorld),i&&p.premultiply(i),p.decompose(m,v,y),e.parent()?(e.setTranslationWrtParent({x:m.x*r.x,y:m.y*r.y,z:m.z*r.z}),e.setRotationWrtParent(v)):(e.setTranslation({x:m.x*r.x,y:m.y*r.y,z:m.z*r.z}),e.setRotation(v)),N.forEach(r=>{if(r in t){let n=t[r];T[r](e,n,t)}}),k(e,t)}},z=(e,t,r)=>{let n=(0,i.useMemo)(()=>N.flatMap(e=>w(t[e])),[t]);(0,i.useEffect)(()=>{W(e(),t,r)},[...n,e])},V=e=>{let t=!1;return e.traverseAncestors(e=>{"MeshCollider"===e.userData.r3RapierType&&(t=!0)}),t},_=(e,t,r)=>({collider:e,worldParent:r||void 0,object:t}),q={cuboid:"cuboid",ball:"ball",hull:"convexHull",trimesh:"trimesh"},L=({object:e,ignoreMeshColliders:t=!0,options:r})=>{let n=[];e.updateWorldMatrix(!0,!1);let o=e.matrixWorld.clone().invert(),i=e=>{if("isMesh"in e){if(t&&V(e))return;let i=e.getWorldScale(y),a=q[r.colliders||"cuboid"];e.updateWorldMatrix(!0,!1),p.copy(e.matrixWorld).premultiply(o).decompose(m,v,y);let c=new l.Euler().setFromQuaternion(v,"XYZ"),{geometry:s}=e,{args:u,offset:f}=U(s,r.colliders||"cuboid"),g=d(d({},Q(r)),{},{args:u,shape:a,rotation:[c.x,c.y,c.z],position:[m.x+f.x*i.x,m.y+f.y*i.y,m.z+f.z*i.z],scale:[i.x,i.y,i.z]});n.push(g)}};return r.includeInvisible?e.traverse(i):e.traverseVisible(i),n},U=(e,t)=>{switch(t){case"cuboid":{e.computeBoundingBox();let{boundingBox:t}=e,r=t.getSize(new l.Vector3);return{args:[r.x/2,r.y/2,r.z/2],offset:t.getCenter(new l.Vector3)}}case"ball":{e.computeBoundingSphere();let{boundingSphere:t}=e;return{args:[t.radius],offset:t.center}}case"trimesh":{var r;let t=e.index?e.clone():(0,c.mergeVertices)(e);return{args:[t.attributes.position.array,null===(r=t.index)||void 0===r?void 0:r.array],offset:new l.Vector3}}case"hull":return{args:[e.clone().attributes.position.array],offset:new l.Vector3}}return{args:[],offset:new l.Vector3}},G=e=>({collision:!!(null!=e&&e.onCollisionEnter||null!=e&&e.onCollisionExit||null!=e&&e.onIntersectionEnter||null!=e&&e.onIntersectionExit),contactForce:!!(null!=e&&e.onContactForce)}),H=(e,t,r,o={})=>{let{onCollisionEnter:l,onCollisionExit:a,onIntersectionEnter:c,onIntersectionExit:s,onContactForce:d}=t;(0,i.useEffect)(()=>{let i=e();if(i){let{collision:e,contactForce:u}=G(t),f=e||o.collision,p=u||o.contactForce;f&&p?i.setActiveEvents(n.ActiveEvents.COLLISION_EVENTS|n.ActiveEvents.CONTACT_FORCE_EVENTS):f?i.setActiveEvents(n.ActiveEvents.COLLISION_EVENTS):p&&i.setActiveEvents(n.ActiveEvents.CONTACT_FORCE_EVENTS),r.set(i.handle,{onCollisionEnter:l,onCollisionExit:a,onIntersectionEnter:c,onIntersectionExit:s,onContactForce:d})}return()=>{i&&r.delete(i.handle)}},[l,a,c,s,d,o])},Q=(e={})=>F(e,O),Y=()=>{let e=(0,i.useContext)(K);if(!e)throw Error("react-three-rapier: useRapier must be used within <Physics />!");return e},X=(e,t,r=!0)=>{let[n,o]=(0,i.useState)([]);return(0,i.useEffect)(()=>{e.current&&!1!==t.colliders&&o(L({object:e.current,options:t,ignoreMeshColliders:r}))},[t.colliders]),n},Z=(0,i.memo)(()=>{let{world:e}=Y(),t=(0,i.useRef)(null);return(0,o.F)(()=>{let r=t.current;if(!r)return;let n=e.debugRender();r.geometry.setAttribute("position",new l.BufferAttribute(n.vertices,3)),r.geometry.setAttribute("color",new l.BufferAttribute(n.colors,4))}),i.createElement("group",null,i.createElement("lineSegments",{ref:t,frustumCulled:!1},i.createElement("lineBasicMaterial",{color:16777215,vertexColors:!0}),i.createElement("bufferGeometry",null)))}),J=e=>{let t;return{proxy:new Proxy({},{get:(r,n)=>(t||(t=e()),Reflect.get(t,n)),set:(r,n,o)=>(t||(t=e()),Reflect.set(t,n,o))}),reset:()=>{t=void 0},set:e=>{t=e}}},K=(0,i.createContext)(void 0),$=(e,t)=>{var r,n,o,i,l,a;return{target:{rigidBody:e.rigidBody.object,collider:e.collider.object,colliderObject:null===(r=e.collider.state)||void 0===r?void 0:r.object,rigidBodyObject:null===(n=e.rigidBody.state)||void 0===n?void 0:n.object},other:{rigidBody:t.rigidBody.object,collider:t.collider.object,colliderObject:null===(o=t.collider.state)||void 0===o?void 0:o.object,rigidBodyObject:null===(i=t.rigidBody.state)||void 0===i?void 0:i.object},rigidBody:t.rigidBody.object,collider:t.collider.object,colliderObject:null===(l=t.collider.state)||void 0===l?void 0:l.object,rigidBodyObject:null===(a=t.rigidBody.state)||void 0===a?void 0:a.object}},ee=async()=>{let e=await Promise.resolve().then(r.bind(r,68014));return await e.init(),e},et=e=>{let{colliders:t="cuboid",children:r,timeStep:c=1/60,paused:s=!1,interpolate:u=!0,updatePriority:f,updateLoop:E="follow",debug:x=!1,gravity:C=[0,-9.81,0],allowedLinearError:w=.001,predictionDistance:M=.002,numSolverIterations:R=4,numAdditionalFrictionIterations:S=4,numInternalPgsIterations:F=1,minIslandSize:O=128,maxCcdSubsteps:B=1,contactNaturalFrequency:D=30,lengthUnit:A=1}=e,I=(0,a.Rq)(ee,["@react-thee/rapier",ee]),{invalidate:k}=(0,o.D)(),T=j(()=>new Map),N=j(()=>new Map),W=j(()=>new Map),z=j(()=>new Map),V=j(()=>new n.EventQueue(!1)),_=j(()=>new Set),q=j(()=>new Set),{proxy:L,reset:U,set:G}=j(()=>J(()=>new I.World(g(C))));(0,i.useEffect)(()=>()=>{L.free(),U()},[]),(0,i.useEffect)(()=>{L.gravity=h(C),L.integrationParameters.numSolverIterations=R,L.integrationParameters.numAdditionalFrictionIterations=S,L.integrationParameters.numInternalPgsIterations=F,L.integrationParameters.normalizedAllowedLinearError=w,L.integrationParameters.minIslandSize=O,L.integrationParameters.maxCcdSubsteps=B,L.integrationParameters.normalizedPredictionDistance=M,L.lengthUnit=A,L.integrationParameters.contact_natural_frequency=D},[L,...C,R,S,F,w,O,B,M,A,D]);let H=(0,i.useCallback)(e=>{var t;let r=L.getCollider(e),n=z.get(e),o=N.get(e),i=null==r?void 0:null===(t=r.parent())||void 0===t?void 0:t.handle,l=void 0!==i?L.getRigidBody(i):void 0,a=l&&void 0!==i?W.get(i):void 0;return{collider:{object:r,events:n,state:o},rigidBody:{object:l,events:a,state:void 0!==i?T.get(i):void 0}}},[]),[Q]=(0,i.useState)({previousState:{},accumulator:0}),Y=(0,i.useCallback)(e=>{let t="vary"===c,r=l.MathUtils.clamp(e,0,.5),n=e=>{_.forEach(e=>{e.current(L)}),L.timestep=e,L.step(V),q.forEach(e=>{e.current(L)})};if(t)n(r);else for(Q.accumulator+=r;Q.accumulator>=c;)u&&(Q.previousState={},L.forEachRigidBody(e=>{Q.previousState[e.handle]={position:e.translation(),rotation:e.rotation()}})),n(c),Q.accumulator-=c;let o=t||!u||s?1:Q.accumulator/c;T.forEach((e,t)=>{let r=L.getRigidBody(t),n=W.get(t);if(null!=n&&n.onSleep||null!=n&&n.onWake){var i,l;r.isSleeping()&&!e.isSleeping&&(null==n||null===(i=n.onSleep)||void 0===i||i.call(n)),!r.isSleeping()&&e.isSleeping&&(null==n||null===(l=n.onWake)||void 0===l||l.call(n)),e.isSleeping=r.isSleeping()}if(!r||r.isSleeping()&&!("isInstancedMesh"in e.object)||!e.setMatrix)return;let a=r.translation(),c=r.rotation(),s=Q.previousState[t];s&&(p.compose(s.position,b(s.rotation),e.scale).premultiply(e.invertedWorldMatrix).decompose(m,v,y),"mesh"==e.meshType&&(e.object.position.copy(m),e.object.quaternion.copy(v))),p.compose(a,b(c),e.scale).premultiply(e.invertedWorldMatrix).decompose(m,v,y),"instancedMesh"==e.meshType?e.setMatrix(p):(e.object.position.lerp(m,o),e.object.quaternion.slerp(v,o))}),V.drainCollisionEvents((e,t,r)=>{var n,o,i,l,a,c,s,u,f,p,m,v,y,g,b,h,E,x,C,w,j,M,R,S;let P=H(e),F=H(t);if(!(null!=P&&P.collider.object)||!(null!=F&&F.collider.object))return;let O=$(P,F),B=$(F,P);r?L.contactPair(P.collider.object,F.collider.object,(e,t)=>{var r,n,o,i,l,a,c,s;null===(r=P.rigidBody.events)||void 0===r||null===(n=r.onCollisionEnter)||void 0===n||n.call(r,d(d({},O),{},{manifold:e,flipped:t})),null===(o=F.rigidBody.events)||void 0===o||null===(i=o.onCollisionEnter)||void 0===i||i.call(o,d(d({},B),{},{manifold:e,flipped:t})),null===(l=P.collider.events)||void 0===l||null===(a=l.onCollisionEnter)||void 0===a||a.call(l,d(d({},O),{},{manifold:e,flipped:t})),null===(c=F.collider.events)||void 0===c||null===(s=c.onCollisionEnter)||void 0===s||s.call(c,d(d({},B),{},{manifold:e,flipped:t}))}):(null===(n=P.rigidBody.events)||void 0===n||null===(o=n.onCollisionExit)||void 0===o||o.call(n,O),null===(i=F.rigidBody.events)||void 0===i||null===(l=i.onCollisionExit)||void 0===l||l.call(i,B),null===(a=P.collider.events)||void 0===a||null===(c=a.onCollisionExit)||void 0===c||c.call(a,O),null===(s=F.collider.events)||void 0===s||null===(u=s.onCollisionExit)||void 0===u||u.call(s,B)),r?L.intersectionPair(P.collider.object,F.collider.object)&&(null===(f=P.rigidBody.events)||void 0===f||null===(p=f.onIntersectionEnter)||void 0===p||p.call(f,O),null===(m=F.rigidBody.events)||void 0===m||null===(v=m.onIntersectionEnter)||void 0===v||v.call(m,B),null===(y=P.collider.events)||void 0===y||null===(g=y.onIntersectionEnter)||void 0===g||g.call(y,O),null===(b=F.collider.events)||void 0===b||null===(h=b.onIntersectionEnter)||void 0===h||h.call(b,B)):(null===(E=P.rigidBody.events)||void 0===E||null===(x=E.onIntersectionExit)||void 0===x||x.call(E,O),null===(C=F.rigidBody.events)||void 0===C||null===(w=C.onIntersectionExit)||void 0===w||w.call(C,B),null===(j=P.collider.events)||void 0===j||null===(M=j.onIntersectionExit)||void 0===M||M.call(j,O),null===(R=F.collider.events)||void 0===R||null===(S=R.onIntersectionExit)||void 0===S||S.call(R,B))}),V.drainContactForceEvents(e=>{var t,r,n,o,i,l,a,c;let s=H(e.collider1()),u=H(e.collider2());if(!(null!=s&&s.collider.object)||!(null!=u&&u.collider.object))return;let f=$(s,u),p=$(u,s);null===(t=s.rigidBody.events)||void 0===t||null===(r=t.onContactForce)||void 0===r||r.call(t,d(d({},f),{},{totalForce:e.totalForce(),totalForceMagnitude:e.totalForceMagnitude(),maxForceDirection:e.maxForceDirection(),maxForceMagnitude:e.maxForceMagnitude()})),null===(n=u.rigidBody.events)||void 0===n||null===(o=n.onContactForce)||void 0===o||o.call(n,d(d({},p),{},{totalForce:e.totalForce(),totalForceMagnitude:e.totalForceMagnitude(),maxForceDirection:e.maxForceDirection(),maxForceMagnitude:e.maxForceMagnitude()})),null===(i=s.collider.events)||void 0===i||null===(l=i.onContactForce)||void 0===l||l.call(i,d(d({},f),{},{totalForce:e.totalForce(),totalForceMagnitude:e.totalForceMagnitude(),maxForceDirection:e.maxForceDirection(),maxForceMagnitude:e.maxForceMagnitude()})),null===(a=u.collider.events)||void 0===a||null===(c=a.onContactForce)||void 0===c||c.call(a,d(d({},p),{},{totalForce:e.totalForce(),totalForceMagnitude:e.totalForceMagnitude(),maxForceDirection:e.maxForceDirection(),maxForceMagnitude:e.maxForceMagnitude()}))}),L.forEachActiveRigidBody(()=>{k()})},[s,c,u,L]),X=(0,i.useMemo)(()=>({rapier:I,world:L,setWorld:e=>{G(e)},physicsOptions:{colliders:t,gravity:C},rigidBodyStates:T,colliderStates:N,rigidBodyEvents:W,colliderEvents:z,beforeStepCallbacks:_,afterStepCallbacks:q,isPaused:s,isDebug:x,step:Y}),[s,Y,x,t,C]),et=(0,i.useCallback)(e=>{s||Y(e)},[s,Y]);return i.createElement(K.Provider,{value:X},i.createElement(P,{onStep:et,type:E,updatePriority:f}),x&&i.createElement(Z,null),r)};function er(){return(er=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(null,arguments)}let en=(e,t,r)=>{let n=(0,i.useRef)(),o=(0,i.useCallback)(()=>(n.current||(n.current=e()),n.current),r);return(0,i.useEffect)(()=>{let e=o(),r=()=>t(e);return()=>{r(),n.current=void 0}},[o]),o},eo=({x:e,y:t,z:r}={x:0,y:0,z:0})=>new l.Vector3(e,t,r),ei=(e,t=null)=>{let r=(0,i.useRef)(t);return e&&"function"!=typeof e?(e.current||(e.current=r.current),e):r},el=(0,i.memo)((0,i.forwardRef)((e,t)=>{let{children:r,position:n,rotation:o,quaternion:l,scale:a,name:c}=e,{world:s,colliderEvents:u,colliderStates:f}=Y(),p=eb(),m=ei(t),v=(0,i.useRef)(null),y=en(()=>{let r=D(e,s,v.current.getWorldScale(eo()),null==p?void 0:p.getRigidBody);return"function"==typeof t&&t(r),m.current=r,r},e=>{s.getCollider(e.handle)&&s.removeCollider(e,!0)},[...A.flatMap(t=>Array.isArray(e[t])?[...e[t]]:e[t]),p]);(0,i.useEffect)(()=>{let e=y();return f.set(e.handle,_(e,v.current,null==p?void 0:p.ref.current)),()=>{f.delete(e.handle)}},[y]);let g=(0,i.useMemo)(()=>d(d({},Q(null==p?void 0:p.options)),e),[e,null==p?void 0:p.options]);return z(y,g,f),H(y,g,u,G(null==p?void 0:p.options)),i.createElement("object3D",{position:n,rotation:o,quaternion:l,scale:a,ref:v,name:c},r)}));i.forwardRef((e,t)=>i.createElement(el,er({},e,{shape:"cuboid",ref:t}))).displayName="CuboidCollider",i.forwardRef((e,t)=>i.createElement(el,er({},e,{shape:"roundCuboid",ref:t}))).displayName="RoundCuboidCollider",i.forwardRef((e,t)=>i.createElement(el,er({},e,{shape:"ball",ref:t}))).displayName="BallCollider",i.forwardRef((e,t)=>i.createElement(el,er({},e,{shape:"capsule",ref:t}))).displayName="CapsuleCollider",i.forwardRef((e,t)=>i.createElement(el,er({},e,{shape:"heightfield",ref:t}))).displayName="HeightfieldCollider",i.forwardRef((e,t)=>i.createElement(el,er({},e,{shape:"trimesh",ref:t}))).displayName="TrimeshCollider",i.forwardRef((e,t)=>i.createElement(el,er({},e,{shape:"cone",ref:t}))).displayName="ConeCollider",i.forwardRef((e,t)=>i.createElement(el,er({},e,{shape:"roundCone",ref:t}))).displayName="RoundConeCollider";let ea=i.forwardRef((e,t)=>i.createElement(el,er({},e,{shape:"cylinder",ref:t})));ea.displayName="CylinderCollider",ea.displayName="RoundCylinderCollider",i.forwardRef((e,t)=>i.createElement(el,er({},e,{shape:"convexHull",ref:t}))).displayName="ConvexHullCollider";let ec=e=>{var t;let r=x((null==e?void 0:e.type)||"dynamic"),o=new n.RigidBodyDesc(r);return o.canSleep=null===(t=null==e?void 0:e.canSleep)||void 0===t||t,o},es=({rigidBody:e,object:t,setMatrix:r,getMatrix:n,worldScale:o,meshType:i="mesh"})=>{t.updateWorldMatrix(!0,!1);let l=t.parent.matrixWorld.clone().invert();return{object:t,rigidBody:e,invertedWorldMatrix:l,setMatrix:r||(e=>{t.matrix.copy(e)}),getMatrix:n||(e=>e.copy(t.matrix)),scale:o||t.getWorldScale(y).clone(),isSleeping:!1,meshType:i}},ed=["args","colliders","canSleep"],eu={gravityScale:(e,t)=>{e.setGravityScale(t,!0)},additionalSolverIterations(e,t){e.setAdditionalSolverIterations(t)},linearDamping:(e,t)=>{e.setLinearDamping(t)},angularDamping:(e,t)=>{e.setAngularDamping(t)},dominanceGroup:(e,t)=>{e.setDominanceGroup(t)},enabledRotations:(e,[t,r,n])=>{e.setEnabledRotations(t,r,n,!0)},enabledTranslations:(e,[t,r,n])=>{e.setEnabledTranslations(t,r,n,!0)},lockRotations:(e,t)=>{e.lockRotations(t,!0)},lockTranslations:(e,t)=>{e.lockTranslations(t,!0)},angularVelocity:(e,[t,r,n])=>{e.setAngvel({x:t,y:r,z:n},!0)},linearVelocity:(e,[t,r,n])=>{e.setLinvel({x:t,y:r,z:n},!0)},ccd:(e,t)=>{e.enableCcd(t)},softCcdPrediction:(e,t)=>{e.setSoftCcdPrediction(t)},userData:(e,t)=>{e.userData=t},type(e,t){e.setBodyType(x(t),!0)},position:()=>{},rotation:()=>{},quaternion:()=>{},scale:()=>{}},ef=Object.keys(eu),ep=(e,t,r,n=!0)=>{if(!e)return;let o=r.get(e.handle);o&&(n&&(o.object.updateWorldMatrix(!0,!1),p.copy(o.object.matrixWorld).decompose(m,v,y),e.setTranslation(m,!1),e.setRotation(v,!1)),ef.forEach(r=>{r in t&&eu[r](e,t[r])}))},em=(e,t,r,n=!0)=>{let o=(0,i.useMemo)(()=>ef.flatMap(e=>w(t[e])),[t]);(0,i.useEffect)(()=>{ep(e(),t,r,n)},o)},ev=(e,t,r)=>{let{onWake:n,onSleep:o,onCollisionEnter:l,onCollisionExit:a,onIntersectionEnter:c,onIntersectionExit:s,onContactForce:d}=t,u={onWake:n,onSleep:o,onCollisionEnter:l,onCollisionExit:a,onIntersectionEnter:c,onIntersectionExit:s,onContactForce:d};(0,i.useEffect)(()=>{let t=e();return r.set(t.handle,u),()=>{r.delete(t.handle)}},[n,o,l,a,c,s,d])},ey=["children","type","position","rotation","scale","quaternion","transformState"],eg=(0,i.createContext)(void 0),eb=()=>(0,i.useContext)(eg),eh=(0,i.memo)((0,i.forwardRef)((e,t)=>{let{children:r,type:n,position:o,rotation:l,scale:a,quaternion:c,transformState:s}=e,u=F(e,ey),f=(0,i.useRef)(null),p=ei(t),{world:m,rigidBodyStates:v,physicsOptions:y,rigidBodyEvents:g}=Y(),b=(0,i.useMemo)(()=>d(d(d({},y),e),{},{children:void 0}),[y,e]),h=ed.flatMap(e=>Array.isArray(b[e])?[...b[e]]:b[e]),E=X(f,b),x=en(()=>{let e=ec(b),r=m.createRigidBody(e);return"function"==typeof t&&t(r),p.current=r,r},e=>{m.getRigidBody(e.handle)&&m.removeRigidBody(e)},h);(0,i.useEffect)(()=>{let t=x(),r=es({rigidBody:t,object:f.current});return v.set(t.handle,e.transformState?e.transformState(r):r),()=>{v.delete(t.handle)}},[x]),em(x,b,v),ev(x,b,g);let C=(0,i.useMemo)(()=>({ref:f,getRigidBody:x,options:b}),[x]);return i.createElement(eg.Provider,{value:C},i.createElement("object3D",er({ref:f},u,{position:o,rotation:l,quaternion:c,scale:a}),r,E.map((e,t)=>i.createElement(el,er({key:t},e)))))}));eh.displayName="RigidBody",(0,i.memo)(e=>{let{children:t,type:r}=e,{physicsOptions:n}=Y(),o=(0,i.useRef)(null),{options:l}=eb(),a=X(o,(0,i.useMemo)(()=>d(d(d({},n),l),{},{children:void 0,colliders:r}),[n,l]),!1);return i.createElement("object3D",{ref:o,userData:{r3RapierType:"MeshCollider"}},t,a.map((e,t)=>i.createElement(el,er({key:t},e))))}).displayName="MeshCollider";let eE=["children","instances","colliderNodes","position","rotation","quaternion","scale"];(0,i.memo)((0,i.forwardRef)((e,t)=>{let r=ei(t,[]),n=(0,i.useRef)(null),o=(0,i.useRef)(null),{children:a,instances:c,colliderNodes:s=[],position:u,rotation:f,quaternion:p,scale:m}=e,v=F(e,eE),y=X(n,d(d({},e),{},{children:void 0})),g=()=>{let e=o.current.children[0];if(e&&"isInstancedMesh"in e)return e};(0,i.useEffect)(()=>{let e=g();e?e.instanceMatrix.setUsage(l.DynamicDrawUsage):console.warn("InstancedRigidBodies expects exactly one child, which must be an InstancedMesh")},[]);let b=(e,t)=>{let r=g();return r?d(d({},e),{},{getMatrix:e=>(r.getMatrixAt(t,e),e),setMatrix:e=>{r.setMatrixAt(t,e),r.instanceMatrix.needsUpdate=!0},meshType:"instancedMesh"}):e};return i.createElement("object3D",er({ref:n},v,{position:u,rotation:f,quaternion:p,scale:m}),i.createElement("object3D",{ref:o},a),null==c?void 0:c.map((e,t)=>i.createElement(eh,er({},v,e,{ref:e=>r.current[t]=e,transformState:e=>b(e,t)}),i.createElement(i.Fragment,null,s.map((e,t)=>i.createElement(i.Fragment,{key:t},e)),y.map((e,t)=>i.createElement(el,er({key:t},e)))))))})).displayName="InstancedRigidBodies"}}]);