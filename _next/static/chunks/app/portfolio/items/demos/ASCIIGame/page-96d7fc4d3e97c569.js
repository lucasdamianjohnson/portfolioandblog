(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6956],{11034:function(t,e,n){Promise.resolve().then(n.bind(n,11103))},41127:function(t,e,n){n.g.SCREENHEIGHT=17,n.g.SCREENWIDTH=48,n.g.RIGHTMENUHEIGHT=20,n.g.RIGHTMENUWIDTH=46,n.g.BOTTOMMENUHEIGHT=8,n.g.BOTTOMMENUWIDTH=48,n.g.BOTTOMRIGHTMENUHEIGHT=8,n.g.BOTTOMRIGHTMENUWIDTH=46,n.g.DRAWINTERVAL=35,n.g.LOGICINTERVAL=90,n.g.SOUNDENABLED=!1},11103:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return tN}});var i,a,s=n(57437);n(48622);var r=n(3582),o=n(38697);n(41127);let l=["\0","\x01","\x02","\x03","\x04","\x05","\x06","\x07","\b","	","\n","\v","\f","\r","\x0e","\x0f","\x10","\x11","\x12","\x13","\x14","\x15","\x16","\x17","\x18","\x19","\x1a","\x1b","\x1c","\x1d","\x1e","\x1f"," ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/","0","1","2","3","4","5","6","7","8","9",":",";","<","=",">","?","@","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","[","\\","]","^","_","`","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","{","|","}","~","\x7f","\xc7","\xfc","\xe9","\xe2","\xe4","\xe0","\xe5","\xe7","\xea","\xeb","\xe8","\xef","\xee","\xec","\xc4","\xc5","\xc9","\xe6","\xc6","\xf4","\xf6","\xf2","\xfb","\xf9","\xff","\xd6","\xdc","\xa2","\xa3","\xa5","₧","ƒ","\xe1","\xed","\xf3","\xfa","\xf1","\xd1","\xaa","\xba","\xbf","⌐","\xac","\xbd","\xbc","\xa1","\xab","\xbb","░","▒","▓","│","┤","\xc1","\xc2","\xc0","\xa9","╣","║","╗","╝","\xa2","\xa5","┐","└","┴","┬","├","─","┼","\xe3","\xc3","╚","╔","╩","╦","╠","═","╬","\xa4","\xf0","\xd0","\xca","\xcb","\xc8","ı","\xcd","\xce","\xcf","┘","┌","█","▄","\xa6","\xcc","▀","\xd3","\xdf","\xd4","\xd2","\xf5","\xd5","\xb5","\xfe","\xde","\xda","\xdb","\xd9","\xfd","\xdd","\xaf","\xb4","≡","\xb1","‗","\xbe","\xb6","\xa7","\xf7","\xb8","\xb0","\xa8","\xb7","\xb9","\xb3","\xb2","■","\xff"];(i=a||(a={}))[i.Black=1]="Black",i[i.Red=2]="Red",i[i.Green=3]="Green",i[i.Yellow=4]="Yellow",i[i.Blue=5]="Blue",i[i.Purple=6]="Purple",i[i.Cyan=7]="Cyan",i[i.White=8]="White";class h{static Clear(t){t.fg=null,t.fg=null,t.blinking=!1,t.dim=!1,t.bright=!1}static Copy(t,e){void 0!==e.fg&&(t.fg=e.fg),void 0!==e.bg&&(t.bg=e.bg),t.dim=void 0!==e.dim&&e.dim,t.blinking=void 0!==e.blinking&&e.blinking,t.bright=void 0!==e.bright&&e.bright}static New(t){return new h(t.fg,t.bg,t.dim,t.blinking,t.bright)}constructor(t,e,n,i,a){this.fg=null,this.bg=null,this.fg=void 0!==t?t:null,this.bg=void 0!==e?e:null,this.dim=!!n,this.blinking=!!i,this.bright=!!a}}let c={};for(let t=0;t<l.length;t++)c[l[t]]=t;class u{static getCharCodeAt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.asciiRecord[t[e]]}static getCharFromCode(t){return this.asciiTable[t]}}u.asciiTable=l,u.asciiRecord=c;let m=h.New({fg:a.Red}),y=h.New({fg:a.Red,dim:!0});class d{async doScreenTransition(t,e,n,i){this.DS.entityManager.deleteAllEntitiesOnScene(t),"battle"==t&&this.DS.entityManager.deleteAllEntitiesOnScene("level"),("level"==t||"battle"==t)&&(this.DS.engine.sceneTransitiong=!0,this.DS.player.active=!1);let a=e.screenStates["1"],s=n.screenStates["1"],r=this._sealSceneForTransition(i,a,s);return("level"==t||"battle"==t)&&("-1"!=n.rawText["1"].styleMap?h.Copy(this.DS.engine._activeStyleObject,n.styleMap[n.rawText["1"].styleMap]):h.Clear(this.DS.engine._activeStyleObject)),await this._doSceneTransition(t,i,r,n),("level"==t||"battle"==t)&&(this.DS.engine.sceneTransitiong=!1,"level"==t&&(this.DS.player.active=!0)),!0}async _doSceneTransition(t,e,n,i){("level"==t||"battle"==t)&&(this.DS.engine.currentWorldData=n),"right-menu"==t&&(this.DS.menuSceneManager.rightMenuDrawer.currentMenuData=n),"bottom-menu"==t&&(this.DS.menuSceneManager.bottomMenuDrawer.currentMenuData=n),"bottom-right-menu"==t&&(this.DS.menuSceneManager.bottomRightMenuDrawer.currentMenuData=n),"left"==e&&await this._transitionLeft(t),"right"==e&&await this._transitionRight(t),"up"==e&&await this._transitionUp(t),"down"==e&&await this._transitionDown(t),"level"==t&&this.DS.levelManager.setActiveScene(this.DS.levelManager.activeMeta.id,i.id),"battle"==t&&this.DS.battleSceneManager.setActiveScene(this.DS.battleSceneManager.activeMeta.id,i.id),"right-menu"==t&&(this.DS.menuSceneManager.rightMenuDrawer.setActiveMenuScene(this.DS.menuSceneManager.activeMeta.id,i.id),this.DS.menuSceneManager.rightMenuDrawer.currentRow=0),"bottom-menu"==t&&(this.DS.menuSceneManager.bottomMenuDrawer.setActiveMenuScene(this.DS.menuSceneManager.activeMeta.id,i.id),this.DS.menuSceneManager.bottomMenuDrawer.currentRow=0),"bottom-right-menu"==t&&(this.DS.menuSceneManager.bottomRightMenuDrawer.setActiveMenuScene(this.DS.menuSceneManager.activeMeta.id,i.id),this.DS.menuSceneManager.bottomRightMenuDrawer.currentRow=0),("level"==t||"battle"==t)&&(this.DS.engine.currentWorldRow=0,this.DS.engine.currentWorldCollumn=0)}async _transitionLeft(t){this.DS.engine.currentWorldCollumn=SCREENWIDTH+2;for(let t=this.DS.engine.currentWorldCollumn;this.DS.engine.currentWorldCollumn>0;t--)this.DS.engine.currentWorldCollumn--,await this.DS.renderer.asyncSleep(30)}async _transitionRight(t){this.DS.engine.currentWorldCollumn=0;for(let t=0;t<SCREENWIDTH;t++)this.DS.engine.currentWorldCollumn++,await this.DS.renderer.asyncSleep(30)}async _transitionUp(t){if("battle"==t||"level"==t){this.DS.engine.currentWorldRow=SCREENHEIGHT+1;for(let t=this.DS.engine.currentWorldRow;t>1;t--)this.DS.engine.currentWorldRow--,await this.DS.renderer.asyncSleep(60)}if("right-menu"==t){this.DS.menuSceneManager.rightMenuDrawer.currentRow=RIGHTMENUHEIGHT-2;for(let t=this.DS.menuSceneManager.rightMenuDrawer.currentRow;t>1;t--)this.DS.menuSceneManager.rightMenuDrawer.currentRow--,await this.DS.renderer.asyncSleep(60)}if("bottom-menu"==t){this.DS.menuSceneManager.bottomMenuDrawer.currentRow=BOTTOMMENUHEIGHT;for(let t=this.DS.menuSceneManager.bottomMenuDrawer.currentRow;t>0;t--)this.DS.menuSceneManager.bottomMenuDrawer.currentRow--,await this.DS.renderer.asyncSleep(60)}if("bottom-right-menu"==t){this.DS.menuSceneManager.bottomRightMenuDrawer.currentRow=BOTTOMRIGHTMENUHEIGHT-2;for(let t=this.DS.menuSceneManager.bottomRightMenuDrawer.currentRow;t>1;t--)this.DS.menuSceneManager.bottomRightMenuDrawer.currentRow--,await this.DS.renderer.asyncSleep(60)}}async _transitionDown(t){if("battle"==t||"level"==t){this.DS.engine.currentWorldRow=0;for(let t=0;t<SCREENHEIGHT;t++)this.DS.engine.currentWorldRow++,await this.DS.renderer.asyncSleep(60)}if("right-menu"==t){this.DS.menuSceneManager.rightMenuDrawer.currentRow=0;for(let t=0;t<RIGHTMENUHEIGHT;t++)this.DS.menuSceneManager.rightMenuDrawer.currentRow++,await this.DS.renderer.asyncSleep(60)}}_sealSceneForTransition(t,e,n){let i,a=[];switch(t){case"up":a=n.concat(e);break;case"down":a=e.concat(n);break;case"left":for(let t of(i=0,n)){let n=t.concat(e[i]);a.push(n),i++}break;case"right":for(let t of(i=0,e)){let e=t.concat(n[i]);a.push(e),i++}}return a}async doScreenWipe(t){switch(this.DS.entityManager.deleteAllEntitiesOnScene("level"),t){case"wipe-1":await this._doWipe1();break;case"wipe-2":await this._doWipe2()}}async _doWipe1(){this.DS.engine.sceneTransitiong=!0,await this._runWipe1(SCREENHEIGHT+1,SCREENWIDTH+32),await this._runWipe1(SCREENHEIGHT+1,SCREENWIDTH+32),this.DS.engine.sceneTransitiong=!1}async _runWipe1(t,e){for(let n=e;n>=0;n--){let e=t,i=n;do e>=0&&i>=1&&i<SCREENWIDTH+1&&(this.DS.renderer.showAt("*",e,i),await this.DS.renderer.asyncSleep(1)),e--,i--;while(e>=2)}}async _doWipe2(){this.DS.engine.sceneTransitiong=!0,await this._runWipe2(this.DS.renderer.stylize("[0]",m),SCREENHEIGHT+2,SCREENWIDTH-2),await this._runWipe2_2(this.DS.renderer.stylize("[0]",y),SCREENHEIGHT+2,SCREENWIDTH-2),this.DS.engine.sceneTransitiong=!1}async _runWipe2(t,e,n){for(let i=n;i>1;i-=3)for(let n=2;n<e;n++)this.DS.renderer.showAt(t,n,i),await this.DS.renderer.asyncSleep(2)}async _runWipe2_2(t,e,n){for(let i=1;i<n;i+=3)for(let n=2;n<e;n++)this.DS.renderer.showAt(t,n,i),await this.DS.renderer.asyncSleep(2)}constructor(t){this.DS=t}}function S(t){return!!t&&Math.random()<=t}class g{registerEntity(t,e){this.entites[t]=e}createNewEntity(t,e,n,i,a,s){this.createdEntites[t][n]||(this.createdEntites[t][n]={entities:[],ids:[]});let r=Math.floor(Math.random()*Date.now()),o=new this.entites[n](e,"".concat(r),i,a,s,t);return o.draw&&this.drawEntities.push(o),this.activeEntities.push(o),this.createdEntites[t][n].entities.push(o),this.createdEntites[t][n].ids.push("".concat(r)),o}async $draw(){if(!this.deleting)for(let t of this.drawEntities)t.$draw()}async $run(){if(!this.deleting)for(let t of this.activeEntities)t.$run()}deleteAllEntitiesOnScene(t){this.deleting=!0;let e=this.createdEntites[t];for(let t of Object.keys(e)){let n=e[t];for(let t of(n.entities=[],n.ids)){let e=0;for(;e<this.activeEntities.length;)this.activeEntities[e].id===t?this.activeEntities.splice(e,1):++e;for(e=0;e<this.drawEntities.length;)this.drawEntities[e].id===t?this.drawEntities.splice(e,1):++e}n.ids=[]}this.deleting=!1}deleteAllEntites(){for(let t of(this.activeEntities=[],this.drawEntities=[],Object.keys(this.createdEntites))){let e=this.createdEntites[t];for(let t of Object.keys(e)){let n=e[t];n.entities=[],n.ids=[]}}}constructor(t,e){this.renderer=t,this.DS=e,this.entites={},this.createdEntites={battle:{},"bottom-menu":{},"bottom-right-menu":{},level:{},menu:{},"right-menu":{}},this.deleting=!1,this.activeEntities=[],this.drawEntities=[]}}h.New({});class p{getScene(t){return this.activeMeta.scene[t]}setActiveSceneMeta(t){return this.activeMeta=this.scenes[t],this}setActiveScene(t,e){for(let n of(this.activeScene=this.scenes[t].scene[e],this.DS.engine.setWorldScene("level",this.activeScene),this.animations={},this.animationIntervalMap={},this.screenStateAnimationActiveID=this.activeScene.activeAnimationScreenState,""!=this.screenStateAnimationActiveID&&0!=this.activeScene.screenStateAnimationKeys[this.screenStateAnimationActiveID].length?(this.screenStateAnimationInterval=this.activeScene.screenStateAnimationKeys[this.screenStateAnimationActiveID][0].inteerval,this.screenStateAnimationIntervalCount=this.activeScene.screenStateAnimationKeys[this.screenStateAnimationActiveID][0].inteerval,this.screenStateKeyCount=0,this.screenStateKeyTotal=this.activeScene.screenStateAnimationKeys[this.screenStateAnimationActiveID].length):(this.screenStateAnimationInterval=-1,this.screenStateAnimationIntervalCount=-1,this.screenStateKeyCount=0,this.screenStateKeyTotal=0),this.animations=this.activeScene.animations,Object.keys(this.activeScene.animations))){let t=this.activeScene.animations[n],e=t[0].interval;this.animationIntervalMap[n]={interval:e,count:0,totalFrames:t.length,currentFrame:0}}return this.screenStateAnimationInterval,this}registerSceneMeta(t){return this.scenes[t]={id:t,scene:{}},this}addSceneToMeta(t,e){return Promise.all([this.DS.sceneProcessor.processSceneStates(e),this.DS.sceneProcessor.processEntityMaps(e),this.DS.sceneProcessor.processCollisionMaps(e)]),this.scenes[t].scene[e.id]=e,this}$doSceneWorldAnimations(){if(!this.DS.engine.sceneTransitiong)for(let t of Object.keys(this.animations)){let e=this.animationIntervalMap[t],n=this.animations[t][e.currentFrame],i=0,a=!1;for(let t of((null==n?void 0:n.animDirection)=="up"&&(a=!0),n.animText)){let e=this.DS.renderer.stylize(t,n.style);this.DS.renderer.showAt(e,n.row+i,n.col),a?i--:i++}0==e.count?(e.currentFrame>=e.totalFrames-1?e.currentFrame=0:e.currentFrame++,e.interval=this.animations[t][e.currentFrame].interval,e.count=e.interval):e.count--}}$doSceneAnimations(){if(!this.DS.engine.sceneTransitiong){if(0==this.screenStateAnimationIntervalCount){this.screenStateKeyCount>=this.screenStateKeyTotal-1?this.screenStateKeyCount=0:this.screenStateKeyCount++;let t=this.DS.levelManager.activeScene.screenStateAnimationKeys[this.screenStateAnimationActiveID][this.screenStateKeyCount];this.screenStateAnimationIntervalCount=t.inteerval,this.DS.engine.setWorldData(this.activeScene.screenStates[t.stateName]),"-1"!=this.activeScene.rawText[t.stateName].styleMap?h.Copy(this.DS.engine._activeStyleObject,this.activeScene.styleMap[this.activeScene.rawText[t.stateName].styleMap]):h.Clear(this.DS.engine._activeStyleObject)}else this.screenStateAnimationIntervalCount>0&&this.screenStateAnimationIntervalCount--}}constructor(t){this.DS=t,this.animations={},this.animationIntervalMap={},this.screenStateKeyCount=0,this.screenStateKeyTotal=0,this.screenStateAnimationInterval=-1,this.screenStateAnimationIntervalCount=-1,this.screenStateAnimationActiveID="",this.activeScene={id:"",activeAnimationScreenState:"",activeEntityMap:"",entityMap:{},entityMapRaw:{},animations:{},styleMap:{},collisionMapsRaw:{},collisionMaps:{},screenStateAnimationKeys:{},rawText:{},screenStates:{},bottomScrene:!1,topScrene:!1,rightScrene:!1,leftScrene:!1},this.activeMeta={id:"overworld",scene:{}},this.scenes={}}}class w{setUpControls(){arguments.length>0&&void 0!==arguments[0]&&arguments[0],this.DS.controlManager.onInput("a",()=>this._goLeft()),this.DS.controlManager.onInput("d",()=>this._goRight()),this.DS.controlManager.onInput("w",()=>this._goUp()),this.DS.controlManager.onInput("s",()=>this._goDown())}async _goLeft(){if(this.canControl&&this.active){if(1==this.x)await this.DS.engine.checkWorld("left",this.x,this.y)&&(this.x=SCREENWIDTH-4);else if(!this._collisionCheck("left")&&!this.gravity){this.x--;return}}}async _goRight(){if(this.canControl&&this.active){if(this.x>=SCREENWIDTH-4)await this.DS.engine.checkWorld("right",this.x,this.y)&&(this.x=1);else if(!this._collisionCheck("right")&&!this.gravity){this.x++;return}}}async _goUp(){if(this.canControl&&this.active){if(1==this.y)await this.DS.engine.checkWorld("up",this.x,this.y)&&(this.y=15);else if(!this._collisionCheck("up")&&!this.inAir&&this.doneJumping&&!this.gravity){this.y--;return}}}async _goDown(){if(this.canControl&&this.active){if(this.y>=SCREENHEIGHT-2)await this.DS.engine.checkWorld("down",this.x,this.y)&&(this.y=1);else if(!this._collisionCheck("down")&&!this.gravity){this.y++;return}}}playerGetCrystal(t){this.playerData.crystals[t]=!0;let e=this.DS.levelManager.scenes.overworld.scene["cyrstal-alter"].animations[t],n=a.Blue;switch(t){case"blue":n=a.Blue;break;case"red":n=a.Red;break;case"yellow":n=a.Yellow;break;case"green":n=a.Green;break;case"cyan":n=a.Cyan;break;case"magenta":n=a.Purple}for(let t of e)t.style.fg=n;e[0].style.dim=!0,e[0].style.bright=!1,e[1].style.bright=!0,e[2].style.dim=!0,e[2].style.bright=!1}_collisionCheck(t){let e=!1,n=[];switch(t){case"up":n=this.DS.engine.readWorldDataSection(this.y-2,this.y-2,this.x-1,this.x+4);break;case"down":n=this.DS.engine.readWorldDataSection(this.y+2,this.y+2,this.x-1,this.x+4);break;case"right":n=this.DS.engine.readWorldDataSection(this.y-1,this.y+2,this.x+4,this.x+4);break;case"left":n=this.DS.engine.readWorldDataSection(this.y-1,this.y+2,this.x-2,this.x-2)}for(let t of n)for(let n of t)if(this.walls.indexOf(n)>-1){e=!0;continue}return e}$draw(){if(!this.active)return;let t=this.DS.engine.getRelativePosition(this.x,this.y);this.renderer.showAt(this.pt,t.y+1,t.x),this.renderer.showAt(this.pm,t.y+2,t.x),this.renderer.showAt(this.pb,t.y+3,t.x)}constructor(t,e){this.renderer=t,this.DS=e,this.playerData={crystals:{red:!1,blue:!1,green:!1,yellow:!1,magenta:!1,cyan:!1}},this.x=23,this.y=14,this.gravity=!1,this.inAir=!1,this.upKey="\x1b[A",this.leftKey="\x1b[D",this.rightKey="\x1b[C",this.downKey="\x1b[B",this.going="down",this.doneJumping=!0,this.active=!0,this.canControl=!0,this.pt=" / \\ ",this.pm="<{0}>",this.pb=" \\ / ",this.walls=["|","*","_","-","(",")","=","█"],this.check=!1,this.setUpControls(),this.pt=t.stylize(" /|\\ ",{fg:a.Purple,dim:!0});let n=t.stylize("0",{blinking:!0,fg:a.Cyan}),i=t.stylize("<{",{fg:a.Purple,bright:!0}),s=t.stylize("}>",{fg:a.Purple,bright:!0});this.pm="".concat(i).concat(n).concat(s),this.pb=t.stylize(" \\|/",{fg:a.Purple,dim:!0})}}h.New({});class v{getScene(t){return this.activeMeta.scene[t]}setActiveSceneMeta(t){return this.activeMeta=this.scenes[t],this}setActiveScene(t,e){for(let n of(this.activeScene=this.scenes[t].scene[e],this.DS.engine.setWorldScene("battle",this.activeScene),this.animations={},this.animationIntervalMap={},this.screenStateAnimationIntervalID=this.activeScene.activeAnimationScreenState,""!=this.screenStateAnimationIntervalID||void 0!=this.activeScene.screenStateAnimationKeys[this.screenStateAnimationIntervalID]?(this.screenStateAnimationInterval=this.activeScene.screenStateAnimationKeys[this.screenStateAnimationIntervalID][0].inteerval,this.screenStateAnimationIntervalCount=this.activeScene.screenStateAnimationKeys[this.screenStateAnimationIntervalID][0].inteerval,this.screenStateKeyCount=0,this.screenStateKeyTotal=this.activeScene.screenStateAnimationKeys[this.screenStateAnimationIntervalID].length):(this.screenStateAnimationInterval=-1,this.screenStateAnimationIntervalCount=-1,this.screenStateKeyCount=0,this.screenStateKeyTotal=0),this.animations=this.activeScene.animations,Object.keys(this.activeScene.animations))){let t=this.activeScene.animations[n],e=t[0].interval;this.animationIntervalMap[n]={interval:e,count:0,totalFrames:t.length,currentFrame:0}}return this}registerSceneMeta(t){return this.scenes[t]={id:t,scene:{}},this}addSceneToMeta(t,e){return Promise.all([this.DS.sceneProcessor.processSceneStates(e),this.DS.sceneProcessor.processEntityMaps(e)]),this.scenes[t].scene[e.id]=e,this}$doSceneWorldAnimations(){if(!this.DS.engine.sceneTransitiong)for(let t of Object.keys(this.animations)){let e=this.animationIntervalMap[t],n=this.animations[t][e.currentFrame],i=0,a=!1;for(let t of((null==n?void 0:n.animDirection)=="up"&&(a=!0),n.animText)){let e=this.DS.renderer.stylize(t,n.style);this.DS.renderer.showAt(e,n.row+i,n.col),a?i--:i++}0==e.count?(e.currentFrame>=e.totalFrames-1?e.currentFrame=0:e.currentFrame++,e.interval=this.animations[t][e.currentFrame].interval,e.count=e.interval):e.count--}}$doSceneAnimations(){if(!this.DS.engine.sceneTransitiong){if(0==this.screenStateAnimationIntervalCount){this.screenStateKeyCount>=this.screenStateKeyTotal-1?this.screenStateKeyCount=0:this.screenStateKeyCount++;let t=this.activeScene.screenStateAnimationKeys[this.screenStateAnimationIntervalID][this.screenStateKeyCount];this.screenStateAnimationIntervalCount=t.inteerval,this.DS.engine.setWorldData(this.activeScene.screenStates[t.stateName]),"-1"!=this.activeScene.rawText[t.stateName].styleMap?h.Copy(this.DS.engine._activeStyleObject,this.activeScene.styleMap[this.activeScene.rawText[t.stateName].styleMap]):h.Clear(this.DS.engine._activeStyleObject)}else this.screenStateAnimationIntervalCount>0&&this.screenStateAnimationIntervalCount--}}constructor(t){this.DS=t,this.animations={},this.animationIntervalMap={},this.screenStateKeyCount=0,this.screenStateKeyTotal=0,this.screenStateAnimationInterval=-1,this.screenStateAnimationIntervalCount=-1,this.screenStateAnimationIntervalID="",this.activeMeta={id:"overworld",scene:{}},this.scenes={},this.activeScene={id:"",activeAnimationScreenState:"",activeEntityMap:"",entityMap:{},entityMapRaw:{},animations:{},styleMap:{},screenStateAnimationKeys:{},rawText:{},screenStates:{}}}}h.New({});class f{readWorldDataSection(t,e,n,i){if(t==e)return[this.currentCollisonMap[t].substring(n,i)];let a=[];for(;t<e;)this.currentCollisonMap[t]&&this.currentCollisonMap[t][n]&&a.push(this.currentCollisonMap[t][n]),t++;return a}async checkWorld(t,e,n){if("left"==t&&this.DS.levelManager.activeScene.leftScrene){let t=this.DS.levelManager.scenes[this.DS.levelManager.activeMeta.id].scene[this.DS.levelManager.activeScene.leftScrene],e=this.DS.levelManager.activeScene;return await this.DS.screenTranistions.doScreenTransition("level",e,t,"left"),!0}if("right"==t&&this.DS.levelManager.activeScene.rightScrene){let t=this.DS.levelManager.scenes[this.DS.levelManager.activeMeta.id].scene[this.DS.levelManager.activeScene.rightScrene],e=this.DS.levelManager.activeScene;return await this.DS.screenTranistions.doScreenTransition("level",e,t,"right"),!0}if("up"==t&&this.DS.levelManager.activeScene.topScrene){let t=this.DS.levelManager.scenes[this.DS.levelManager.activeMeta.id].scene[this.DS.levelManager.activeScene.topScrene],e=this.DS.levelManager.activeScene;return await this.DS.screenTranistions.doScreenTransition("level",e,t,"up"),!0}if("down"==t&&this.DS.levelManager.activeScene.bottomScrene){let t=this.DS.levelManager.scenes[this.DS.levelManager.activeMeta.id].scene[this.DS.levelManager.activeScene.bottomScrene],e=this.DS.levelManager.activeScene;return await this.DS.screenTranistions.doScreenTransition("level",e,t,"down"),!0}return!1}getRelativePosition(t,e){return{x:t-this.currentWorldCollumn,y:e-this.currentWorldRow}}setWorldScene(t,e){if("-1"!=e.rawText["1"].styleMap?h.Copy(this._activeStyleObject,e.styleMap[e.rawText["1"].styleMap]):h.Clear(this._activeStyleObject),e.entityLocations)for(let n of e.entityLocations[e.activeEntityMap])this.DS.entityManager.createNewEntity(t,n.data.data?n.data.data:{},n.data.entityName,n.data.type,n.x,n.y);this.currentWorldData=e.screenStates["1"],"level"==t&&(this.currentCollisonMap=e.collisionMaps["1"]),this.worldHeight=20,this.worldWidth=50,0==Object.keys(e.animations).length&&void 0==e.screenStateAnimationKeys[e.activeAnimationScreenState]||""==e.activeAnimationScreenState?this.hasAnimations=!1:this.hasAnimations=!0}setWorldData(t){this.currentWorldData=t,this.worldHeight=18,this.worldWidth=50}async runGameLoop(){this.drawInterval=setInterval(()=>{this.renderer.entityTool.mesh.thinInstanceBufferUpdated("faceData"),this._drawLoop()},DRAWINTERVAL),this.logicInterval=setInterval(()=>{this._logicLoop()},LOGICINTERVAL)}async _logicLoop(){this.DS.entityManager.$run(),this._updateMenus()}_drawLoop(){this._drawMenus(),this.renderer.showAt(this.screenBorder,0,0);let t=2;for(let e=this.currentWorldRow;e<this.currentWorldRow+this.screenHeight;e++)this.currentWorldData[e]&&(this.renderer.showAt(this.renderer.stylize(this.currentWorldData[e].substring(this.currentWorldCollumn,this.currentWorldCollumn+this.screenWidth),this._activeStyleObject),t,1),t++);"battle"==this.activeSceneTypes&&this.DS.battleDrawer.$draw(),this._doWorldAnimations(),this._doSceneAnimations(),this.DS.player.$draw(),this.DS.entityManager.$draw()}async _updateMenus(){this.DS.menuSceneManager.$run()}async _drawMenus(){this.DS.menuSceneManager.$draw()}async _doWorldAnimations(){"battle"==this.activeSceneTypes&&this.DS.battleSceneManager.$doSceneWorldAnimations(),"level"==this.activeSceneTypes&&this.DS.levelManager.$doSceneWorldAnimations(),this.DS.menuSceneManager.$doSceneWorldAnimations()}async _doSceneAnimations(){"battle"==this.activeSceneTypes&&this.DS.battleSceneManager.$doSceneAnimations(),"level"==this.activeSceneTypes&&this.DS.levelManager.$doSceneAnimations(),this.DS.menuSceneManager.$doSceneAnimations()}constructor(t,e){this.renderer=t,this.DS=e,this.activeSceneTypes="level",this.hasAnimations=!1,this.worldHeight=0,this.worldWidth=0,this.sceneTransitiong=!1,this.currentCollisonMap=[],this.currentWorldData=[],this.screenWidth=48,this.screenHeight=17,this.currentWorldCollumn=0,this.currentWorldRow=0,this.borderDrawn=!1,this.borderAnimatng=!1,this._activeStyleObject=h.New({});let n=t.stylize("***********",{bg:a.Red,fg:a.Black,bright:!0})+t.stylize(" Empyrean Crystalline Dread ",{bg:a.Red,fg:a.Black,bright:!0})+t.stylize("***********",{bg:a.Red,fg:a.Black,bright:!0}),i=t.stylize("▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒",{fg:a.Blue,dim:!0});this.screenBorder="".concat(n,"\n").concat(i)}}class M{async processSceneStates(t){for(let e of Object.keys(t.rawText)){let n=t.rawText[e].map.split(/\r\n|\r|\n/);n.splice(0,1),n.splice(n.length-1,1);let i=[];for(let t of n)i.push(t.substring(1,t.length-1));t.screenStates[e]=i}}async processCollisionMaps(t){for(let e of Object.keys(t.collisionMapsRaw)){let n=t.collisionMapsRaw[e].split(/\r\n|\r|\n/);n.splice(0,1),n.splice(n.length-1,1);let i=[];for(let t of n)i.push(t.substring(1,t.length-1));t.collisionMaps[e]=i}}async processEntityMaps(t){for(let e of Object.keys(t.entityMapRaw)){let n=t.entityMapRaw[e].split(/\r\n|\r|\n/),i=t.entityMap;t.entityLocations={},t.entityLocations[e]=[];let a=0;for(let s of n){a++;let n=0;for(let r of s)n++,i[r]&&t.entityLocations[e].push({x:n-1,y:a,data:i[r]})}}}constructor(t){this.DS=t}}class D{_createBattleCursor(){this.battleCursor=this.DS.entityManager.createNewEntity("battle",{},"BattleCursorEntity","",0,0)}_reMapFormMap(){for(let t of Object.keys(this.formMap)){let e=parseInt(t);for(let t of this.formMap[e]){let n=this.currentFearForms[t];if(!n.alive){let t=this.formMap[e].indexOf(n.id);this.formMap[e].splice(t,1)}}}let t=0;for(let e of Object.keys(this.formMap)){let n=parseInt(e);0==this.formMap[n].length?delete this.formMap[n]:(this.formMap[t]=this.formMap[n],t++)}}async _placeAndInitFearForms(){let t=0,e=0,n=3,i=3,a=0;for(let s of(this.formMap[0]=[],Object.keys(this.currentBattleSet)))for(let r of this.currentBattleSet[s])for(let o=0;o<r.num;o++){let o=JSON.parse(JSON.stringify(this.DS.fearFormManager.getFearForm(s,r.id))),l=this.DS.entityManager.createNewEntity("battle",o,"FearFormEntity","",i,n);this.currentFearForms[t]={alive:!0,id:t,row:n,col:i,data:o,entity:l},this.formMap[e].push(t),o.boundingBox.height>a&&(a=o.boundingBox.height),(i+=o.boundingBox.width)+2>SCREENWIDTH-o.boundingBox.width?(n+=a+1,a=0,i=3,e++,this.formMap[e]||(this.formMap[e]=[])):i+=2,t++}}async enterBattle(t){this.battleActive=!0,this.DS.player.active=!1,SOUNDENABLED&&(this.DS.audioManager.playSong("battle-music-1",!0),await this.DS.renderer.asyncSleep(100)),this.currentBattleSet=t,this.DS.battleDrawer.active=!1,this.DS.menuSceneManager.rightMenuDrawer.active&&this.DS.menuSceneManager.rightMenuDrawer.popIn(),await this.DS.screenTranistions.doScreenWipe("wipe-2"),this.DS.engine.activeSceneTypes="battle",this.DS.battleSceneManager.setActiveSceneMeta("transitions"),this.DS.battleSceneManager.setActiveScene("transitions","transition-frame"),setTimeout(async()=>{this.DS.menuSceneManager.setActiveSceneMeta("right-battle-menu"),this.DS.menuSceneManager.rightMenuDrawer.setActiveMenuScene("right-battle-menu","bump"),await Promise.all([this.DS.screenTranistions.doScreenTransition("battle",this.DS.battleSceneManager.activeScene,this.DS.battleSceneManager.getScene("title-card"),"up"),this.DS.menuSceneManager.rightMenuDrawer.popOut(),this.DS.screenTranistions.doScreenTransition("bottom-menu",this.DS.menuSceneManager.bottomMenuDrawer.activeScene,this.DS.menuSceneManager.setActiveSceneMeta("bottom-menu").getScene("2"),"up")]),this.DS.menuSceneManager.rightMenuDrawer.setActiveMenuScene("right-battle-menu","bump"),setTimeout(async()=>{this.DS.battleSceneManager.setActiveSceneMeta("over-world-1"),await await Promise.all([this.DS.screenTranistions.doScreenTransition("battle",this.DS.battleSceneManager.activeScene,this.DS.battleSceneManager.getScene("1"),"down"),this.DS.screenTranistions.doScreenTransition("right-menu",this.DS.menuSceneManager.rightMenuDrawer.activeScene,this.DS.menuSceneManager.getScene("1"),"up"),this.DS.menuSceneManager.bottomRightMenuDrawer.popDown()]),this.DS.screenTranistions.doScreenTransition("bottom-right-menu",this.DS.menuSceneManager.bottomRightMenuDrawer.activeScene,this.DS.menuSceneManager.setActiveSceneMeta("bottom-right-menu").getScene("2"),"up"),await this._placeAndInitFearForms(),this._createBattleCursor(),this.DS.player.active=!0,this.DS.player.canControl=!1,this.DS.battleDrawer.active=!0},3500)},1e3)}constructor(t){this.DS=t,this.battleActive=!1,this.currentFearForms={},this.formMap=[],this.currentBattleSet={}}}class x{getFearForm(t,e){return this.fearForms[t][e]}registerNewFearFormCategory(t){return this.fearForms[t]||(this.fearForms[t]={}),this}registerNewFearForm(t,e,n){return this.fearForms[t][e]=n,this}constructor(t){this.DS=t,this.fearForms={}}}class b{changeEntityAnimationState(t,e){let n=this.animatedEntitesAnimations[t],i=n[e][0];this.animatedEntites[t]={row:this.animatedEntites[t].row,col:this.animatedEntites[t].col,activeStateAnimation:e,count:0,interval:i.interval,currentFrame:0,maxFrames:n[e].length}}addEntity(t,e,n,i,a){this.DS.animationHelper.preprocessStyleKeyFrames(a);let s=a[i][0];this.animatedEntites[t]={row:e,col:n,activeStateAnimation:i,count:0,interval:s.interval,currentFrame:0,maxFrames:a[i].length},this.animatedEntitesAnimations[t]=a,this.animatedEntitesKeys.push(t)}$draw(){if(this.active)for(let t of this.animatedEntitesKeys){let e=this.animatedEntites[t],n=this.animatedEntitesAnimations[t][e.activeStateAnimation][e.currentFrame];if(this.DS.renderer.showAt(n.animText,e.row,e.col),0==e.count){if(e.currentFrame>=e.maxFrames-1)e.currentFrame=0;else{e.currentFrame++;let n=this.animatedEntitesAnimations[t][e.activeStateAnimation][e.currentFrame];e.count=n.interval,e.interval=n.interval}}else e.count--}}constructor(t){this.DS=t,this.active=!1,this.animatedEntitesKeys=[],this.animatedEntites={},this.animatedEntitesAnimations={}}}class C{preprocessStyleKeyFrames(t){for(let e of Object.keys(t))for(let n of t[e])n.animText=this.DS.renderer.stylize(n.animText,n.style);return t}constructor(t){this.DS=t}}class T{requestPlay(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.count++;let i="".concat(this.count);this.count>1e5&&(this.count=0),this.messageQue[i]={type:t,id:e,loop:n};let a=500;"song"==t&&(a=1e4),setTimeout(()=>{this.messageQue[i]=void 0,delete this.messageQue[i]},a)}async _getHTML(t,e){let n;console.log(t),"/start"==t?this.connected||(e.writeHead(200,this.htmlHeaders),n="<p>done</p<",this.connected=!0):"/"==t?(e.writeHead(200,this.htmlHeaders),n=await fs.readFile("./html/index.html","utf-8")):t.includes("js")&&(e.writeHead(200,thisHeader),t.includes("")||(t+=""),n=await fs.readFile("./html/".concat(t),"utf-8")),e.end(n)}async _getSong(t,e){let n=await fs.readFile(".".concat(t));e.writeHead(200,this.audioHeader),e.end(n,"utf-8")}async _getData(t,e){if("/data/update"==t)e.writeHead(200,this.dataHeader),e.end(JSON.stringify(this.messageQue),"utf-8");else if(t.includes("/data/complete")){let e=t.replace("/data/complete=","");this.messageQue[e]=void 0,delete this.messageQue[e]}else{let n=await fs.readFile(".".concat(t),"utf-8");e.writeHead(200,this.dataHeader),e.end(JSON.stringify(n),"utf-8")}}$awaitConnection(){return new Promise(t=>{let e=e=>{this.connected&&(clearInterval(e),t(!0))},n=setInterval(()=>{e(n)},1);e(n)})}$init(){n(12251).createServer(async(t,e)=>{let n=t.url;if(!n.includes("favicon")){if(n.includes("/js/")||"/"==n||"/start"==n)await this._getHTML(n,e);else{if(n.includes("/assets")){await this._getSong(t.url,e);return}await this._getData(n,e)}}}).listen(this.httpPort)}constructor(t=8080){this.httpPort=t,this.connected=!1,this.messageQue={},this.currentSoundData={playsound:!1},this.count=0,this.htmlHeaders={"Content-Type":"text/html","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"OPTIONS, POST, GET"},this.jsHeader={"Content-Type":"text/javascript"},this.audioHeader={"Content-Type":"audio/mpeg"},this.dataHeader={"Content-Type":"text/json"}}}class A{async playSong(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];await this.audioCom.requestPlay("song",t,e)}async playSFX(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];await this.audioCom.requestPlay("sfx",t,e)}constructor(t){this.DS=t,this.audioCom=new T}}class I{setActiveMenuScene(t,e){this.DS.menuSceneManager.setActiveSceneMeta(t),this.activeScene=this.DS.menuSceneManager.activeMeta.scene[e];let n=this.DS.menuSceneManager.activeMeta.scene[e].screenStates["1"];return this.currentMenuData=n,h.Copy(this.currentStyle,this.activeScene.styleMap[this.activeScene.rawText["1"].styleMap]),this.active&&this._createEntites(),this}_createEntites(){if(this.activeScene.entityLocations)for(let t of this.activeScene.entityLocations[this.activeScene.activeEntityMap])this.DS.entityManager.createNewEntity("right-menu",t.data.data?t.data.data:{},t.data.entityName,t.data.type,t.x,t.y)}async popOut(){for(this.active=!0,this.animating=!0;this.currentBorderCollumn<50;)this.currentCollumn++,this.currentBorderCollumn++,await this.DS.renderer.asyncSleep(8);this.animating=!1}async popIn(){for(this.animating=!0;this.currentBorderCollumn>2;)this.currentCollumn--,this.currentBorderCollumn--,await this.DS.renderer.asyncSleep(8);this.animating=!1,this.active=!1}$doSceneAnimations(){}$doSceneWorldAnimations(){}$run(){}setMenuBorderMode(t){this.menuBorderMode=t}async $draw(){if(!this.active)return;if(0==this.menuBorderMode)for(let t=this.currentBorderRow;t<RIGHTMENUHEIGHT;t++)this.DS.renderer.showAt(this.menuBorder[t],this.currentBorderRow+t,this.currentBorderCollumn);if(1==this.menuBorderMode)for(let t=this.currentBorderRow;t<RIGHTMENUHEIGHT;t++)this.DS.renderer.showAt(this.menuBorder2[t],this.currentBorderRow+t,this.currentBorderCollumn);let t=2;for(let e=this.currentRow;e<this.currentRow+RIGHTMENUHEIGHT;e++)!(t>RIGHTMENUHEIGHT-2)&&(this.DS.renderer.showAt(this.DS.renderer.stylize(this.currentMenuData[e],this.currentStyle),t,this.currentCollumn+1),t++)}constructor(t){this.DS=t,this.activeScene={id:"",activeAnimationScreenState:"",activeEntityMap:"",entityMap:{},entityMapRaw:{},animations:{},styleMap:{},screenStateAnimationKeys:{},rawText:{},screenStates:{}},this.active=!1,this.animating=!1,this.currentBorderCollumn=2,this.currentBorderRow=0,this.currentMenuData=[],this.currentCollumn=2,this.currentRow=0,this.menuBorderMode=0,this.baseRightBorder="",this.menuBorder=[],this.menuBorder2=[],this.currentStyle=h.New({}),this.baseRightBorder="\n┌────────────────────────────┐                                   \n│                            │                                                   \n│                            │                                                   \n│                            │                                                                                                   \n│                            │                                                   \n│                            │                                                   \n│                            │                                                   \n│                            │                                                   \n│                            │                                                                  \n│                            │                                                   \n│                            │                                                   \n│                            │                                                               \n│                            │                                                   \n│                            │                                                   \n│                            │                                                   \n│                            │                                                   \n│                            │                                                   \n│                            │                                                   \n└────────────────────────────┘                                      ",this.menuBorder=this.baseRightBorder.split("\n"),this.menuBorder2="\n┌────────────────────────────┐                                   \n│                            │                                                   \n│                            │                                                   \n│                            │                                                                                                   \n│                            │                                                   \n│                            │                                                   \n│                            │                                                   \n│                            │                                                   \n│                            │                                                                  \n│                            │                                                   \n│                            │                                                   \n│                            │                                                               \n│                            │                                                   \n│                            │                                                   \n│                            │                                                   \n│                            │                                                   \n│                            │                                                   \n│                            │                                                   \n┣────────────────────────────┫                                      ".split("\n");let e=0;for(let t of this.menuBorder)this.menuBorder[e]=this.DS.renderer.stylize(t,{fg:a.Blue,dim:!0}),this.menuBorder2[e]=this.DS.renderer.stylize(this.menuBorder2[e],{fg:a.Blue,dim:!0}),e++}}class _{setActiveMenuScene(t,e){this.DS.menuSceneManager.setActiveSceneMeta(t),this.activeScene=this.DS.menuSceneManager.activeMeta.scene[e];let n=this.DS.menuSceneManager.activeMeta.scene[e].screenStates["1"];if(this.currentMenuData=n,h.Copy(this.currentStyle,this.activeScene.styleMap[this.activeScene.rawText["1"].styleMap]),this.activeScene.entityLocations)for(let t of this.activeScene.entityLocations[this.activeScene.activeEntityMap])this.DS.entityManager.createNewEntity("bottom-menu",t.data.data?t.data.data:{},t.data.entityName,t.data.type,t.x,t.y);for(let t of(this.screenStateAnimationActiveID=this.activeScene.activeAnimationScreenState,this.animations={},this.animationIntervalMap={},""!=this.screenStateAnimationActiveID&&0!=this.activeScene.screenStateAnimationKeys[this.screenStateAnimationActiveID].length?(this.screenStateAnimationInterval=this.activeScene.screenStateAnimationKeys[this.screenStateAnimationActiveID][0].inteerval,this.screenStateAnimationIntervalCount=this.activeScene.screenStateAnimationKeys[this.screenStateAnimationActiveID][0].inteerval,this.screenStateKeyCount=0,this.screenStateKeyTotal=this.activeScene.screenStateAnimationKeys[this.screenStateAnimationActiveID].length,this.hasSceneAnimations=!0):(this.screenStateAnimationInterval=-1,this.screenStateAnimationIntervalCount=-1,this.screenStateKeyCount=0,this.screenStateKeyTotal=0,this.hasSceneAnimations=!1),this.animations=this.activeScene.animations,Object.keys(this.activeScene.animations))){let e=this.activeScene.animations[t],n=e[0].interval;this.animationIntervalMap[t]={interval:n,count:0,totalFrames:e.length,currentFrame:0}}return Object.keys(this.animationIntervalMap).length>0?this.hasWorldAnimations=!0:this.hasWorldAnimations=!1,this}$doSceneAnimations(){if(this.active&&this.hasSceneAnimations){if(0==this.screenStateAnimationIntervalCount){this.screenStateKeyCount>=this.screenStateKeyTotal-1?this.screenStateKeyCount=0:this.screenStateKeyCount++;let t=this.activeScene.screenStateAnimationKeys[this.screenStateAnimationActiveID][this.screenStateKeyCount];this.screenStateAnimationIntervalCount=t.inteerval,this.SetWorldData(this.activeScene.screenStates[t.stateName]),"-1"!=this.activeScene.rawText[t.stateName].styleMap&&h.Copy(this.currentStyle,this.activeScene.styleMap[this.activeScene.rawText[t.stateName].styleMap])}else this.screenStateAnimationIntervalCount>0&&this.screenStateAnimationIntervalCount--}}SetWorldData(t){this.currentMenuData=t}$doSceneWorldAnimations(){if(this.active&&this.hasWorldAnimations)for(let t of Object.keys(this.animations)){let e=this.animationIntervalMap[t],n=this.animations[t][e.currentFrame],i=0,a=!1;for(let t of((null==n?void 0:n.animDirection)=="up"&&(a=!0),n.animText)){let e=this.DS.renderer.stylize(t,n.style);this.DS.renderer.showAt(e,n.row+i,n.col),a?i--:i++}0==e.count?(e.currentFrame>=e.totalFrames-1?e.currentFrame=0:e.currentFrame++,e.interval=this.animations[t][e.currentFrame].interval,e.count=e.interval):e.count--}}$run(){}async $draw(){if(!this.active)return;if(!this.drawn||this.animating)for(let t=0;t<BOTTOMMENUHEIGHT;t++)this.DS.renderer.showAt(this.menuBorder[t],this.currentBorderRow+t,this.currentBorderCollumn);let t=this.currentBorderRow;for(let e=this.currentRow;e<this.currentRow+BOTTOMMENUHEIGHT;e++)!(t>BOTTOMMENUHEIGHT+this.currentBorderRow-2)&&(this.DS.renderer.showAt(this.DS.renderer.stylize(this.currentMenuData[e],this.currentStyle),t,this.currentCollumn+1),t++)}constructor(t){this.DS=t,this.animations={},this.animationIntervalMap={},this.screenStateKeyCount=0,this.screenStateKeyTotal=0,this.screenStateAnimationInterval=-1,this.screenStateAnimationIntervalCount=-1,this.screenStateAnimationActiveID="",this.hasSceneAnimations=!1,this.hasWorldAnimations=!1,this.activeScene={id:"",activeAnimationScreenState:"",activeEntityMap:"",entityMap:{},entityMapRaw:{},animations:{},styleMap:{},screenStateAnimationKeys:{},rawText:{},screenStates:{}},this.active=!0,this.currentBorderCollumn=0,this.currentBorderRow=SCREENHEIGHT+3,this.currentMenuData=[],this.currentCollumn=0,this.currentRow=0,this.baseBottomBorder="",this.menuBorder=[],this.currentStyle=h.New({}),this.drawn=!1,this.animating=!1,this.baseBottomBorder="│                                                │\n│                                                │\n│                                                │\n│                                                │\n│                                                │\n│                                                │\n│                                                │\n└────────────────────────────────────────────────┘",this.menuBorder=this.baseBottomBorder.split("\n");let e=0;for(let t of this.menuBorder)this.menuBorder[e]=this.DS.renderer.stylize(t,{fg:a.Blue,dim:!0}),e++}}class E{setActiveMenuScene(t,e){this.DS.menuSceneManager.setActiveSceneMeta(t),this.activeScene=this.DS.menuSceneManager.activeMeta.scene[e];let n=this.DS.menuSceneManager.activeMeta.scene[e].screenStates["1"];if(this.currentMenuData=n,h.Copy(this.currentStyle,this.activeScene.styleMap[this.activeScene.rawText["1"].styleMap]),this.activeScene.entityLocations)for(let t of this.activeScene.entityLocations[this.activeScene.activeEntityMap])this.DS.entityManager.createNewEntity("bottom-right-menu",t.data.data?t.data.data:{},t.data.entityName,t.data.type,t.x,t.y);return this}async popDown(){for(this.active||(this.active=!0),this.DS.menuSceneManager.rightMenuDrawer.setMenuBorderMode(1);this.currentRow<BOTTOMRIGHTMENUHEIGHT;)this.currentRow++,this.currentBorderRow++,await this.DS.renderer.asyncSleep(30)}async popUp(){for(;this.currentRow>SCREENHEIGHT+3-BOTTOMRIGHTMENUHEIGHT;)this.currentRow--,this.currentBorderRow--,await this.DS.renderer.asyncSleep(15);this.DS.menuSceneManager.rightMenuDrawer.setMenuBorderMode(0),this.active=!1}$doSceneAnimations(){}$doSceneWorldAnimations(){}$run(){}async $draw(){if(!this.active)return;if(!this.drawn||this.animating){for(let t=0;t<BOTTOMRIGHTMENUHEIGHT;t++)this.DS.renderer.showAt(this.menuBorder[t],this.currentBorderRow+t,this.currentBorderCollumn);this.drawn}let t=this.currentBorderRow;for(let e=this.currentRow;e<this.currentRow+BOTTOMMENUHEIGHT;e++)!(t>BOTTOMMENUHEIGHT+this.currentBorderRow-2)&&(this.DS.renderer.showAt(this.DS.renderer.stylize(this.currentMenuData[e],this.currentStyle),t,this.currentBorderCollumn+this.currentCollumn-1),t++)}constructor(t){this.DS=t,this.activeScene={id:"",activeAnimationScreenState:"",activeEntityMap:"",entityMap:{},entityMapRaw:{},animations:{},styleMap:{},screenStateAnimationKeys:{},rawText:{},screenStates:{}},this.active=!1,this.currentBorderCollumn=50,this.currentBorderRow=SCREENHEIGHT+3-BOTTOMRIGHTMENUHEIGHT,this.currentMenuData=[],this.currentCollumn=2,this.currentRow=0,this.baseBottomBorder="",this.menuBorder=[],this.currentStyle=h.New({}),this.animating=!0,this.drawn=!1,this.baseBottomBorder="│                            │                         \n│                            │                                                   \n│                            │                                                 \n│                            │                                                   \n│                            │                                                 \n│                            │                                                   \n│                            │                                                 \n└────────────────────────────┘                                    ",this.menuBorder=this.baseBottomBorder.split("\n");let e=0;for(let t of this.menuBorder)this.menuBorder[e]=this.DS.renderer.stylize(t,{fg:a.Blue,dim:!0}),e++}}var R=n(40257);class N{addKeyControl(t,e,n){this.keyControls[e][t]||(this.keyControls[e][t]=[]),this.keyControls[e][t].push(n)}addCharControl(t,e,n){this.charControls[e][t]||(this.charControls[e][t]=[]),this.charControls[e][t].push(n)}setActiveSceneMeta(t){return this.activeMeta=this.scenes[t],this}setActiveScene(t,e){return this.activeScene=this.scenes[t].scene[e],this}registerSceneMeta(t){return this.scenes[t]={id:t,scene:{}},this}addSceneToMeta(t,e){return Promise.all([this.DS.sceneProcessor.processSceneStates(e),this.DS.sceneProcessor.processEntityMaps(e)]),this.scenes[t].scene[e.id]=e,this}getScene(t){return this.activeMeta.scene[t]}async $draw(){this.bottomMenuDrawer.$draw(),this.bottomRightMenuDrawer.$draw(),this.rightMenuDrawer.$draw()}async $run(){this.rightMenuDrawer.$run(),this.bottomMenuDrawer.$run(),this.bottomRightMenuDrawer.$run()}$doSceneAnimations(){if(this.rightMenuDrawer.active,this.bottomMenuDrawer.active)try{this.bottomMenuDrawer.$doSceneAnimations()}catch(t){console.log(t),R.exit(0)}this.bottomRightMenuDrawer.active}$doSceneWorldAnimations(){this.rightMenuDrawer.active,this.bottomMenuDrawer.active&&this.bottomMenuDrawer.$doSceneWorldAnimations(),this.bottomRightMenuDrawer.active}constructor(t){this.DS=t,this.animations={},this.animationIntervalMap={},this.screenStateKeyCount=0,this.screenStateKeyTotal=0,this.screenStateAnimationInterval=-1,this.screenStateAnimationIntervalCount=-1,this.activeMeta={id:"overworld",scene:{}},this.scenes={},this.activeScene={id:"",activeAnimationScreenState:"",activeEntityMap:"",entityMap:{},entityMapRaw:{},animations:{},styleMap:{},screenStateAnimationKeys:{},rawText:{},screenStates:{}},this.keyControls={up:{},left:{},right:{},down:{},enter:{}},this.charControls={m:{},h:{},z:{},x:{}},this.rightMenuDrawer=new I(t),this.bottomMenuDrawer=new _(t),this.bottomRightMenuDrawer=new E(t),this.DS.controlManager.onInput("up",async()=>{for(let t of Object.keys(this.keyControls.up))for(let e of this.keyControls.up[t])await e()},this),this.DS.controlManager.onInput("down",async()=>{for(let t of Object.keys(this.keyControls.down))for(let e of this.keyControls.down[t])await e()},this),this.DS.controlManager.onInput("left",()=>{for(let t of Object.keys(this.keyControls.left))for(let e of this.keyControls.left[t])e()},this),this.DS.controlManager.onInput("right",()=>{for(let t of Object.keys(this.keyControls.right))for(let e of this.keyControls.right[t])e()},this),this.DS.controlManager.onInput("enter",()=>{for(let t of Object.keys(this.keyControls.enter))for(let e of this.keyControls.enter[t])e()},this),this.DS.controlManager.onInput("z",()=>{for(let t of Object.keys(this.charControls.z))for(let e of this.charControls.z[t])e()},this),this.DS.controlManager.onInput("x",()=>{for(let t of Object.keys(this.charControls.x))for(let e of this.charControls.x[t])e()},this),this.DS.controlManager.onInput("m",()=>{for(let t of Object.keys(this.charControls.m))for(let e of this.charControls.m[t])e()},this),this.DS.controlManager.onInput("h",()=>{for(let t of Object.keys(this.charControls.h))for(let e of this.charControls.h[t])e()},this)}}var O=n(85611);class B{onInput(t,e){let n=this.observers.get(t);n||(n=new O.y,this.observers.set(t,n)),n.subscribe(e)}_setUpHooks(){window.addEventListener("keydown",t=>{let{key:e}=t,n=this.observers.get(e);n&&n.notify()})}constructor(t){this.DS=t,this.observers=new Map,this._setUpHooks()}}class k{constructor(t){this.DS=t}}class F{registerNewWeapon(t){this.items.weapon[t.id]=t}registerNewPotion(t){this.items.potion[t.id]=t}registerNewRing(t){this.items.ring[t.id]=t}registerNewArmor(t){this.items.armor[t.id]=t}registerNewStoryItem(t){this.items.story[t.id]=t}registerNewOtherItem(t){this.items.other[t.id]=t}constructor(t){this.DS=t,this.items={potion:{},ring:{},weapon:{},armor:{},other:{},story:{}}}}class H{getData(){return this.currentData}equipItem(t,e){this.currentEquirpedItems[t].push(e)}unEquipItem(t,e){let n=this.currentEquirpedItems[t].indexOf(e);-1!=n&&this.currentEquirpedItems[t].slice(n,1)}getEquipedItem(t){return this.currentEquirpedItems[t]}addItem(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=!1;for(let a of this.currentData.currentInventory[t])if(a.id==e.id){a.amount+=n,i=!0;break}i||this.currentData.currentInventory[t].push({id:e.id,amount:n})}constructor(t){this.DS=t,this.currentEquirpedItems={armor:[],ring:[],weapon:[]},this.currentData={currentHealth:50,maxHealth:50,maxMana:30,currentMana:30,level:1,totalMana:30,attack:3,deffense:1,speed:3,intellegence:5,wisdom:4,luck:1,currentInventory:{potion:[],ring:[],weapon:[],armor:[],other:[],story:[]}}}}class W{constructor(t){this.DS=t,this.currentDimension="OverWorld",this.currentLocation="Hall Of Portals"}}class L{gameInit(){this.levelManager.setActiveSceneMeta("overworld"),this.levelManager.setActiveScene("overworld","1"),this.menuSceneManager.bottomMenuDrawer.setActiveMenuScene("bottom-menu","1"),this.menuSceneManager.bottomRightMenuDrawer.setActiveMenuScene("bottom-right-menu","1"),this.engine.runGameLoop(),SOUNDENABLED&&this.audioManager.playSong("overworld",!0)}constructor(t){this.renderer=t,this.battleDrawer=new b(this),this.battleManager=new D(this),this.sceneProcessor=new M(this),this.fearFormManager=new x(this),this.playerData=new H(this),this.levelManager=new p(this),this.battleSceneManager=new v(this),this.audioManager=new A(this),this.controlManager=new B(this),this.screenTranistions=new d(this),this.animationHelper=new C(this),this.inventoryManager=new k(this),this.itemManager=new F(this),this.worldData=new W(this),this.title="",this.screenBorder="",this.engine=new f(t,this),this.player=new w(t,this),this.menuSceneManager=new N(this),this.entityManager=new g(t,this)}}class K{_setUpKeyFrames(){this.keyFrames=[{text:"<O>",styleObj:{fg:this.fgColor,dim:!0},interval:2},{text:"<0>",styleObj:{fg:this.fgColor,dim:!0},interval:1},{text:"<<>>",styleObj:{fg:this.fgColor,bright:!0},interval:6},{text:"<0>",styleObj:{fg:this.fgColor,dim:!0},interval:1},{text:"<O>",styleObj:{fg:this.fgColor,dim:!0},interval:2}],this.maxFames=this.keyFrames.length}_getProbality(t,e){return"left"==t&&e>0?.8:"left"==t?.3:"right"==t&&e<0?.8:"right"==t?.3:"up"==t&&e>0?.8:"up"==t?.3:"down"==t&&e<=0?.8:.3}_playerCollide(){}$run(){if(!this.active)return;let t=this.x-DS.player.x,e=this.y-DS.player.y;if(t&&e||this._playerCollide(),0==this.tickCount){if(S(.2));else{if(S(this._getProbality("right",t))&&!this._collisionCheck("right")&&this.x+3<SCREENWIDTH){this.x++;return}if(S(this._getProbality("left",t))&&!this._collisionCheck("left")&&1!=this.x){this.x--;return}if(S(this._getProbality("up",e))&&!this._collisionCheck("up")&&this.y>2){this.y--;return}if(S(this._getProbality("down",e))&&this.y-1<SCREENHEIGHT&&!this._collisionCheck("down")){this.y++;return}}}else this.tickCount--}_collisionCheck(t){let e=!1,n=[];switch(t){case"up":try{if(2==this.y)return!0;n=DS.engine.readWorldDataSection(this.y-3,this.y-3,this.x-1,this.x+1)}catch(e){console.log(this.y),console.log(t),console.log(e)}break;case"down":try{n=DS.engine.readWorldDataSection(this.y-1,this.y-1,this.x-1,this.x+1)}catch(e){console.log(t),console.log(e)}break;case"right":try{n=DS.engine.readWorldDataSection(this.y-2,this.y+1,this.x+3,this.x+3)}catch(e){console.log(t),console.log(e)}break;case"left":try{n=DS.engine.readWorldDataSection(this.y-2,this.y+2,this.x-2,this.x-2)}catch(e){console.log(t),console.log(e)}}for(let t of n)for(let n of t)if(this.walls.indexOf(n)>-1){e=!0;continue}return e}$draw(){if(!this.draw)return;let t=this.keyFrames[this.currentFrame],e=DS.renderer.stylize(t.text,t.styleObj);if(DS.renderer.showAt(e,this.y,this.x),0==this.animtationCount){this.currentFrame<this.maxFames-1?this.currentFrame++:this.currentFrame=0;let t=this.keyFrames[this.currentFrame];this.animtationCount=t.interval}else this.animtationCount--}$destroy(){}constructor(t,e,n,i,a,s){this.data=t,this.id=e,this.type=n,this.x=i,this.y=a,this.sceneType=s,this.tickInterval=20,this.tickCount=0,this.walls=["|","*","_","-","(",")","=","█"],this.entityWidth=2,this.entityHeight=2,this.animtionInterval=10,this.animtationCount=0,this.keyFrames=[],this.currentFrame=0,this.maxFames=0,this.draw=!0,this.active=!0,t.fgColor&&(this.fgColor=t.fgColor),this._setUpKeyFrames()}}class P{_determineBattleSet(){let t={};for(let e of Object.keys(this.data))for(let n of this.data[e])if(S(n.probability)||1==n.probability){for(let i of n.fearFormMap)if(S(i.probability)||i.min>=1){let n=1;i.min!=i.max?n+=Math.random()*i.max>>>0:n=i.min,t[e]||(t[e]=[]),t[e].push({num:n,id:i.id})}}return t}_spawn(){if(this.currentEntites>=this.maxEntites)return;let t=this._determineBattleSet();DS.entityManager.createNewEntity("level",t,"FearCrystalWanderEntity","test",this.x,this.y),this.currentEntites++}$run(){this.active&&this.x-DS.player.x&&this.y-DS.player.y&&(0==this.tickCount?(S(this.spawnProbabliltiy)&&this._spawn(),this.tickCount=this.tickInterval):this.tickCount--)}$draw(){if(!this.draw)return}$destroy(){}constructor(t,e,n,i,a,s){this.data=t,this.id=e,this.type=n,this.x=i,this.y=a,this.sceneType=s,this.maxEntites=2,this.currentEntites=0,this.tickInterval=5,this.tickCount=0,this.active=!0,this.draw=!1,this.spawnProbabliltiy=.8}}class X{_getProbality(t,e){return"left"==t&&e>0?.85:"left"==t?.3:"right"==t&&e<0?.85:"right"==t?.3:"up"==t&&e>0?.85:"up"==t?.3:"down"==t&&e<=0?.85:.3}_playerCollide(){DS.battleManager.battleActive||DS.battleManager.enterBattle(this.data)}$run(){if(!this.active)return;let t=this.x-DS.player.x,e=this.y-DS.player.y;if(t||e||this._playerCollide(),0==this.tickCount){if(S(.2));else{if(S(this._getProbality("right",t))&&!this._collisionCheck("right")&&this.x+3<SCREENWIDTH){this.x++;return}if(S(this._getProbality("left",t))&&!this._collisionCheck("left")&&1!=this.x){this.x--;return}if(S(this._getProbality("up",e))&&!this._collisionCheck("up")&&this.y>2){this.y--;return}if(S(this._getProbality("down",e))&&this.y-1<SCREENHEIGHT&&!this._collisionCheck("down")){this.y++;return}}}else this.tickCount--}_collisionCheck(t){let e=!1,n=[];switch(t){case"up":try{if(2==this.y)return!0;n=DS.engine.readWorldDataSection(this.y-3,this.y-3,this.x-1,this.x+1)}catch(e){console.log(this.y),console.log(t),console.log(e)}break;case"down":try{n=DS.engine.readWorldDataSection(this.y-1,this.y-1,this.x-1,this.x+1)}catch(e){console.log(t),console.log(e)}break;case"right":try{n=DS.engine.readWorldDataSection(this.y-2,this.y+1,this.x+6,this.x+6)}catch(e){console.log(t),console.log(e)}break;case"left":try{n=DS.engine.readWorldDataSection(this.y-2,this.y+2,this.x-2,this.x-2)}catch(e){console.log(t),console.log(e)}}for(let t of n)for(let n of t)if(this.walls.indexOf(n)>-1){e=!0;continue}return e}$draw(){if(!this.draw)return;let t=this.keyFrames[this.currentFrame],e=DS.renderer.stylize(t.text,t.styleObj);if(DS.renderer.showAt(e,this.y,this.x),0==this.animtationCount){this.currentFrame<this.maxFames-1?this.currentFrame++:this.currentFrame=0;let t=this.keyFrames[this.currentFrame];this.animtationCount=t.interval}else this.animtationCount--}$destroy(){}constructor(t,e,n,i,s,r){this.data=t,this.id=e,this.type=n,this.x=i,this.y=s,this.sceneType=r,this.tickInterval=5,this.tickCount=0,this.walls=["|","*","_","-","(",")","=","█"],this.entityWidth=2,this.entityHeight=2,this.animtionInterval=10,this.animtationCount=0,this.keyFrames=[{text:" [ ] ",styleObj:{fg:a.Red,dim:!0},interval:2},{text:" [╬] ",styleObj:{fg:a.Red,bright:!0},interval:2},{text:"[<╬>]",styleObj:{fg:a.Red,dim:!0},interval:2},{text:"<<╬>>",styleObj:{fg:a.Red,bright:!0},interval:2},{text:"[<╬>]",styleObj:{fg:a.Red,dim:!0},interval:2},{text:" [0] ",styleObj:{fg:a.Red,bright:!0},interval:2},{text:"[<0>]",styleObj:{fg:a.Red,dim:!0},interval:2},{text:" [0] ",styleObj:{fg:a.Red,bright:!0},interval:2},{text:"[{░}]",styleObj:{fg:a.Red,dim:!0},interval:2},{text:"[<▒>]",styleObj:{fg:a.Red,bright:!0},interval:2},{text:"<<▓>>",styleObj:{fg:a.Red,dim:!0},interval:2},{text:"[<▒>]",styleObj:{fg:a.Red,bright:!0},interval:2},{text:"[{░}]",styleObj:{fg:a.Red,dim:!0},interval:2},{text:" [░] ",styleObj:{fg:a.Red,bright:!0},interval:2}],this.currentFrame=0,this.maxFames=this.keyFrames.length,this.draw=!0,this.active=!0}}class G{_setUpKeyFrames(){"Rain"==this.type&&this._makeRain(),"Sparkle"==this.type&&this._makeSparkle(),this.maxFames=this.keyFrames.length}_makeRain(){this.keyFrames=[{animText:"│",style:{fg:this.fgColor,dim:!1},interval:2},{animText:"│",style:{fg:this.fgColor,dim:!1},interval:2},{animText:"│",style:{fg:this.fgColor,dim:!1},interval:2}],this.keyFrames=DS.animationHelper.preprocessStyleKeyFrames({1:this.keyFrames})["1"];for(let t=0;t<this.particleCount;t++)this.particles.push({respawnCount:10*Math.random()>>>0,alive:!0,x:(Math.random()*SCREENWIDTH>>>0)+2,y:(Math.random()*SCREENHEIGHT>>>0)+2})}async _runRain(){for(let t of this.particles)t.respawnCount?t.respawnCount--:(t.y++,(t.x>=SCREENWIDTH||t.y>SCREENHEIGHT+1)&&(t.x=(Math.random()*SCREENWIDTH>>>0)+1,t.y=2,t.respawnCount=10*Math.random()>>>0))}_makeSparkle(){this.keyFrames=[{animText:"|",style:{fg:a.Cyan,dim:!0},interval:4},{animText:"0",style:{fg:a.Cyan,bright:!0},interval:4}],this.keyFrames=DS.animationHelper.preprocessStyleKeyFrames({1:this.keyFrames})["1"];for(let t=0;t<this.particleCount;t++)this.particles.push({respawnCount:10*Math.random()>>>0,alive:!0,x:(Math.random()*SCREENWIDTH>>>0)+10,y:2})}async _runSparkle(){for(let t of this.particles)t.respawnCount?t.respawnCount--:(t.y++,(t.x>=SCREENWIDTH||t.y>SCREENHEIGHT+1)&&(t.x=(Math.random()*SCREENWIDTH>>>0)+5,t.y=2,t.respawnCount=10*Math.random()>>>0))}$run(){if(this.active){if(0==this.tickCount)switch(this.type){case"Rain":this._runRain();break;case"Sparkle":this._runSparkle()}else this.tickCount--}}$draw(){if(!this.draw)return;let t=this.keyFrames[this.currentFrame];for(let e of this.particles)e.respawnCount||DS.renderer.showAt(t.animText,e.y,e.x);if(0==this.animtationCount){this.currentFrame<this.maxFames-1?this.currentFrame++:this.currentFrame=0;let t=this.keyFrames[this.currentFrame];this.animtationCount=t.interval}else this.animtationCount--}$destroy(){}constructor(t,e,n="Rain",i,s,r){this.data=t,this.id=e,this.type=n,this.x=i,this.y=s,this.sceneType=r,this.tickInterval=5,this.tickCount=0,this.particleCount=50,this.particles=[],this.active=!0,this.draw=!0,this.keyFrames=[],this.animtionInterval=10,this.animtationCount=0,this.currentFrame=0,this.maxFames=0,this.fgColor=a.White,t.fgColor&&(this.fgColor=t.fgColor),this._setUpKeyFrames()}}class z{$draw(){if(!this.draw)return;let t=0;for(let e of this.drawText){let n=((SCREENWIDTH-e.length)/2>>>0)+1;DS.renderer.showAt(e,{row:this.y+t,col:n}),t++}}$run(){}$destroy(){}constructor(t,e,n,i,a,s){if(this.data=t,this.id=e,this.type=n,this.x=i,this.y=a,this.sceneType=s,this.battleSceneRandomText=["My power comes through the heat\nof 10,000 burning suns\nyet the crystalline fear challenges me. ","Not since infinity split has something\nthis dense and dark has spawned\nin the multiverse. ","I feel the fear forms pouring\nthrough the nexus\nThrough the eons they are slowing\nthe vibration of the entire universe.","I shall conquer all fear with valiant light.","My cosmic throne shall not be thwarted\n by these corruptions of consciousness.","I shall send this being of fear\n back into the core of being.","Forever and Now\nI am the mighty master of trillions.\nI weave time and space.\nYet these forms pose a threat\n to the whole balance of reality. "],this.drawText=[""],this.draw=!0,t.fgColor,"BattleScene"==n){let t=Math.random()*this.battleSceneRandomText.length>>>0;this.drawText=this.battleSceneRandomText[t].split("\n"),this.y=((SCREENHEIGHT-this.drawText.length)/2>>>0)+2}}}let j=h.New({fg:a.Cyan,bright:!0}),$=h.New({fg:a.Cyan,dim:!0});class U{$draw(){for(let t=0;t<this.eyeNum;t++){let e=this.eyeOne;t==this.currentEye&&(e=this.eyeTwo),DS.renderer.showAt(e,this.y+t,this.collumn+this.x)}}_runTick(){this.currentEye>this.eyeNum-1?this.currentEye=0:this.currentEye++}$run(){0==this.tickCount?(this._runTick(),this.tickCount=this.tickInterval):this.tickCount--}$destroy(){}constructor(t,e,n,i,a,s){this.data=t,this.id=e,this.type=n,this.x=i,this.y=a,this.sceneType=s,this.tickInterval=1,this.tickCount=0,this.collumn=0,this.currentEye=0,this.eyeNum=5,this.draw=!0,this.eyeOne="",this.eyeTwo="","bottom-bar"==n||"bottom-right-bar"==n?(this.eyeOne=DS.renderer.stylize("0",$),this.eyeTwo=DS.renderer.stylize("0",j),this.y=this.y+=SCREENHEIGHT+1,"bottom-right-bar"==n&&(this.collumn=SCREENWIDTH+3)):(this.collumn=SCREENWIDTH+3,this.eyeOne=DS.renderer.stylize("00",$),this.eyeTwo=DS.renderer.stylize("00",j))}}class Y{_stylize(){this.name=DS.renderer.stylize(this.name,this.nameStyle)}_getHealth(){let t=DS.playerData.getData().currentHealth,e=DS.playerData.getData().maxHealth;return"".concat(t,"/").concat(e)}_getMana(){let t=DS.playerData.getData().currentMana,e=DS.playerData.getData().maxMana;return"".concat(t,"/").concat(e)}_getLevel(){return DS.playerData.getData().level}_getAttack(){return DS.playerData.getData().attack}_getDeffense(){return DS.playerData.getData().deffense}_getSpeed(){return DS.playerData.getData().speed}_getIntellegence(){return DS.playerData.getData().speed}_getWisdom(){return DS.playerData.getData().speed}_getLuck(){return DS.playerData.getData().speed}$draw(){this.draw&&(DS.renderer.showAt(DS.renderer.stylize("Melchizedek",this.nameStyle),this.y,this.x+2).showAt(DS.renderer.stylize(this.levelLabel,this.labelStyle),this.y+1,this.x+0).showAt(DS.renderer.stylize(String(this._getLevel()),this.valueStyle),this.y+1,7+this.x+0+1).showAt(DS.renderer.stylize(this.healthLabel,this.labelStyle),this.y+2,this.x+0).showAt(DS.renderer.stylize(String(this._getHealth()),this.valueStyle),this.y+2,7+this.x+0+1).showAt(DS.renderer.stylize(this.manaLabel,this.labelStyle),this.y+3,this.x+0).showAt(DS.renderer.stylize(String(this._getMana()),this.valueStyle),this.y+3,7+this.x+0+1).showAt(DS.renderer.stylize(this.attackLabel,this.labelStyle),this.y+4,this.x+0).showAt(DS.renderer.stylize(String(this._getAttack()),this.valueStyle),this.y+4,3+this.x+0+1).showAt(DS.renderer.stylize(this.deffneseLabel,this.labelStyle),this.y+5,this.x+0).showAt(DS.renderer.stylize(String(this._getDeffense()),this.valueStyle),this.y+5,3+this.x+0+1).showAt(DS.renderer.stylize(this.speedLabel,this.labelStyle),this.y+6,this.x+0).showAt(DS.renderer.stylize(String(this._getSpeed()),this.valueStyle),this.y+6,3+this.x+0+1).showAt(DS.renderer.stylize(this.intellegenceLabel,this.labelStyle),this.y+4,8+this.x+0).showAt(DS.renderer.stylize(String(this._getIntellegence()),this.valueStyle),this.y+4,11+this.x+0+1).showAt(DS.renderer.stylize(this.wisdomLabel,this.labelStyle),this.y+5,8+this.x+0).showAt(DS.renderer.stylize(String(this._getWisdom()),this.valueStyle),this.y+5,11+this.x+0+1).showAt(DS.renderer.stylize(this.luckLabel,this.labelStyle),this.y+6,8+this.x+0).showAt(DS.renderer.stylize(String(this._getLuck()),this.valueStyle),this.y+6,11+this.x+0+1),this.drawn=!0)}$run(){}$destroy(){}constructor(t,e,n,i,s,r){this.data=t,this.id=e,this.type=n,this.x=i,this.y=s,this.sceneType=r,this.nameStyle=h.New({dim:!0,fg:a.Purple}),this.labelStyle=h.New({dim:!0,fg:a.Purple}),this.valueStyle=h.New({bright:!0,fg:a.Cyan}),this.name="Melchizedek",this.levelLabel="Level:",this.healthLabel="Health:",this.manaLabel="Mana:",this.attackLabel="ATK:",this.deffneseLabel="DEF:",this.speedLabel="SPD:",this.intellegenceLabel="INT:",this.wisdomLabel="WSD:",this.luckLabel="LCK:",this.draw=!0,this.drawn=!1,this._stylize(),("bottom-menu"==r||"bottom-right-menu"==r)&&(this.y=this.y+SCREENHEIGHT+1),("right-menu"==r||"bottom-right-menu"==r)&&(this.x=this.x+SCREENWIDTH+1)}}class V{getDimension(){return DS.worldData.currentDimension}_getLocation(){return DS.worldData.currentLocation}$draw(){this.draw&&DS.renderer.showAt(DS.renderer.stylize(this.label,this.labelStyle),this.y,this.x).showAt(DS.renderer.stylize(this.dimensionLabel,this.labelStyle),this.y+1,this.x+1).showAt(DS.renderer.stylize(String(this.getDimension()),this.valueStyle),this.y+2,this.x+1+1).showAt(DS.renderer.stylize(this.locationLabel,this.labelStyle),this.y+4,this.x+1).showAt(DS.renderer.stylize(String(this._getLocation()),this.valueStyle),this.y+5,this.x+1+1)}$run(){}$destroy(){}constructor(t,e,n,i,s,r){this.data=t,this.id=e,this.type=n,this.x=i,this.y=s,this.sceneType=r,this.labelStyle=h.New({dim:!0,fg:a.Purple}),this.valueStyle=h.New({bright:!0,fg:a.Cyan}),this.label="World",this.dimensionLabel="Current Dimension:",this.locationLabel="Current Location:",this.draw=!0,("bottom-menu"==r||"bottom-right-menu"==r)&&(this.y=this.y+SCREENHEIGHT+1),("right-menu"==r||"bottom-right-menu"==r)&&(this.x=this.x+SCREENWIDTH+1)}}class Z{$draw(){this.active&&this.draw&&DS.renderer.showAt(this.drawText,this.y,this.x)}$run(){}$destroy(){}constructor(t,e,n,i,a,s){this.data=t,this.id=e,this.type=n,this.x=i,this.y=a,this.sceneType=s,this.drawText="",this.active=!0,this.draw=!0,this.drawText=t.animations[t.activeAnimation][0].animText,DS.animationHelper.preprocessStyleKeyFrames(t.animations)}}var q=n(40257);class Q{setCursorOn(t,e){let n=DS.battleManager.currentFearForms[DS.battleManager.formMap[t][e]];return this.x=n.col-2,this.y=n.row,this.width=n.data.boundingBox.width+2,this.height=n.data.boundingBox.height+2,this.selectedEntityID=n.id,!0}_stylize(){this.barTopLeft=DS.renderer.stylize(this.barTopLeft,this.barStyle),this.barTopRight=DS.renderer.stylize(this.barTopRight,this.barStyle),this.barBottomRight=DS.renderer.stylize(this.barBottomRight,this.barStyle),this.barBottomLeft=DS.renderer.stylize(this.barBottomLeft,this.barStyle),this.barMiddle=DS.renderer.stylize(this.barMiddle,this.barStyle)}_setUpControls(){let t=this;DS.menuSceneManager.addKeyControl("battle-cursor","up",()=>{t.active&&(this.currentRow-1==-1?this.currentRow=Object.keys(DS.battleManager.formMap).length-1:DS.battleManager.formMap[t.currentRow-1][t.currentCollumn]&&this.currentRow--,t.setCursorOn(t.currentRow,t.currentCollumn))}),DS.menuSceneManager.addKeyControl("battle-cursor","down",()=>{t.active&&(this.currentRow>=Object.keys(DS.battleManager.formMap).length-1?this.currentRow=0:DS.battleManager.formMap[t.currentRow+1][t.currentCollumn]&&this.currentRow++,t.setCursorOn(t.currentRow,t.currentCollumn))}),DS.menuSceneManager.addKeyControl("battle-cursor","left",()=>{t.active&&(this.currentCollumn-1==-1&&(DS.battleManager.formMap[t.currentRow+1]?(this.currentRow++,this.currentCollumn=DS.battleManager.formMap[t.currentRow].length):this.currentRow>=Object.keys(DS.battleManager.formMap).length-1&&(this.currentRow=0,this.currentCollumn=DS.battleManager.formMap[t.currentRow].length)),1==this.currentCollumn&&(this.currentCollumn=0),DS.battleManager.formMap[t.currentRow][t.currentCollumn-1]&&this.currentCollumn--,t.setCursorOn(t.currentRow,t.currentCollumn))}),DS.menuSceneManager.addKeyControl("battle-cursor","right",()=>{t.active&&(this.currentCollumn==DS.battleManager.formMap[t.currentRow].length-1?DS.battleManager.formMap[t.currentRow+1]?(this.currentRow++,this.currentCollumn=0):this.currentRow>=Object.keys(DS.battleManager.formMap).length-1&&(this.currentRow=0,this.currentCollumn=0):DS.battleManager.formMap[t.currentRow][t.currentCollumn+1]&&this.currentCollumn++,t.setCursorOn(t.currentRow,t.currentCollumn))}),DS.menuSceneManager.addCharControl("battle-cursor","z",()=>{t.active&&DS.renderer.showAt(String(this.selectedEntityID),5,80)}),DS.menuSceneManager.addCharControl("battle-cursor","x",()=>{if(!t.active)return})}$draw(){if(this.active&&this.draw)for(let t=this.y-1;t<this.y-1+this.height;t++){if(t==this.y-1){DS.renderer.showAt(this.barTopLeft,t,this.x),DS.renderer.showAt(this.barTopRight,t,this.x+this.width);continue}if(t==this.y-1+this.height-1){DS.renderer.showAt(this.barBottomLeft,t,this.x),DS.renderer.showAt(this.barBottomRight,t,this.x+this.width);continue}DS.renderer.showAt(this.barMiddle,t,this.x),DS.renderer.showAt(this.barMiddle,t,this.x+this.width)}}$run(){}$destroy(){}constructor(t,e,n,i,s,r){this.data=t,this.id=e,this.type=n,this.x=i,this.y=s,this.sceneType=r,this.drawText="[",this.active=!1,this.draw=!0,this.width=0,this.height=0,this.barStyle=h.New({dim:!0,fg:a.Cyan}),this.barTopLeft="┌",this.barTopRight="┐",this.barBottomRight="┘",this.barBottomLeft="└",this.barMiddle="│",this.selectedEntityID=0,this.currentRow=0,this.currentCollumn=0,this.setCursorOn(0,0)||q.exit(0),this._setUpControls(),this._stylize()}}async function J(){DS.entityManager.registerEntity("FearCrystalWanderEntity",X),DS.entityManager.registerEntity("FearCrystalSpawner",P),DS.entityManager.registerEntity("EnergyFlyEntity",K),DS.entityManager.registerEntity("ParticleSpawnerEntity",G),DS.entityManager.registerEntity("RandomText",z),DS.entityManager.registerEntity("MelEyesEntity",U),DS.entityManager.registerEntity("MelStatsEntity",Y),DS.entityManager.registerEntity("WorldDataDisplayEntity",V),DS.entityManager.registerEntity("FearFormEntity",Z),DS.entityManager.registerEntity("BattleCursorEntity",Q)}async function tt(){DS.levelManager.registerSceneMeta("overworld").addSceneToMeta("overworld",{id:"1",leftScrene:"5",bottomScrene:"cyrstal-alter",topScrene:!1,rightScrene:"4",animations:{1:[{animText:["XXXXXXXXXXXX"],style:{fg:a.Blue,dim:!0},interval:2,row:14,col:19},{animText:["XXXXXXXXXXXX"],style:{fg:a.Blue,bright:!0},interval:2,row:14,col:19}],2:[{animText:["<──────────>"],style:{fg:a.Purple,dim:!0},interval:3,row:4,col:3},{animText:["<────||────>"],style:{fg:a.Purple,dim:!0},interval:3,row:4,col:3},{animText:["<────||────>"],style:{fg:a.Purple,bright:!0},interval:3,row:4,col:3},{animText:["<───||||───>"],style:{fg:a.Purple,bright:!0},interval:3,row:4,col:3},{animText:["<──||||||──>"],style:{fg:a.Purple,bright:!0},interval:3,row:4,col:3},{animText:["<─||||||||─>"],style:{fg:a.Purple,bright:!0},interval:3,row:4,col:3},{animText:["<||||||||||>"],style:{fg:a.Purple,bright:!0},interval:3,row:4,col:3},{animText:["<||||──||||>"],style:{fg:a.Purple,bright:!0},interval:3,row:4,col:3},{animText:["<|||────|||>"],style:{fg:a.Purple,bright:!0},interval:3,row:4,col:3},{animText:["<||──────||>"],style:{fg:a.Purple,bright:!0},interval:3,row:4,col:3},{animText:["<|────────|>"],style:{fg:a.Purple,bright:!0},interval:3,row:4,col:3},{animText:["<──────────>"],style:{fg:a.Purple,bright:!0},interval:3,row:4,col:3}],3:[{animText:["<──────────>"],style:{fg:a.Purple,dim:!0},interval:3,row:4,col:35},{animText:["<────||────>"],style:{fg:a.Purple,dim:!0},interval:3,row:4,col:35},{animText:["<────||────>"],style:{fg:a.Purple,bright:!0},interval:3,row:4,col:35},{animText:["<───||||───>"],style:{fg:a.Purple,bright:!0},interval:3,row:4,col:35},{animText:["<──||||||──>"],style:{fg:a.Purple,bright:!0},interval:3,row:4,col:35},{animText:["<─||||||||─>"],style:{fg:a.Purple,bright:!0},interval:3,row:4,col:35},{animText:["<||||||||||>"],style:{fg:a.Purple,bright:!0},interval:3,row:4,col:35},{animText:["<||||──||||>"],style:{fg:a.Purple,bright:!0},interval:3,row:4,col:35},{animText:["<|||────|||>"],style:{fg:a.Purple,bright:!0},interval:3,row:4,col:35},{animText:["<||──────||>"],style:{fg:a.Purple,bright:!0},interval:3,row:4,col:35},{animText:["<|────────|>"],style:{fg:a.Purple,bright:!0},interval:3,row:4,col:35},{animText:["<──────────>"],style:{fg:a.Purple,bright:!0},interval:3,row:4,col:35}]},screenStateAnimationKeys:{1:[{stateName:"1",inteerval:30},{stateName:"2",inteerval:5},{stateName:"3",inteerval:5},{stateName:"2",inteerval:3},{stateName:"3",inteerval:5},{stateName:"2",inteerval:3},{stateName:"3",inteerval:5},{stateName:"2",inteerval:3}]},screenStates:{},rawText:{1:{collisionMap:"1",styleMap:"1",map:"**************************************************\n|▓▓╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝▓▓|\n|▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓|\n|▓▓████████████▓▓║┌┴┴┴┴────┴┴┴┴┐║▓▓████████████▓▓|\n|▓██████████████▓║┤ ┌─┐    ┌─┐ ├║▓██████████████▓ \n|▓█╔┼┼┼┼┼┼┼┼┼┼╗█▓║└┬┴┘└    ┘└┴┬┘║▓█╔┼┼┼┼┼┼┼┼┼┼╗█▓|\n|▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓║ └┐  /  \\  ┌┘ ║▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓|\n|▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓║  ├┐  ┘└  ┌┤  ║▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓|\n|▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓║  │└┐    ┌┘│  ║▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓|\n|▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓║  │ └┬┬┬┬┘ │  ║▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓|\n|▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓║   └┴┴┴┴┴┴┘   ║▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓|\n|▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓║              ║▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓|\n|▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓║              ║▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓|\n|▓▓████████████▓▓║╗XXXXXXXXXXXX╔║▓▓████████████▓▓|\n|▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓|╝            ╚|▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓|\n|                                                |\n|                                                |\n|                                                |\n**************************************************"},2:{collisionMap:"1",styleMap:"1",map:"**************************************************\n|▓▓╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝▓▓|\n|▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓|\n|▓▓████████████▓▓║┌┴┴┴┴────┴┴┴┴┐║▓▓████████████▓▓|\n|▓██████████████▓║┤ ┌─┐    ┌─┐ ├║▓██████████████▓ \n|▓█╔┼┼┼┼┼┼┼┼┼┼╗█▓║└┬┴|└    ┘|┴┬┘║▓█╔┼┼┼┼┼┼┼┼┼┼╗█▓|\n|▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓║ └┐  /  \\  ┌┘ ║▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓|\n|▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓║  ├┐  ┘└  ┌┤  ║▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓|\n|▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓║  │└┐    ┌┘│  ║▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓|\n|▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓║  │ └┬┬┬┬┘ │  ║▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓|\n|▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓║  └┐      ┌┘  ║▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓|\n|▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓║   └┴┴┴┴┴┴┘   ║▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓|\n|▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓║              ║▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓|\n|▓▓████████████▓▓║╗XXXXXXXXXXXX╔║▓▓████████████▓▓|\n|▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓|╝            ╚|▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓|\n|                                                |\n|                                                |\n|                                                |\n**************************************************"},3:{collisionMap:"1",styleMap:"2",map:"**************************************************\n|▓▓╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝╚╝▓▓|\n|▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓|\n|▓▓████████████▓▓║┌┴┴┴┴────┴┴┴┴┐║▓▓████████████▓▓|\n|▓██████████████▓║┤ ┌─┐    ┌─┐ ├║▓██████████████▓ \n|▓█╔┼┼┼┼┼┼┼┼┼┼╗█▓║└┬┴0└    ┘0┴┬┘║▓█╔┼┼┼┼┼┼┼┼┼┼╗█▓|\n|▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓║ └┐  /  \\  ┌┘ ║▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓|\n|▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓║  ├┐  ┘└  ┌┤  ║▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓|\n|▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓║  │└┐    ┌┘│  ║▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓|\n|▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓║  │ └┬┬┬┬┘ │  ║▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓|\n|▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓║  └┐      ┌┘  ║▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓|\n|▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓║   │      │   ║▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓|\n|▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓║   └┴┴┴┴┴┴┘   ║▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓|\n|▓▓████████████▓▓║╗XXXXXXXXXXXX╔║▓▓████████████▓▓|\n|▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓|╝            ╚|▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓|\n|                                                |\n|                                                |\n|                                                |\n**************************************************"}},styleMap:{1:{dim:!0,fg:a.Red},2:{dim:!1,fg:a.Red}},collisionMaps:{},collisionMapsRaw:{1:"**************************************************\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                 ██████████████                 |\n|██████████████████            ██████████████████|\n|                                                |\n|                                                |\n|                                                |\n**************************************************"},activeAnimationScreenState:"1",activeEntityMap:"1",entityMap:{1:{entityName:"ParticleSpawnerEntity",type:"Rain",data:{fgColor:a.Red}}},entityMapRaw:{1:"**************************************************\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|           1                                    |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n**************************************************"}}).addSceneToMeta("overworld",{id:"cyrstal-alter",leftScrene:!1,bottomScrene:!1,topScrene:"1",rightScrene:"3",animations:{"bar-down":[{animText:[""],row:12,col:20,style:{fg:a.Cyan},interval:6},{animText:["──────────"],row:12,col:20,style:{fg:a.Cyan},interval:6},{animText:["──────────","──────────"],row:12,animDirection:"down",col:20,style:{fg:a.Cyan},interval:6},{animText:["──────────","──────────","──────────"],row:12,animDirection:"down",col:20,style:{fg:a.Cyan},interval:6},{animText:["──────────","──────────","──────────","──────────"],row:12,animDirection:"down",col:20,style:{fg:a.Cyan},interval:6},{animText:["","──────────","──────────","──────────"],row:12,animDirection:"down",col:20,style:{fg:a.Cyan},interval:6},{animText:["","","──────────","──────────"],row:12,animDirection:"down",col:20,style:{fg:a.Cyan},interval:6},{animText:["","","","──────────"],row:12,animDirection:"down",col:20,style:{fg:a.Cyan},interval:6}],"bar-up":[{animText:[""],row:8,col:20,style:{fg:a.Cyan},interval:6},{animText:["──────────"],row:8,col:20,style:{fg:a.Cyan},interval:6},{animText:["──────────","──────────"],row:8,animDirection:"up",col:20,style:{fg:a.Cyan},interval:6},{animText:["──────────","──────────","──────────"],row:8,animDirection:"up",col:20,style:{fg:a.Cyan},interval:6},{animText:["──────────","──────────","──────────","──────────"],row:8,animDirection:"up",col:20,style:{fg:a.Cyan},interval:6},{animText:["","──────────","──────────","──────────"],row:8,animDirection:"up",col:20,style:{fg:a.Cyan},interval:6},{animText:["","","──────────","──────────"],row:8,animDirection:"up",col:20,style:{fg:a.Cyan},interval:6},{animText:["","","","──────────"],row:8,animDirection:"up",col:20,style:{fg:a.Cyan},interval:6}],"bar-right":[{animText:["      "],row:10,col:32,style:{fg:a.Cyan},interval:3},{animText:["|     "],row:10,col:32,style:{fg:a.Cyan},interval:3},{animText:["||    "],row:10,col:32,style:{fg:a.Cyan},interval:3},{animText:["|||   "],row:10,col:32,style:{fg:a.Cyan},interval:3},{animText:["||||  "],row:10,col:32,style:{fg:a.Cyan},interval:3},{animText:["||||| "],row:10,col:32,style:{fg:a.Cyan},interval:3},{animText:["||||||"],row:10,col:32,style:{fg:a.Cyan},interval:3},{animText:[" |||||"],row:10,col:32,style:{fg:a.Cyan},interval:3},{animText:["  ||||"],row:10,col:32,style:{fg:a.Cyan},interval:3},{animText:["   |||"],row:10,col:32,style:{fg:a.Cyan},interval:3},{animText:["    ||"],row:10,col:32,style:{fg:a.Cyan},interval:3},{animText:["     |"],row:10,col:32,style:{fg:a.Cyan},interval:3}],"bar-left":[{animText:["      "],row:10,col:12,style:{fg:a.Cyan},interval:3},{animText:["     |"],row:10,col:12,style:{fg:a.Cyan},interval:3},{animText:["    ||"],row:10,col:12,style:{fg:a.Cyan},interval:3},{animText:["   |||"],row:10,col:12,style:{fg:a.Cyan},interval:3},{animText:["  ||||"],row:10,col:12,style:{fg:a.Cyan},interval:3},{animText:[" |||||"],row:10,col:12,style:{fg:a.Cyan},interval:3},{animText:["||||||"],row:10,col:12,style:{fg:a.Cyan},interval:3},{animText:["||||| "],row:10,col:12,style:{fg:a.Cyan},interval:3},{animText:["||||  "],row:10,col:12,style:{fg:a.Cyan},interval:3},{animText:["|||   "],row:10,col:12,style:{fg:a.Cyan},interval:3},{animText:["||    "],row:10,col:12,style:{fg:a.Cyan},interval:3},{animText:["|     "],row:10,col:12,style:{fg:a.Cyan},interval:3}],red:[{animText:["*"],row:5,col:17,style:{fg:DS.player.playerData.crystals.red?a.Red:a.Black,dim:!1,bright:!0},interval:6},{animText:["*"],row:5,col:17,style:{fg:DS.player.playerData.crystals.red?a.Red:a.Black,dim:!1,bright:!1},interval:6},{animText:["*"],row:5,col:17,style:{fg:DS.player.playerData.crystals.red?a.Red:a.Black,dim:!1,bright:!0},interval:6}],green:[{animText:["*"],row:10,col:8,style:{fg:DS.player.playerData.crystals.red?a.Green:a.Black,dim:!1,bright:!0},interval:6},{animText:["*"],row:10,col:8,style:{fg:DS.player.playerData.crystals.red?a.Green:a.Black,dim:!1,bright:!1},interval:6},{animText:["*"],row:10,col:8,style:{fg:DS.player.playerData.crystals.red?a.Green:a.Black,dim:!1,bright:!0},interval:6}],blue:[{animText:["*"],row:15,col:17,style:{fg:DS.player.playerData.crystals.red?a.Blue:a.Black,dim:!1,bright:!0},interval:6},{animText:["*"],row:15,col:17,style:{fg:DS.player.playerData.crystals.red?a.Blue:a.Black,dim:!1,bright:!1},interval:6},{animText:["*"],row:15,col:17,style:{fg:DS.player.playerData.crystals.red?a.Blue:a.Black,dim:!1,bright:!0},interval:6}],cyan:[{animText:["*"],row:5,col:32,style:{fg:DS.player.playerData.crystals.red?a.Cyan:a.Black,dim:!1,bright:!0},interval:6},{animText:["*"],row:5,col:32,style:{fg:DS.player.playerData.crystals.red?a.Cyan:a.Black,dim:!1,bright:!1},interval:6},{animText:["*"],row:5,col:32,style:{fg:DS.player.playerData.crystals.red?a.Cyan:a.Black,dim:!1,bright:!0},interval:6}],magenta:[{animText:["*"],row:10,col:41,style:{fg:DS.player.playerData.crystals.red?a.Purple:a.Black,dim:!1,bright:!0},interval:6},{animText:["*"],row:10,col:41,style:{fg:DS.player.playerData.crystals.red?a.Purple:a.Black,dim:!1,bright:!1},interval:6},{animText:["*"],row:10,col:41,style:{fg:DS.player.playerData.crystals.red?a.Purple:a.Black,dim:!1,bright:!0},interval:6}],yellow:[{animText:["*"],row:15,col:32,style:{fg:DS.player.playerData.crystals.red?a.Yellow:a.Black,dim:!1,bright:!0},interval:6},{animText:["*"],row:15,col:32,style:{fg:DS.player.playerData.crystals.red?a.Yellow:a.Black,dim:!1,bright:!1},interval:6},{animText:["*"],row:15,col:32,style:{fg:DS.player.playerData.crystals.red?a.Yellow:a.Black,dim:!1,bright:!0},interval:6}]},screenStateAnimationKeys:{1:[{stateName:"1",inteerval:6},{stateName:"2",inteerval:6},{stateName:"3",inteerval:6}]},screenStates:{},rawText:{1:{collisionMap:"1",styleMap:"1",map:"**************************************************\n|                                                |\n|                                                |\n|                                                |\n|               / ├┐          ┌┤ \\               |\n|             /   │║          ║│   \\             |\n|           /     │║          ║│     \\           |\n|         /   ┌───┤║          ║├───┐   \\         |\n|       /  ┌──┘   │/▔▔▔▔░░▔▔▔▔\\│   └──┐  \\       |\n|      │   ║     /│├───░██░───┤│\\     ║   │      |\n|       \\  └──┐   │\\▁▁▁▁░░▁▁▁▁/│   ┌──┘  /       |\n|         \\   └───┤║          ║├───┘   /         |\n|           \\     │║          ║│     /           |\n|             \\   │║          ║│   /             |\n|               \\ ├┘          └┤ /               |\n|                                                |\n|                                                |\n|                                                |\n**************************************************"},2:{collisionMap:"1",styleMap:"2",map:"**************************************************\n|                                                |\n|                                                |\n|                                                |\n|               / ├┐          ┌┤ \\               |\n|             /   │║          ║│   \\             |\n|           /     │║          ║│     \\           |\n|         /   ┌───┤║          ║├───┐   \\         |\n|       /  ┌──┘   │/▔▔▔▔██▔▔▔▔\\│   └──┐  \\       |\n|      │   ║     ││├───█░░█───┤││     ║   │      |\n|       \\  └──┐   │\\▁▁▁▁██▁▁▁▁/│   ┌──┘  /       |\n|         \\   └───┤║          ║├───┘   /         |\n|           \\     │║          ║│     /           |\n|             \\   │║          ║│   /             |\n|               \\ ├┘          └┤ /               |\n|                                                |\n|                                                |\n|                                                |\n**************************************************"},3:{collisionMap:"1",styleMap:"1",map:"**************************************************\n|                                                |\n|                                                |\n|                                                |\n|               / ├┐          ┌┤ \\               |\n|             /   │║          ║│   \\             |\n|           /     │║          ║│     \\           |\n|         /   ┌───┤║          ║├───┐   \\         |\n|       /  ┌──┘   │/▔▔▔▔░░▔▔▔▔\\│   └──┐  \\       |\n|      │   ║     \\│├───░░░░───┤│/     ║   │      |\n|       \\  └──┐   │\\▁▁▁▁░░▁▁▁▁/│   ┌──┘  /       |\n|         \\   └───┤║          ║├───┘   /         |\n|           \\     │║          ║│     /           |\n|             \\   │║          ║│   /             |\n|               \\ ├┘          └┤ /               |\n|                                                |\n|                                                |\n|                                                |\n**************************************************"}},styleMap:{1:{dim:!0,fg:a.Purple},2:{dim:!1,fg:a.Purple}},collisionMaps:{},collisionMapsRaw:{1:"**************************************************\n|                                                |\n|                                                |\n|                                                |\n|               █ ██████████████ █               |\n|             █   │║          ║│   █             |\n|           █     │║          ║│     █           |\n|         █   ┌───┤║          ║├───┐   █         |\n|       █  ┌──┘   │/▔▔▔▔░░▔▔▔▔\\│   └──┐  █       |\n|      █   ║     \\│├───░░░░───┤│/     ║   █      |\n|       █  └──┐   │\\▁▁▁▁░░▁▁▁▁/│   ┌──┘  █       |\n|         █   └───┤║          ║├───┘   █         |\n|           █     │║          ║│     █           |\n|             █   │║          ║│   █             |\n|               █ ██████████████ █               |\n|                                                |\n|                                                |\n|                                                |\n**************************************************"},activeAnimationScreenState:"1",activeEntityMap:"",entityMap:{},entityMapRaw:{}}).addSceneToMeta("overworld",{id:"4",animations:{},leftScrene:"1",bottomScrene:"3",topScrene:!1,rightScrene:"7",screenStateAnimationKeys:{1:[{inteerval:100,stateName:"1"},{inteerval:2,stateName:"2"},{inteerval:5,stateName:"1"},{inteerval:2,stateName:"2"},{inteerval:5,stateName:"1"},{inteerval:2,stateName:"2"}]},screenStates:{},rawText:{1:{collisionMap:"1",styleMap:"1",map:"**************************************************\n|▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓████████████▓▓              |\n|▓▓▓████████████▓▓▓▓██████████████▓              |\n|▓▓██████████████▓▓▓█╔┼┼┼┼┼┼┼┼┼┼╗█▓              |\n|▓▓█╔┼┼┼┼┼┼┼┼┼┼╗█▓▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓              |\n|▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓              |\n|▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓┬┬┬┬┬┬┬┬┬┬┬┬┬┬|\n|▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓││││││││││││││|\n|▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓││▓▓││▓▓││▓▓││|\n|▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓││▓▓││▓▓││▓▓││|\n|▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓││▓▓││▓▓││▓▓││|\n|▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓││▓▓││▓▓││▓▓││|\n|▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓││▓▓││▓▓││▓▓││|\n|▓▓▓████████████▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓              |\n|▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓                               |\n|                                                |\n|                                                |\n|                                                |\n**************************************************"},2:{collisionMap:"1",styleMap:"2",map:"**************************************************\n|▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓████████████▓▓              |\n|▓▓▓████████████▓▓▓▓██████████████▓              |\n|▓▓██████████████▓▓▓█╔┼┼┼┼┼┼┼┼┼┼╗█▓              |\n|▓▓█╔┼┼┼┼┼┼┼┼┼┼╗█▓▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓              |\n|▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓              |\n|▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓┬┬┬┬┬┬┬┬┬┬┬┬┬┬|\n|▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓││││││││││││││|\n|▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓││▓▓││▓▓││▓▓││|\n|▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓││▓▓││▓▓││▓▓││|\n|▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓││▓▓││▓▓││▓▓││|\n|▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓││▓▓││▓▓││▓▓││|\n|▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓││▓▓││▓▓││▓▓││|\n|▓▓▓████████████▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓              |\n|▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓                               |\n|                                                |\n|                                                |\n|                                                |\n**************************************************"}},styleMap:{1:{bg:a.Black,fg:a.White},2:{bg:a.White,fg:a.White,bright:!0}},collisionMaps:{},collisionMapsRaw:{1:"**************************************************\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                  ██████████████|\n|                 █████████████████              |\n|█████████████████                               |\n|                                                |\n|                                                |\n|                                                |\n**************************************************"},activeAnimationScreenState:"1",activeEntityMap:"1",entityMap:{1:{entityName:"EnergyFlyEntity",type:"Normal"},2:{entityName:"ParticleSpawnerEntity",type:"Rain"}},entityMapRaw:{1:"**************************************************\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                  1                    1        |\n|     2                        1                 |\n**************************************************"}}).addSceneToMeta("overworld",{id:"5",animations:{},leftScrene:"6",bottomScrene:"3",topScrene:!1,rightScrene:"1",screenStateAnimationKeys:{},screenStates:{},rawText:{1:{collisionMap:"1",styleMap:"1",map:"**************************************************\n|              ▓▓▓████████████▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓|\n|              ▓▓██████████████▓▓▓▓████████████▓▓|\n|              ▓▓█╔┼┼┼┼┼┼┼┼┼┼╗█▓▓▓██████████████▓|\n|              ▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓▓▓█╔┼┼┼┼┼┼┼┼┼┼╗█▓|\n|              ▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓|\n|┬┬┬┬┬┬┬┬┬┬┬┬┬┬▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓|\n|││││││││││││││▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓|\n|││▓▓││▓▓││▓▓││▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓|\n|││▓▓││▓▓││▓▓││▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓|\n|││▓▓││▓▓││▓▓││▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓|\n|││▓▓││▓▓││▓▓││▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓|\n|││▓▓││▓▓││▓▓││▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓▓▓█┼┼┼┼┼┼┼┼┼┼┼┼█▓|\n|              ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓████████████▓▓|\n|                                ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓|\n|                                                |\n|                                                |\n|                                                |\n**************************************************"}},styleMap:{1:{fg:a.White,bright:!0}},collisionMaps:{},collisionMapsRaw:{1:"**************************************************\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|███████████████                                |\n|               ████████████████                 |\n|                               █████████████████|\n|                                                |\n|                                                |\n|                                                |\n**************************************************"},activeAnimationScreenState:"",activeEntityMap:"1",entityMap:{1:{entityName:"ParticleSpawnerEntity",type:"Rain"}},entityMapRaw:{1:"**************************************************\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|           1                                    |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n**************************************************"}}).addSceneToMeta("overworld",{id:"6",leftScrene:"8",bottomScrene:!1,topScrene:!1,rightScrene:"5",animations:{},screenStateAnimationKeys:{},screenStates:{},rawText:{1:{collisionMap:"1",styleMap:"1",map:"▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬▒\n▒││││││││││││││││││││││││││││││││││││││││││││││││▒\n▒││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓▒\n▒││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓▒\n▒││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓▒\n▒││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓▒\n▒││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒"}},styleMap:{1:{fg:a.White,bright:!0}},collisionMaps:{},collisionMapsRaw:{1:"**************************************************\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|████████████████████████████████████████████████|\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n**************************************************"},activeAnimationScreenState:"",activeEntityMap:"1",entityMap:{1:{entityName:"ParticleSpawnerEntity",type:"Rain"}},entityMapRaw:{1:"**************************************************\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|           1                                    |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n**************************************************"}}).addSceneToMeta("overworld",{id:"7",leftScrene:"4",bottomScrene:!1,topScrene:!1,rightScrene:!1,animations:{},screenStateAnimationKeys:{},screenStates:{},rawText:{1:{collisionMap:"1",styleMap:"1",map:"▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬▒\n▒││││││││││││││││││││││││││││││││││││││││││││││││▒\n▒▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▒\n▒▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▒\n▒▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▒\n▒▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▒\n▒▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▓▓││▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒"}},styleMap:{1:{fg:a.White,bright:!0}},collisionMaps:{},collisionMapsRaw:{1:"**************************************************\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|████████████████████████████████████████████████|\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n**************************************************"},activeAnimationScreenState:"",activeEntityMap:"1",entityMap:{1:{entityName:"ParticleSpawnerEntity",type:"Rain"}},entityMapRaw:{1:"**************************************************\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|           1                                    |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n**************************************************"}}).addSceneToMeta("overworld",{id:"8",leftScrene:!1,bottomScrene:!1,topScrene:"4",rightScrene:"6",animations:{},screenStateAnimationKeys:{},screenStates:{},rawText:{1:{collisionMap:"1",styleMap:"1",map:"▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒"}},styleMap:{1:{fg:a.White,bright:!0}},collisionMaps:{},collisionMapsRaw:{1:"**************************************************\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n**************************************************"},activeAnimationScreenState:"",activeEntityMap:"1",entityMap:{1:{entityName:"FearCrystalSpawner",type:"Rain",data:{"over-world-1":[{probability:1,fearFormMap:[{id:"creature-1",probability:1,min:20,max:20}]}]}}},entityMapRaw:{1:"**************************************************\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|           1                                    |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n**************************************************"}}).addSceneToMeta("overworld",{id:"3",leftScrene:"cyrstal-alter",bottomScrene:!1,topScrene:"4",rightScrene:!1,animations:{},screenStateAnimationKeys:{},screenStates:{},rawText:{1:{collisionMap:"1",styleMap:"1",map:"▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒                                                ▒\n▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒"}},styleMap:{1:{fg:a.White,bright:!0}},collisionMaps:{},collisionMapsRaw:{1:"**************************************************\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n**************************************************"},activeAnimationScreenState:"",activeEntityMap:"1",entityMap:{1:{entityName:"EnergyFlyEntity",type:"Normal"},2:{entityName:"EnergyFlyEntity",type:"Normal",data:{fgColor:a.Green}},3:{entityName:"EnergyFlyEntity",type:"Normal",data:{fgColor:a.Purple}},4:{entityName:"EnergyFlyEntity",type:"Normal",data:{fgColor:a.Yellow}},5:{entityName:"EnergyFlyEntity",type:"Normal",data:{fgColor:a.Red}},6:{entityName:"EnergyFlyEntity",type:"Normal",data:{fgColor:a.Blue}}},entityMapRaw:{1:"**************************************************\n|                                           6    |\n|          2                                     |\n|                            2         5         |\n|             1                                  |\n|   6                                6           |\n|                      6                         |\n|         1                      1               |\n|                         3                      |\n|                                                |\n|      5            3               4     5      |\n|                                                |\n|             1             1                    |\n|                                      1         |\n|       3                      6                 |\n|            6          4                        |\n|                                    2           |\n|               1                                |\n**************************************************"}})}async function te(){DS.battleSceneManager.registerSceneMeta("over-world-1").addSceneToMeta("over-world-1",{id:"1",animations:{},screenStateAnimationKeys:{},screenStates:{},rawText:{1:{styleMap:"1",map:"**************************************************\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n**************************************************"}},styleMap:{1:{fg:"Red"}},activeAnimationScreenState:"",activeEntityMap:"",entityMap:{},entityMapRaw:{}})}async function tn(){DS.battleSceneManager.registerSceneMeta("transitions").addSceneToMeta("transitions",{id:"transition-frame",animations:{},screenStateAnimationKeys:{1:[{stateName:"1",inteerval:8},{stateName:"2",inteerval:5},{stateName:"1",inteerval:3},{stateName:"2",inteerval:2}]},screenStates:{},rawText:{1:{styleMap:"1",map:"**************************************************\n|[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]|\n|[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]|\n|[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]|\n|[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]|\n|[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]|\n|[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]|\n|[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]|\n|[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]|\n|[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]|\n|[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]|\n|[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]|\n|[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]|\n|[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]|\n|[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]|\n|[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]|\n|[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]|\n|[0][0][0][0][0][0][0][0][0][0][0][0][0][0][0][0]|\n**************************************************"},2:{styleMap:"1",map:"**************************************************\n|[|][|][|][|][|][|][|][|][|][|][|][|][|][|][|][|]|\n|[|][|][|][|][|][|][|][|][|][|][|][|][|][|][|][|]|\n|[|][|][|][|][|][|][|][|][|][|][|][|][|][|][|][|]|\n|[|][|][|][|][|][|][|][|][|][|][|][|][|][|][|][|]|\n|[|][|][|][|][|][|][|][|][|][|][|][|][|][|][|][|]|\n|[|][|][|][|][|][|][|][|][|][|][|][|][|][|][|][|]|\n|[|][|][|][|][|][|][|][|][|][|][|][|][|][|][|][|]|\n|[|][|][|][|][|][|][|][|][|][|][|][|][|][|][|][|]|\n|[|][|][|][|][|][|][|][|][|][|][|][|][|][|][|][|]|\n|[|][|][|][|][|][|][|][|][|][|][|][|][|][|][|][|]|\n|[|][|][|][|][|][|][|][|][|][|][|][|][|][|][|][|]|\n|[|][|][|][|][|][|][|][|][|][|][|][|][|][|][|][|]|\n|[|][|][|][|][|][|][|][|][|][|][|][|][|][|][|][|]|\n|[|][|][|][|][|][|][|][|][|][|][|][|][|][|][|][|]|\n|[|][|][|][|][|][|][|][|][|][|][|][|][|][|][|][|]|\n|[|][|][|][|][|][|][|][|][|][|][|][|][|][|][|][|]|\n|[|][|][|][|][|][|][|][|][|][|][|][|][|][|][|][|]|\n**************************************************"}},styleMap:{1:{fg:a.Red,bright:!0}},activeAnimationScreenState:"1",activeEntityMap:"",entityMap:{},entityMapRaw:{}}).addSceneToMeta("transitions",{id:"title-card",animations:{},screenStateAnimationKeys:{},screenStates:{},rawText:{1:{styleMap:"1",map:"**************************************************\n|╔══════════════════════════════════════════════╗|\n|║                                              ║|\n|║                                              ║|\n|║                                              ║|\n|║                                              ║|\n|║                                              ║|\n|║                                              ║|\n|║                                              ║|\n|║                                              ║|\n|║                                              ║|\n|║                                              ║|\n|║                                              ║|\n|║                                              ║|\n|║                                              ║|\n|║                                              ║|\n|║                                              ║|\n|╚══════════════════════════════════════════════╝|\n**************************************************"}},styleMap:{1:h.New({fg:a.Purple,bright:!0})},activeAnimationScreenState:"",activeEntityMap:"1",entityMap:{1:{entityName:"RandomText",type:"BattleScene"}},entityMapRaw:{1:"**************************************************\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|  1                                             |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n|                                                |\n**************************************************"}}),te()}async function ti(){DS.menuSceneManager.registerSceneMeta("right-battle-menu").addSceneToMeta("right-battle-menu",{id:"bump",animations:{},screenStateAnimationKeys:{},screenStates:{},rawText:{1:{styleMap:"1",map:"******************************\n|             ┌┐             |\n|            ┌┘└┐            |\n|           ┌┘  └┐           |\n|          ┌┘    └┐          |\n|         ┌┘  ┌┐  └┐         |\n|        ┌┘  ┌┘└┐  └┐        |\n|       ┌┘  ┌┘00└┐  └┐       |\n|      ┌┘  ┌┘ 00 └┐  └┐      |\n|      │   │  00  │   │      |\n|      └┐  └┐ 00 ┌┘  ┌┘      |\n|       └┐  └┐00┌┘  ┌┘       |\n|        └┐  └┐┌┘  ┌┘        |\n|         └┐  └┘  ┌┘         |\n|          └┐    ┌┘          |\n|           └┐  ┌┘           |\n|            └┐┌┘            |\n|             └┘             |\n******************************"}},styleMap:{1:{fg:"Magenta",dim:!0}},activeAnimationScreenState:"",activeEntityMap:"1",entityMap:{1:{entityName:"MelEyesEntity",type:"",data:{}}},entityMapRaw:{1:"******************************\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|            1               |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n******************************"}}).addSceneToMeta("right-battle-menu",{id:"1",animations:{},screenStateAnimationKeys:{},screenStates:{},rawText:{1:{styleMap:"1",map:"******************************\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n******************************"}},styleMap:{1:{fg:"Cyan",dim:!0}},activeAnimationScreenState:"",activeEntityMap:"1",entityMap:{1:{entityName:"RightBattleMenu",type:"",data:{}}},entityMapRaw:{1:"******************************\n|1                           |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n|                            |\n******************************"}}),DS.menuSceneManager.registerSceneMeta("bottom-menu").addSceneToMeta("bottom-menu",{id:"1",animations:{},screenStateAnimationKeys:{},screenStates:{},rawText:{1:{styleMap:"1",map:"│                                                │\n│   /─\\                                          │\n│  ┌┘0└┐                                         │\n│ / /0\\ \\                                        │\n││  │0│  │                                       │\n│ \\ \\0/ /                                        │\n│  └┐0┌┘                                         │\n│   \\─/                                          │\n└────────────────────────────────────────────────┘"}},styleMap:{1:{fg:"Magenta",dim:!0}},activeAnimationScreenState:"",activeEntityMap:"1",entityMap:{1:{entityName:"MelEyesEntity",type:"bottom-bar",data:{}},2:{entityName:"MelStatsEntity",type:"bottom-bar",data:{}},3:{entityName:"WorldDataDisplayEntity",type:"bottom-bar",data:{}}},entityMapRaw:{1:"│                                              │\n  │       2                  3                     │\n  │  1                                             │\n  │                                                │\n  │                                                │\n  │                                                │\n  │                                                │\n  │                                                │\n  └────────────────────────────────────────────────┘"}}).addSceneToMeta("bottom-menu",{id:"2",animations:{},screenStateAnimationKeys:{1:[{stateName:"1",inteerval:85},{stateName:"2",inteerval:3},{stateName:"3",inteerval:3},{stateName:"4",inteerval:3},{stateName:"5",inteerval:3},{stateName:"5",inteerval:300}]},screenStates:{},rawText:{1:{styleMap:"1",map:"│                                                │\n│ /█▔▔▔█▔▔▔█▔▔▔█▔▔▔▔█▔▔▔██▔▔▔█▔▔▔▔█▔▔▔█▔▔▔█▔▔▔█\\ │\n││ █   █   █   █   /▔▔▔▔▔▔▔▔▔▔\\   █   █   █   █ ││\n││/▔\\ /▔\\ /▔\\ /▔\\ / /▔▔▔▔▔▔▔▔\\ \\ /▔\\ /▔\\ /▔\\ /▔\\││\n││000│000│000│000│<000000000000>│000│000│000│000││\n││\\▁/ \\▁/ \\▁/ \\▁/ \\ \\▁▁▁▁▁▁▁▁/ / \\▁/ \\▁/ \\▁/ \\▁/││\n││ █   █   █   █   \\▁▁▁▁▁▁▁▁▁▁/   █   █   █   █ ││\n│ \\█▁▁▁█▁▁▁█▁▁▁█▁▁▁▁█▁▁▁██▁▁▁█▁▁▁▁█▁▁▁█▁▁▁█▁▁▁█/ │\n└────────────────────────────────────────────────┘"},2:{styleMap:"1",map:"│                                                │\n│ /█▔▔▔█▔▔▔█▔▔▔█▔▔▔▔█▔▔▔██▔▔▔█▔▔▔▔█▔▔▔█▔▔▔█▔▔▔█\\ │\n││ █   █   █   █   /▔▔▔▔▔▔▔▔▔▔\\   █   █   █   █ ││\n││/▔\\ /▔\\ /▔\\ /▔\\ / /▔▔▔▔▔▔▔▔\\ \\ /▔\\ /▔\\ /▔\\ /▔\\││\n│                                                │\n││\\▁/ \\▁/ \\▁/ \\▁/ \\ \\▁▁▁▁▁▁▁▁/ / \\▁/ \\▁/ \\▁/ \\▁/││\n││ █   █   █   █   \\▁▁▁▁▁▁▁▁▁▁/   █   █   █   █ ││\n│ \\█▁▁▁█▁▁▁█▁▁▁█▁▁▁▁█▁▁▁██▁▁▁█▁▁▁▁█▁▁▁█▁▁▁█▁▁▁█/ │\n└────────────────────────────────────────────────┘"},3:{styleMap:"1",map:"│                                                │\n││ █   █   █   █   /▔▔▔▔▔▔▔▔▔▔\\   █   █   █   █ ││\n││/▔\\ /▔\\ /▔\\ /▔\\ / /▔▔▔▔▔▔▔▔\\ \\ /▔\\ /▔\\ /▔\\ /▔\\││\n│                                                │\n│                                                │\n│                                                │\n││\\▁/ \\▁/ \\▁/ \\▁/ \\ \\▁▁▁▁▁▁▁▁/ / \\▁/ \\▁/ \\▁/ \\▁/││\n││ █   █   █   █   \\▁▁▁▁▁▁▁▁▁▁/   █   █   █   █ ││\n└────────────────────────────────────────────────┘"},4:{styleMap:"1",map:"│                                                │\n││/▔\\ /▔\\ /▔\\ /▔\\ / /▔▔▔▔▔▔▔▔\\ \\ /▔\\ /▔\\ /▔\\ /▔\\││\n│                                                │\n│                                                │\n│                                                │\n│                                                │\n│                                                │\n││\\▁/ \\▁/ \\▁/ \\▁/ \\ \\▁▁▁▁▁▁▁▁/ / \\▁/ \\▁/ \\▁/ \\▁/││\n└────────────────────────────────────────────────┘"},5:{styleMap:"1",map:"│                                              │\n│                                                │\n│                                                │\n│                                                │\n│                                                │\n│                                                │\n│                                                │\n│                                                │\n└────────────────────────────────────────────────┘"}},styleMap:{1:{fg:"Magenta",dim:!0}},activeAnimationScreenState:"1",activeEntityMap:"1",entityMap:{1:{entityName:"MelEyesEntity",type:"",data:{}}},entityMapRaw:{1:"│                                              │\n│                                                │\n│                                                │\n│                                                │\n│                                                │\n│                                                │\n│                                                │\n│                                                │\n└────────────────────────────────────────────────┘"}}),DS.menuSceneManager.registerSceneMeta("bottom-right-menu").addSceneToMeta("bottom-right-menu",{id:"1",animations:{},screenStateAnimationKeys:{},screenStates:{},rawText:{1:{styleMap:"1",map:"│                            │                         \n│                            │                                                  \n│                            │ \n│                            │                                              \n│                            │                                                   \n│                            │                                              \n│                            │                                                 \n│                            │                                                \n└────────────────────────────┘"}},styleMap:{1:{}},activeAnimationScreenState:"",activeEntityMap:"1",entityMap:{1:{entityName:"MelEyesEntity",type:"bottom-right-bar",data:{}}},entityMapRaw:{1:"│                            │                         \n│                            │                                                   \n│                            │   \n│                            │                                                 \n│                            │                                                   \n│                            │                                                 \n│                            │                                                   \n│                            │                                                 \n└────────────────────────────┘"}}).addSceneToMeta("bottom-right-menu",{id:"2",animations:{},screenStateAnimationKeys:{},screenStates:{},rawText:{1:{styleMap:"1",map:"│                            │ \n│   /─\\                      │\n│  ┌┘0└┐                     │\n│ / /0\\ \\                    │\n││  │0│  │                   │\n│ \\ \\0/ /                    │\n│  └┐0┌┘                     │\n│   \\─/                      │\n└────────────────────────────┘ "}},styleMap:{1:{fg:a.Purple,dim:!0}},activeAnimationScreenState:"",activeEntityMap:"1",entityMap:{1:{entityName:"MelEyesEntity",type:"bottom-right-bar",data:{}},2:{entityName:"MelStatsEntity",type:"bottom-bar",data:{}}},entityMapRaw:{1:"│                            │                         \n│          2                 │                                                   \n│   1                        │   \n│                            │                                                 \n│                            │                                                   \n│                            │                                                 \n│                            │                                                   \n│                            │                                                 \n└────────────────────────────┘"}})}async function ta(){DS.fearFormManager.registerNewFearFormCategory("over-world-1").registerNewFearForm("over-world-1","creature-1",{id:"creature-1",name:"Creature",alive:!0,boundingBox:{width:4,height:1},loot:[],level:1,totalHealth:20,totalMana:20,deffense:0,agaility:0,speed:0,intellegence:0,wisdom:0,spellCaster:!1,spells:[],weakness:[],activeAnimation:"1",animations:{1:[{animText:"[0]",interval:10,style:{}}]}})}async function ts(){ta()}class tr{_buildOptionMap(){for(let t of Object.keys(this.menus)){this.optionMap[t]={};let e=0;for(let n of Object.keys(this.menus[t]))this.optionMap[t][e]=this.menus[t][n].id,e++}}_setUpControls(){DS.menuSceneManager.addKeyControl("right-menu","up",async()=>{this.canMove&&(DS.audioManager.playSFX("blip-1"),0!=this.activeOptionNum?this.activeOptionNum--:this.activeOptionNum=Object.keys(this.optionMap[this.activeScreen]).length-1)}),DS.menuSceneManager.addKeyControl("right-menu","down",async()=>{this.canMove&&(DS.audioManager.playSFX("blip-1"),this.activeOptionNum!=Object.keys(this.optionMap[this.activeScreen]).length-1?this.activeOptionNum++:this.activeOptionNum=0)}),DS.menuSceneManager.addCharControl("right-menu","z",()=>{this.canMove&&(DS.audioManager.playSFX("select"),this._doOption())}),DS.menuSceneManager.addCharControl("right-menu","x",()=>{this.canMove&&DS.audioManager.playSFX("cancel")})}_doOption(){let t=this.optionMap[this.activeScreen][this.activeOptionNum];"attack"==t&&this._doAttack(),"spells"==t&&this._doCastSpell(),"items"==t&&this._doUseItem()}_doAttack(){this.canMove=!1,this.selectedOptionNum=0,DS.battleManager.battleCursor&&(DS.battleManager.battleCursor.active=!0)}_doCastSpell(){}_doUseItem(){}_getMenuBoxItem(t,e,n){let i=[];i.push(this.messageCap);let a="│ ".concat(t);if(a.length==n-1)a+="│";else{let t=this.barLength-n-3;for(;t--;)a+=" ";a+="│"}return i.push(a=DS.renderer.stylize(a,e)),i.push(this.messageCap),i}_styleText(){for(let t of(this.messageCap=DS.renderer.stylize(this.messageCap,this.style),this.menuTop=DS.renderer.stylize(this.menuTop,this.boxStyle),this.menuBottom=DS.renderer.stylize(this.menuBottom,this.boxStyle),Object.keys(this.menus)))for(let e of Object.keys(this.menus[t])){let n=this.menus[t][e];n.trueLength=n.text.length,n.activeText=this._getMenuBoxItem(n.text,this.activeStyle,n.trueLength),n.selectedText=this._getMenuBoxItem(n.text,this.selectedStyle,n.trueLength),n.processedText=this._getMenuBoxItem(n.text,this.style,n.trueLength)}}_runAnimateIn(){this.currentAnimRow>2?this.currentAnimRow-=2:(this.animateIn=!1,this.animateDown=!0)}_animaateIn(){DS.renderer.showAt(this.menuTop,this.currentAnimRow,this.collumn),DS.renderer.showAt(this.menuBottom,this.currentAnimRow+1,this.collumn)}_runAnimateDown(){this.currentAnimateDownOptionCount<this.currentAnimateDownOptionMax?this.currentAnimateDownOptionCount++:this.animateDown=!1}_animateDown(){let t=0,e=0;for(let n of(DS.renderer.showAt(this.menuTop,this.currentRow,this.collumn),Object.keys(this.menus.root))){let i=this.menus.root[n],a=i.processedText;i.active&&(a=i.activeText);let s=0;for(let t of a)DS.renderer.showAt(t,i.row+s,i.col),s++;if(e=i.row,++t>=this.currentAnimateDownOptionCount)break}DS.renderer.showAt(this.menuBottom,e+3,this.collumn)}$draw(){if(this.draw&&this.active){if(this.animateIn){this._animaateIn();return}if(this.animateDown){this._animateDown();return}for(let t of Object.keys(this.menus)){let e=0;for(let n of(DS.renderer.showAt(this.menuTop,this.currentRow,this.collumn),Object.keys(this.menus[t]))){let i=this.menus[t][n],a=i.processedText;this.optionMap[this.activeScreen][this.activeOptionNum]==i.id&&(a=i.activeText),this.optionMap[this.activeScreen][this.selectedOptionNum]==i.id&&(a=i.selectedText);let s=0;for(let t of a)DS.renderer.showAt(t,i.row+s,i.col),s++;e=i.row}DS.renderer.showAt(this.menuBottom,e+3,this.collumn)}}}$run(){this.active&&(0==this.tickCount&&(this.animateIn&&this._runAnimateIn(),this.animateDown&&(this.tickInterval=2,this._runAnimateDown()),this.tickCount=this.tickInterval),this.tickCount--)}$destroy(){}constructor(t,e,n,i,s,r="right-menu"){this.data=t,this.id=e,this.type=n,this.x=i,this.y=s,this.sceneType=r,this.tickInterval=1,this.tickCount=0,this.animateDown=!1,this.currentAnimateDownOptionCount=0,this.animateIn=!0,this.currentAnimRow=RIGHTMENUHEIGHT-3,this.active=!0,this.draw=!0,this.collumn=SCREENWIDTH+3,this.canMove=!0,this.menuTop="┌──────────────────────────┐",this.menuBottom="└──────────────────────────┘",this.messageCap="┣──────────────────────────┫",this.barLength=this.messageCap.length,this.currentRow=2,this.boxStyle=h.New({bg:a.Blue,fg:a.Black,dim:!0}),this.style=h.New({fg:a.Blue}),this.activeStyle=h.New({fg:a.Black,bg:a.Blue,dim:!0}),this.selectedStyle=h.New({fg:a.Black,bg:a.Blue,bright:!0}),this.activeScreen="root",this.activeOptionNum=0,this.selectedOptionNum=-1,this.menus={root:{attack:{id:"attack",row:3,col:this.collumn,text:"Use Force",processedText:[""],selectedText:[""],activeText:[""],trueLength:0,active:!1},spells:{id:"spells",row:5,col:this.collumn,text:"Cast Spell",processedText:[""],selectedText:[""],activeText:[""],trueLength:0,active:!1},items:{id:"items",row:7,col:this.collumn,text:"Use Item",processedText:[""],selectedText:[""],activeText:[""],trueLength:0,active:!1},flee:{id:"flee",row:9,col:this.collumn,text:"Try To Flee",processedText:[""],selectedText:[""],activeText:[""],trueLength:0,active:!1},equip:{id:"equip",row:11,col:this.collumn,text:"Equip",processedText:[""],selectedText:[""],activeText:[""],trueLength:0,active:!1},fearForm:{id:"fearForm",row:13,col:this.collumn,text:"View Fear Form Info",processedText:[""],selectedText:[""],activeText:[""],trueLength:0,active:!1},options:{id:"options",row:15,col:this.collumn,text:"Options",processedText:[""],selectedText:[""],activeText:[""],trueLength:0,active:!1}}},this.optionMap={},this._styleText(),this._buildOptionMap(),this.currentAnimateDownOptionMax=Object.keys(this.menus.root).length,this._setUpControls()}}async function to(){DS.itemManager.registerNewArmor({id:"1",name:"Armor 1",description:"Test Armor",levelRequirment:1,deffense:1}),DS.itemManager.registerNewRing({id:"1",name:"Ring 1",description:"Ring Armor",levelRequirment:1,statsEffect:{deffense:1,agaility:0,speed:0,intellegence:0,wisdom:0}}),DS.itemManager.registerNewWeapon({id:"1",name:"Weapon 1",description:"Test Weapon",levelRequirment:1,attack:1}),DS.itemManager.registerNewPotion({id:"1",name:"Ring 1",description:"Ring Armor",levelRequirment:1,onUse:()=>{}}),DS.itemManager.registerNewOtherItem({id:"1",name:"Other 1",description:"Other Test 1",levelRequirment:1}),DS.itemManager.registerNewStoryItem({id:"1",name:"Story 1",description:"Story 1",levelRequirment:1,onUse:()=>{}})}async function tl(t){let e=new L(t);window.DS=e;for(let e=0;e<t.rows;e++)for(let e=0;e<t.cols;e++);t.entityTool.update(),SOUNDENABLED,await Promise.all([tt(),to(),ts(),J(),tn(),ti(),void DS.entityManager.registerEntity("RightBattleMenu",tr)]),await e.gameInit(),e.controlManager.onInput("m",()=>{e.menuSceneManager.rightMenuDrawer.active||e.menuSceneManager.rightMenuDrawer.animating?e.menuSceneManager.rightMenuDrawer.animating||e.menuSceneManager.rightMenuDrawer.popIn():e.menuSceneManager.rightMenuDrawer.popOut()})}var th=n(24486),tc=n(58535),tu=n(81209),tm=n(5377),ty=n(97937);ty.Q.ShadersStore.asciiVertexShader="\n#version 300 es\nprecision highp float;\n// Attributes\nin vec3 position;\nin vec3 normal;\n\nin vec2 uv;\n// Uniforms\n \n\nuniform mat4 worldViewProjection;                \nuniform mat4 viewProjection;   \nuniform vec3[9] asciiColors;   \nuniform vec3[9] asciiBrightColors;   \n\n\n#ifdef INSTANCES\n//matricies\nin vec4 world0;\nin vec4 world1;\nin vec4 world2;\nin vec4 world3;\n//custom attributes\nin uint faceData;\n#endif\n\n\n// Varying\nout vec2 vUV;\nout float vCharIndex;\nout vec3 vColor;\nout vec3 vBGColor;\n\nconst uint CHAR_INDEX_MASK = 0xFFu;\nconst uint CHAR_INDEX_SHIFT = 24u;\n\nconst uint FG_COLOR_MASK = 0xFFu;\nconst uint FG_COLOR_SHIFT = 16u;\n\nconst uint BG_COLOR_MASK = 0xFFu;\nconst uint BG_COLOR_SHIFT = 8u;\n\nconst uint BOLD_MASK = 1u << 0u;\nconst uint DIM_MASK = 1u << 1u;\nconst uint BLINKING_MASK = 1u << 2u;\n\nvoid main(void) {\n    #ifdef INSTANCES\n        // Construct the final world matrix\n        mat4 finalWorld = mat4(world0, world1, world2, world3); \n        gl_Position = viewProjection * finalWorld * vec4(position, 1.0);  \n\n    \n        uint charData = uint(faceData);\n        uint charIndex = (charData >> CHAR_INDEX_SHIFT) & CHAR_INDEX_MASK;\n        \n        vCharIndex = float(charIndex);\n\n   \n        uint fgColorIndex = (charData >> FG_COLOR_SHIFT) & FG_COLOR_MASK;\n        uint bgColorIndex = (charData >> BG_COLOR_SHIFT) & BG_COLOR_MASK;\n\n        bool isBold = (charData & BOLD_MASK) != 0u;\n        bool isDim = (charData & DIM_MASK) != 0u;\n    //    bool isDim = true;\n        bool isBlinking = (charData & BLINKING_MASK) != 0u;\n\n\n       \n       if(fgColorIndex > 0u) {\n        vColor = asciiColors[fgColorIndex];\n        if (isBold) {\n          vColor *= 1.3; // Decrease brightness for dim\n        }\n        if (isDim) {\n            vColor *= 0.3; // Decrease brightness for dim\n        }\n       } else {\n        vColor = vec3(1.);\n       }\n\n       if(bgColorIndex > 0u) {\n        vBGColor = asciiColors[bgColorIndex];\n       } else {\n        vBGColor = vec3(0.);\n       }\n\n \n    #else\n        gl_Position = worldViewProjection * vec4(position, 1.0); \n    #endif\n\n    vUV = uv;\n}",ty.Q.ShadersStore.asciiFragmentShader="\n#version 300 es\nprecision highp float;\nprecision highp sampler2DArray;\nout vec4 FragColor;\nin vec2 vUV;\nin float vCharIndex;\nin vec3 vColor;\nin vec3 vBGColor;\n\n\n\n\n\nuniform sampler2DArray asciiTexture;\n\nvoid main() {\n\n    // Sample the texture array\n   // vec4 color = texture(asciiTexture, vec3(vUV, vCharIndex));\n   #ifdef INSTANCES\n   vec4 color = texture(asciiTexture, vec3(vUV, vCharIndex));\n   if(color.a < .2) {\n    FragColor = vec4(vBGColor,1.);\n    return;\n   }\n\n   FragColor = vec4(color.rgb * vColor,1.);\n   #endif\n   #ifndef INSTANCES\n    FragColor = vec4(1.,1.,1.,1.);\n    #endif\n}\n\n";let td=[];td[0]=[0,0,0],td[a.Black]=[0,0,0],td[a.Red]=[187,0,0],td[a.Purple]=[187,0,187],td[a.Green]=[0,187,0],td[a.Blue]=[0,0,187],td[a.Cyan]=[0,187,187],td[a.Yellow]=[187,187,0],td[a.White]=[187,187,187];let tS=[];tS[0]=[0,0,0],tS[a.Black]=[85,85,85],tS[a.Red]=[255,85,85],tS[a.Purple]=[255,85,255],tS[a.Green]=[85,255,85],tS[a.Blue]=[85,85,255],tS[a.Cyan]=[85,255,255],tS[a.Yellow]=[255,255,85],tS[a.White]=[255,255,255];var tg=n(47111);let tp={IDENTIY_MATRIX:[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]]};class tw{get x(){return this.data.getX()}get y(){return this.data.getY()}get z(){return this.data.getZ()}get w(){return this.data.getW()}set x(t){this.data.setX(t)}set y(t){this.data.setY(t)}set z(t){this.data.setZ(t)}set w(t){this.data.setW(t)}set(t,e,n){this.x=t,this.y=e,this.z=n}setAll(t){this.x=t,this.y=t,this.z=t}constructor(t){this.data=t}}class tv{static buildProperties(t){let e=t.matricies,n=0;for(;n<16;){let i=n;t.rows.push(new tw({getX:()=>e[i+t.trueIndex],getY:()=>e[i+1+t.trueIndex],getZ:()=>e[i+2+t.trueIndex],getW:()=>e[i+3+t.trueIndex],setX:n=>{e[i+t.trueIndex]=n},setY:n=>{e[i+1+t.trueIndex]=n},setZ:n=>{e[i+2+t.trueIndex]=n},setW:n=>{e[i+3+t.trueIndex]=n}})),n+=4}for(n=0;n<4;){let i=n;t.cols.push(new tw({getX:()=>e[i+t.trueIndex],getY:()=>e[i+4+t.trueIndex],getZ:()=>e[i+8+t.trueIndex],getW:()=>e[i+12+t.trueIndex],setX:i=>{e[n+t.trueIndex]=i},setY:n=>{e[i+4+t.trueIndex]=n},setZ:n=>{e[i+8+t.trueIndex]=n},setW:n=>{e[i+12+t.trueIndex]=n}})),n++}}setMatriciesIndex(t){return this.index=t,this.trueIndex=16*t,this}copy(t){for(let e=0;e<16;e++)this.matricies[e+this.trueIndex]=t.matricies[e+t.trueIndex]}copyIndex(){let t=[];for(let e=0;e<16;e++)t.push(this.matricies[e+this.trueIndex]);return t}multiply(t){for(let e=0;e<4;e++)tf.rows[e].x=this.rows[e].x*t.cols[0].x+this.rows[e].y*t.cols[0].y+this.rows[e].z*t.cols[0].z+this.rows[e].w*t.cols[0].w,tf.rows[e].y=this.rows[e].x*t.cols[1].x+this.rows[e].y*t.cols[1].y+this.rows[e].z*t.cols[1].z+this.rows[e].w*t.cols[1].w,tf.rows[e].z=this.rows[e].x*t.cols[2].x+this.rows[e].y*t.cols[2].y+this.rows[e].z*t.cols[2].z+this.rows[e].w*t.cols[2].w,tf.rows[e].w=this.rows[e].x*t.cols[3].x+this.rows[e].y*t.cols[3].y+this.rows[e].z*t.cols[3].z+this.rows[e].w*t.cols[3].w;this.copy(tf)}constructor(t,e=0){if(this.trueIndex=0,this.scale=new tw({getX:()=>this.matricies[tv.MATRIX_INDEXES.SCALE_X+this.trueIndex],getY:()=>this.matricies[tv.MATRIX_INDEXES.SCALE_Y+this.trueIndex],getZ:()=>this.matricies[tv.MATRIX_INDEXES.SCALE_Z+this.trueIndex],getW:()=>this.matricies[tv.MATRIX_INDEXES.SCALE_W+this.trueIndex],setX:t=>{this.matricies[tv.MATRIX_INDEXES.SCALE_X+this.trueIndex]=t},setY:t=>{this.matricies[tv.MATRIX_INDEXES.SCALE_Y+this.trueIndex]=t},setZ:t=>{this.matricies[tv.MATRIX_INDEXES.SCALE_Z+this.trueIndex]=t},setW:t=>{this.matricies[tv.MATRIX_INDEXES.SCALE_W+this.trueIndex]=t}}),this.position=new tw({getX:()=>this.matricies[tv.MATRIX_INDEXES.POSITION_X+this.trueIndex],getY:()=>this.matricies[tv.MATRIX_INDEXES.POSITION_Y+this.trueIndex],getZ:()=>this.matricies[tv.MATRIX_INDEXES.POSITION_Z+this.trueIndex],getW:()=>0,setX:t=>{this.matricies[tv.MATRIX_INDEXES.POSITION_X+this.trueIndex]=t},setY:t=>{this.matricies[tv.MATRIX_INDEXES.POSITION_Y+this.trueIndex]=t},setZ:t=>{this.matricies[tv.MATRIX_INDEXES.POSITION_Z+this.trueIndex]=t},setW:t=>{}}),this.index=e,this.setMatriciesIndex(e),this.rows=[],this.cols=[],t instanceof tv){this.matricies=t.matricies,tv.buildProperties(this);return}this.matricies=new Float32Array(16*t);let n=0,i=0;for(;i<t;){for(let t of tp.IDENTIY_MATRIX)for(let e of t)this.matricies[n]=e,n++;i++}tv.buildProperties(this)}}tv.MATRIX_INDEXES={POSITION_X:12,POSITION_Y:13,POSITION_Z:14,SCALE_X:0,SCALE_Y:5,SCALE_Z:10,SCALE_W:15};let tf=new tv(1,0),tM=new tv(1,0),tD=new tv(1,0),tx=new tv(1,0);class tb{_updateMatrix(){for(let t of this._matrix.rows)t.setAll(0);this._matrix.scale.x=this._scale.x,this._matrix.scale.y=this._scale.y,this._matrix.scale.z=this._scale.z,this._matrix.position.x=-this.piviotPoint.x,this._matrix.position.y=-this.piviotPoint.y,this._matrix.position.z=-this.piviotPoint.z,this.rotation.x&&(tM.rows[1].y=Math.cos(this._rotation.x),tM.rows[1].z=-Math.sin(this._rotation.x),tM.rows[2].y=Math.sin(this._rotation.x),tM.rows[2].z=Math.cos(this._rotation.x),this._matrix.multiply(tM)),this.rotation.y&&(tD.rows[0].x=Math.cos(this._rotation.y),tD.rows[0].z=Math.sin(this._rotation.y),tD.rows[2].x=-1*Math.sin(this._rotation.y),tD.rows[2].z=Math.cos(this._rotation.y),this._matrix.multiply(tD)),this.rotation.z&&(tx.rows[0].x=Math.cos(this._rotation.z),tx.rows[0].y=-Math.sin(this._rotation.z),tx.rows[1].x=Math.sin(this._rotation.z),tx.rows[1].y=Math.cos(this._rotation.z),this._matrix.multiply(tx)),this._matrix.position.x+=this.position.x+this.piviotPoint.x,this._matrix.position.y+=this.position.y+this.piviotPoint.y,this._matrix.position.z+=this.position.z+this.piviotPoint.z}destroy(){this._tool.returnInstance(this)}constructor(t,e,n){this.piviotPoint={x:.5,y:0,z:.5},this._scale={x:1,y:1,z:1},this.scale=new tw({setX:t=>{this._scale.z=t,this._updateMatrix()},getX:()=>this._scale.z,setY:t=>{this._scale.y=t,this._updateMatrix()},getY:()=>this._scale.y,setZ:t=>{this._scale.z=t,this._updateMatrix()},getZ:()=>this._scale.z,setW:t=>{},getW:()=>0}),this._rotation={x:0,y:0,z:0},this.rotation=new tw({setX:t=>{this._rotation.x=t,this._updateMatrix()},getX:()=>this._rotation.x,setY:t=>{this._rotation.y=t,this._updateMatrix()},getY:()=>this._rotation.y,setZ:t=>{this._rotation.z=t,this._updateMatrix()},getZ:()=>this._rotation.z,setW:()=>{},getW:()=>0}),this._position={x:0,y:0,z:0},this.position=new tw({setX:t=>{this._position.x=t,this._updateMatrix()},getX:()=>this._position.x,setY:t=>{this._position.y=t,this._updateMatrix()},getY:()=>this._position.y,setZ:t=>{this._position.z=t,this._updateMatrix()},getZ:()=>this._position.z,setW:()=>{},getW:()=>0}),this.index=t,this._matrix=e,this._tool=n}}n(21658);class tC{addBuffer(t,e,n){this.mesh.thinInstanceSetBuffer(t,e,n,!1),this._bufferIds.push(t)}setInstanceAmount(t){this._matrixArray=new tv(t),this.addBuffer("matrix",this._matrixArray.matricies,16),this._instanceAmount=t;let e=this._instanceAmount;for(;e--;){let t=new tb(e,new tv(this._matrixArray,e),this);this._instances.push(t)}this.update()}getInstance(){let t=this._instances.shift();return!!t&&(t.scale.setAll(1),t.position.setAll(0),this._usedInstances.add(t),t)}returnInstance(t){t.scale.setAll(0),t.position.setAll(0),this._instances.push(t),this._usedInstances.delete(t)}returnAll(){for(let t of this._usedInstances)this.returnInstance(t);this._usedInstances.clear()}update(){this._bufferIds.forEach(t=>this.mesh.thinInstanceBufferUpdated(t))}constructor(t){this._instanceAmount=0,this._instances=[],this._usedInstances=new Set,this._bufferIds=[],this.mesh=t}}var tT=n(36600);class tA{setData(t){return this._data=t>>>0,this}getData(){return this._data>>>0}setChar(t){return this._data&=16777215,this._data|=(255&t)<<24,this}setCharColor(t){return this._data&=-16711681,this._data|=(255&t)<<16,this}setBackgroundColor(t){return this._data&=-65281,this._data|=(255&t)<<8,this}setBold(t){return t?this._data|=1:this._data&=-2,this}setDim(t){return t?this._data|=2:this._data&=-3,this}setBlinking(t){return t?this._data|=4:this._data&=-5,this}getChar(){return this._data>>24&255}getCharColor(){return this._data>>16&255}getBackgroundColor(){return this._data>>8&255}isBold(){return(1&this._data)!=0}isDim(){return(2&this._data)!=0}isBlinking(){return(4&this._data)!=0}constructor(){this._data=0}}String.fromCharCode(32768);class tI{isStyleChar(t){return void 0===u.asciiRecord[t]&&t.charCodeAt(0)>=32768}setChar(t){let e=t.charCodeAt(0);return this.setData(e)}getChar(){return String.fromCharCode(this.getData())}setData(t){return this._data=(t|tI.STYLE_CHAR_FLAG_MASK)>>>0,this}getData(){return this._data>>>0}setCharColor(t){if(t<0||t>63)throw Error("Invalid color index. Must be between 0 and 63.");this._data=this._data&~tI.FG_COLOR_MASK|t<<tI.FG_COLOR_SHIFT}getCharColor(){return(this._data&tI.FG_COLOR_MASK)>>>tI.FG_COLOR_SHIFT}setBackgroundColor(t){if(t<0||t>63)throw Error("Invalid color index. Must be between 0 and 63.");this._data=this._data&~tI.BG_COLOR_MASK|t<<tI.BG_COLOR_SHIFT}getBackgroundColor(){return(this._data&tI.BG_COLOR_MASK)>>>tI.BG_COLOR_SHIFT}setBold(t){t?this._data|=tI.BOLD_FLAG_MASK:this._data&=~tI.BOLD_FLAG_MASK}isBold(){return(this._data&tI.BOLD_FLAG_MASK)!=0}setDim(t){t?this._data|=tI.DIM_FLAG_MASK:this._data&=~tI.DIM_FLAG_MASK}isDim(){return(this._data&tI.DIM_FLAG_MASK)!=0}setBlinking(t){t?this._data|=tI.BLINKING_FLAG_MASK:this._data&=~tI.BLINKING_FLAG_MASK}isBlinking(){return(this._data&tI.BLINKING_FLAG_MASK)!=0}encodeStyle(t){return this.setData(0),t.fg&&this.setCharColor(t.fg),t.bg&&this.setBackgroundColor(t.bg),this.setDim(!!t.dim),this.setBlinking(!!t.blinking),this.setBold(!!t.bright),this.getChar()}constructor(){this._data=0}}tI.FG_COLOR_MASK=63,tI.BG_COLOR_MASK=4032,tI.BOLD_FLAG_MASK=4096,tI.DIM_FLAG_MASK=8192,tI.BLINKING_FLAG_MASK=16384,tI.STYLE_CHAR_FLAG_MASK=32768,tI.FG_COLOR_SHIFT=0,tI.BG_COLOR_SHIFT=6;class t_{asyncSleep(t){return new Promise(e=>{setTimeout(()=>e(!0),t)})}stylize(t,e){return this.styleCharEncode.encodeStyle(e)+t}showAt(t,e,n){if(!t||!t.length)return this;let i=n;for(let a=0;a<t.length;a++){let s=t[a];if("\n"==s||"\r"==s){e++,i=n;continue}let r=this.bufferIndex.getIndexXY(e,i);if(this.styleCharEncode.isStyleChar(s)){this.styleCharEncode.setChar(s),this.charDataEncode.setCharColor(this.styleCharEncode.getCharColor()).setBackgroundColor(this.styleCharEncode.getBackgroundColor()).setDim(this.styleCharEncode.isDim()).setBold(this.styleCharEncode.isBold()).setBlinking(this.styleCharEncode.isBlinking());continue}this.charData[r]=this.charDataEncode.setChar(u.getCharCodeAt(s)).getData(),i++}return this.charDataEncode.setData(0),this}setCharAt(t,e,n){let i=this.bufferIndex.getIndexXY(e,n);this.charData[i]=this.charDataEncode.setData(this.charData[i]).setChar(t).getData()}constructor(t,e,n){this.charTiles=[],this.charDataEncode=new tA,this.styleCharEncode=new tI,this.rows=e,this.cols=n;let i=function(t){let e=new Uint8Array(524288),n=document.createElement("canvas");n.width=16,n.height=32;let i=n.getContext("2d");if(!i)throw Error("Failed to get 2D context");i.textAlign="center",i.textBaseline="middle",i.font="".concat(32,"px monospace");for(let t=0;t<256;t++){i.clearRect(0,0,16,32);let n=u.getCharFromCode(t);i.clearRect(0,0,16,32),i.fillStyle="white",i.fillText(n,8,16);let a=i.getImageData(0,0,16,32),s=2048*t;e.set(a.data,s)}return new th.e(e,16,32,256,tc.g.TEXTUREFORMAT_RGBA,t,!1,!1,tu.x.NEAREST_SAMPLINGMODE,tc.g.TEXTURETYPE_UNSIGNED_BYTE)}(t),a=function(t,e){let n=new tm.j("shader",t,{vertex:"ascii",fragment:"ascii"},{attributes:["position","normal","faceData","uv","world0","world1","world2","world3"],uniforms:["viewProjection","worldViewProjection","asciiColors","asciiBrightColors"],samplers:["asciiTexture"]});return n.setTexture("asciiTexture",e),n.setArray3("asciiColors",td.flatMap(t=>t.map(t=>t/255))),n.setArray3("asciiBrightColors",tS.flatMap(t=>t.map(t=>t/255))),n}(t,i),s=function(t,e){let n=new tg.Kj0("ascii-quad",t);n.setVerticesData(tg.oZy.PositionKind,[.008,0,.016,0,0,.016,0,0,0,.008,0,0]),n.setVerticesData(tg.oZy.NormalKind,[0,1,0,0,1,0,0,1,0,0,1,0]),n.setVerticesData(tg.oZy.UVKind,[0,1,1,1,1,0,0,0]),n.setIndices([0,1,2,2,3,0]),n.material=e;let i=new tC(n);return n.alwaysSelectAsActiveMesh=!0,i}(t,a);this.bufferIndex=tT.h7.GetXYOrder(),this.bufferIndex.setBounds(this.rows,this.cols);let r=this.rows*this.cols;s.setInstanceAmount(r),this.charData=new Uint32Array(r),s.addBuffer("faceData",this.charData,1);let o=-.008*n;for(let t=0;t<n;t++)for(let n=0;n<e;n++){let e=this.bufferIndex.getIndexXY(n,t),i=s.getInstance();if(!i)break;this.charTiles[e]=i,i.position.x=o+.008*t,i.position.y=0,i.position.z=-.016-.016*n,i.scale.setAll(1)}s.update(),this.entityTool=s}}class tE{create(){let t=new tg.cEJ("OrthoCamera",new tg.Pa4(0,10,0),this.scene);this.camera=t,t.mode=tg.V1s.ORTHOGRAPHIC_CAMERA,t.setTarget(new tg.Pa4(0,0,0)),t.speed=.1,t.minZ=.001;let e=.008*this.cols,n=.016*this.rows;t.orthoLeft=0,t.orthoRight=e,t.orthoTop=n,t.orthoBottom=0}constructor(t,e,n){this.scene=t,this.rows=e,this.cols=n}}tg.Qmf.ShadersStore.crtFragmentShader="\n#ifdef GL_ES\nprecision highp float;\n#endif\n\n#define PI 3.1415926538\n\n// Samplers\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\n\n// Parameters\nuniform vec2 curvature;\nuniform vec2 screenResolution;\nuniform vec2 scanLineOpacity;\nuniform float vignetteOpacity;\nuniform float brightness;\nuniform float vignetteRoundness;\nuniform float glowIntensity; // New uniform for glow intensity\n\nvec2 curveRemapUV(vec2 uv) {\n// Distortion using a sinusoid.\nuv = uv * 2.0 - 1.0;\nvec2 offset = abs(uv.yx) / vec2(curvature.x, curvature.y);\nuv = uv + uv * offset * offset;\nuv = uv * 0.5 + 0.5;\nreturn uv;\n}\n\nvec4 scanLineIntensity(float uv, float resolution, float opacity) {\nfloat intensity = sin(uv * resolution * PI * 2.0);\nintensity = ((0.5 * intensity) + 0.5) * 0.9 + 0.1;\nreturn vec4(vec3(pow(intensity, opacity)), 1.0);\n}\n\nvec4 vignetteIntensity(vec2 uv, vec2 resolution, float opacity, float roundness) {\nfloat intensity = uv.x * uv.y * (1.0 - uv.x) * (1.0 - uv.y);\nreturn vec4(vec3(clamp(pow((resolution.x / roundness) * intensity, opacity), 0.0, 1.0)), 1.0);\n}\n\n// Glow effect function (blurring bright areas)\nvec4 applyGlow(vec4 color, vec2 uv) {\nvec4 glowColor = vec4(0.0);\nfloat blurSize = 1.0 / screenResolution.x * glowIntensity; // Adjust blur size\n\n// Sample neighboring pixels to create a simple blur effect\nfor (int x = -2; x <= 2; x++) {\n   for (int y = -2; y <= 2; y++) {\n       vec2 offset = vec2(float(x), float(y)) * blurSize;\n       glowColor += texture2D(textureSampler, uv + offset);\n   }\n}\nglowColor /= 25.0; // Normalize the blur contribution\n\n// Add glow based on brightness threshold\nvec3 brightColor = max(vec3(0.0), color.rgb - vec3(0.8)); // Adjust threshold\nreturn vec4(color.rgb + brightColor * glowColor.rgb * glowIntensity, color.a);\n}\n\nvoid main(void) {\nvec2 remappedUV = vUV;\nvec4 baseColor = texture2D(textureSampler, remappedUV);\n\n// Apply vignette effect\nbaseColor *= vignetteIntensity(remappedUV, screenResolution, vignetteOpacity, vignetteRoundness);\n\n// Apply scan line effect\nbaseColor *= scanLineIntensity(remappedUV.x, screenResolution.y, scanLineOpacity.x);\nbaseColor *= scanLineIntensity(remappedUV.y, screenResolution.x, scanLineOpacity.y);\n\n// Apply brightness\nbaseColor *= vec4(vec3(brightness), 1.0);\n\n// Apply glow effect\nbaseColor = applyGlow(baseColor, remappedUV);\n\nif (remappedUV.x < 0.0 || remappedUV.y < 0.0 || remappedUV.x > 1.0 || remappedUV.y > 1.0) {\n   gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n} else {\n   gl_FragColor = baseColor;\n}\n}\n\n     ";class tR{create(t){this.postProcess=new tg.Dso("CRTShaderPostProcess","crt",["curvature","screenResolution","scanLineOpacity","vignetteOpacity","brightness","vignetteRoundness","glowIntensity"],null,1,t),this.postProcess.onApply=function(t){t.setFloat2("curvature",5,5),t.setFloat2("screenResolution",300,300),t.setFloat2("scanLineOpacity",.5,.5),t.setFloat("vignetteOpacity",0),t.setFloat("brightness",4),t.setFloat("vignetteRoundness",0),t.setFloat("glowIntensity",10)}}}var tN=function(t){return(0,s.jsx)(o.X,{title:"ASCIIGame",description:"ASCIIGame",children:(0,s.jsx)(r.Z,{id:"main",className:"render-canvas",onSceneReady:t=>{t.getEngine().getRenderingCanvas(),t.clearColor.setAll(0),t.clearColor.a=1;let e=new tE(t,40,80);e.create(),new tR().create(e.camera),tl(new t_(t,40,80))}})})}},3582:function(t,e,n){"use strict";n.d(e,{Z:function(){return o}});var i=n(57437),a=n(89936),s=n(44755),r=n(2265);function o(t){let e=(0,r.useRef)(null),{antialias:n,engineOptions:o,adaptToDeviceRatio:l,sceneOptions:h,onSceneReady:c,...u}=t;return(0,r.useEffect)(()=>{if(!e.current)return;let i=new a.D(e.current,n,o,l),r=new s.x(i,h),c=e.current,u=()=>{r.getEngine().resize(),c.width=window.innerWidth,c.height=window.innerHeight};return(async()=>{await t.onSceneReady(r),i.runRenderLoop(()=>{r.render()}),window.addEventListener("resize",u),u()})(),()=>{r.dispose(),i.dispose(),window.removeEventListener("resize",u)}},[]),(0,i.jsx)("canvas",{ref:e,...u})}},48622:function(){}},function(t){t.O(0,[5020,5889,1218,5611,4849,4913,8342,7857,6902,6498,6874,6426,6331,6395,3751,4640,3610,7665,5068,7111,7686,3912,2971,2117,1744],function(){return t(t.s=11034)}),_N_E=t.O()}]);