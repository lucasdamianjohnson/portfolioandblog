"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2788],{72788:function(e,t,a){let i,s;a.r(t),a.d(t,{default:function(){return eN}});class o{resolvePath(e){return this.basePath+("/"===e[0]?"":"/")+e}async getData(e){let t=this.resolvePath(e),a=await fetch(t);if(!a.ok)throw Error("Failed to fetch file at ".concat(t));return await a.text()}async getDataBuffer(e){let t=this.resolvePath(e),a=await fetch(t);if(!a.ok)throw Error("Failed to fetch file at ".concat(t));return await a.arrayBuffer()}async getJSONFromFileAsync(e){let t=this.resolvePath(e),a=await fetch(t);if(!a.ok)throw Error("Failed to fetch JSON file at ".concat(t));return await a.json()}async getDataAsStringAsync(e){let t=this.resolvePath(e),a=await fetch(t);if(!a.ok)throw Error("Failed to fetch file at ".concat(t));return await a.text()}async getDataAsBufferAsync(e){let t=this.resolvePath(e),a=await fetch(t);if(!a.ok)throw Error("Failed to fetch file at ".concat(t));return await a.arrayBuffer()}async writeStringToFile(e,t){throw Error("Writing to files is not supported with fetch.")}async createDirectory(e){throw Error("Creating directories is not supported with fetch.")}async readDir(e){throw Error("Reading directories is not supported with fetch.")}loadCommentedJsonFromPath(e){throw arguments.length>1&&void 0!==arguments[1]&&arguments[1],Error("This method cannot be implemented using fetch.")}parseCommentedJson(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return this.hJson.parse(e,{keepWsc:t})}stringfyCommentedJson(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return this.hJson.stringify(e,{keepWsc:t,space:5,quotes:"all",separator:!0})}readFile(e){return this.getData(e)}writeFile(e,t){throw Error("Writing to files is not supported with fetch.")}constructor(e,t=""){this.basePath="/assets/InfiniteRealmRunner",this.hJson=e}}function n(e){e.registerHook("screen-resize"),e.registerHook("program-refresh"),e.registerHook("program-exit"),e.registerHook("program-start"),e.registerHook("enter-loading-screen"),e.registerHook("enter-level"),e.registerHook("exit-level"),e.registerHook("pause"),e.registerHook("un-pause"),e.registerHook("set-checkpoint"),e.registerHook("start-level"),e.registerHook("reset-before"),e.registerHook("reset-after",!0)}class r{async loadLanguageFile(){let e=JSON.parse(await DIVINESTAR.fileHandler.getDataAsStringAsync(this.languageFilePath+"".concat(this.activeLanguage,".json")));return this.languageData=e,!0}setLanguage(e){this.activeLanguage=e}getText(e,t){return this.languageData[e][t]}constructor(){this.activeLanguage="en-US",this.languageData={"cut-scene":{},"loading-screen":{},"credits-screen":{},"level-lingo":{},"lore-piece":{},"menu-screen":{},objects:{}},this.languageFilePath="/data/lang/"}}class l{async loadProfileData(){let e=await DIVINESTAR.fileHandler.getDataAsStringAsync(this.profilesPath);this.profileTemplate=await DIVINESTAR.fileHandler.getDataAsStringAsync(this.profileTemplatePath),this.levelVarationTemplate=await DIVINESTAR.fileHandler.getDataAsStringAsync(this.levelVarationTemplatePath);let t=JSON.parse(e);this.allData=t,this.profiles=t.profiles,this.icons=t.icons,this.icons.forEach((e,t)=>{this.iconPaths[t]="assets/screens/profileicons/".concat(e,".png")})}createProfile(e){e.id="".concat(this.profiles.length+1);let t={location:"".concat(this.profileFoldersPath).concat(e.id),name:e.name,id:e.id,profileIconId:e.icon};this.profiles.push(t),(async()=>{Promise.all([this._saveProfiles(),this._createNewProfileData(t)])})()}async _createNewProfileData(e){await DIVINESTAR.fileHandler.createDirectory(e.location);let t="".concat(e.location,"/levelvarations/");await DIVINESTAR.fileHandler.createDirectory(t);let a="".concat(e.location,"/profiledata.json");await DIVINESTAR.fileHandler.writeStringToFile(this.profileTemplate,a);let i=[];DIVINESTAR.levelManager.levelData.levels.forEach(e=>{let a=e.id,s="".concat(t).concat(a,".json"),o=JSON.parse(this.levelVarationTemplate);o.id=a;let n=JSON.stringify(o);i.push(DIVINESTAR.fileHandler.writeStringToFile(n,s))}),await Promise.all(i)}async saveLevelVarationData(){let e="".concat(this.activeProfileData.location,"/levelvarations/"),t=[];Object.keys(DIVINESTAR.levelManager.levelDescriptionData).forEach(a=>{Object.keys(DIVINESTAR.levelManager.levelDescriptionData[a]).forEach(i=>{DIVINESTAR.levelManager.levelDescriptionData[a][i].name;let s="".concat(e).concat(a,"-").concat(i,".json"),o=JSON.stringify(this.levelVarations["".concat(a,"-").concat(i,"}")]);t.push(DIVINESTAR.fileHandler.writeStringToFile(o,s))})}),await Promise.all(t)}async _saveProfiles(){let e=JSON.stringify(this.allData,void 0,5);await DIVINESTAR.fileHandler.writeStringToFile(e,this.profilesPath)}async setActiveProfile(e){this.activeProfile=e;let t=this.profiles[parseInt(e)-1];this.activeProfileData=t;let a=t.location,i="".concat(a,"/levelvarations/"),s=[],o=[],n={};Object.keys(DIVINESTAR.levelManager.levelDescriptionData).forEach(e=>{n[e]={},Object.keys(DIVINESTAR.levelManager.levelDescriptionData[e]).forEach(t=>{let a=DIVINESTAR.levelManager.levelDescriptionData[e][t],r=a.id;s.push(this.levelVarations["".concat(e,"-").concat(t,"}")]),n[e][a.id]="true";let l="".concat(i).concat(e,"-").concat(r,".json");o.push(DIVINESTAR.fileHandler.getDataAsStringAsync(l))})}),s=await Promise.all(o);let r=Object.keys(n);s.forEach((e,t)=>{let a=JSON.parse(e),i="";for(let e of r)if(n[e][a.id]){i="".concat(e,"-").concat(a.id);break}this.levelVarations[i]=a})}getIconUrl(e){return this.iconPaths[e]}constructor(){this.iconPaths=[],this.activeProfile="",this.profilesPath="/private/userdata/profiles.json",this.profileFoldersPath="/private/userdata/profiles/",this.profileTemplatePath="/private/userdata/profile-template.json",this.levelVarationTemplatePath="/private/userdata/level-varation-template.json",this.levelVarations={}}}class c{$initalize(){this.GUI=DIVINESTAR.GUI}hideScreenContrainer(e){this.GUI.hideContainer(e)}showScreenContrainer(e){this.screenContainers[e].style.display="block";let t=Object.keys(this.screenContainers),a=t.length;for(;a--;){let e=t[a];this.screenContainers[e].style.display="none"}this.screenContainers[e].style.display="block"}createSubScreen(e,t){this.GUI.createSubContainer(e,t)}createScreen(e,t){this.GUI.createContainer(e,t)}createScreenContainer(e){this.GUI.createMetaContainer(e)}selectOption(){let e=this,t=e.dataset.screen,a=e.dataset.id;DIVINESTAR.screenCreator.screenOptions[t][a].func()}getRotateSelectValue(e,t){return this.rotateSelects[e][t].currentValue}getInputValue(e,t){return this.inputs[e][t].value}getGridSelectValue(e,t){return this.gridSelects[e][t].value}populateGridSelect(e,t){let a=this.gridSelects[e][t],i=a.populate();this.GUI.populateScrollView(e,t,a.collumns,a.rowHeight,i)}populateDataDisplay(e,t,a){this.GUI.populateDataView(t,e,a)}addDataDisplay(e,t,a){let i=this._getID(e);this.GUI.createDataView(t,e,a.width,a.height),this.dataDisplays[i]||(this.dataDisplays[i]={}),this.dataDisplays[i][t]={type:a.type,id:t}}addGridItemSelect(e,t){let a="";a="object"==typeof e?e[0]:e,this.gridSelects[a]||(this.gridSelects[a]={}),this.gridSelects[a][t.id]={id:t.id,value:"",items:[],rowHeight:t.rowHeight,collumns:t.collumns,populate:t.populate};let i=e=>{console.log(e),this.gridSelects[a][t.id].value=e};this.GUI.createScrollView(t.id,e,t.orientation,i,t.width,t.height)}addGridItemSelectItem(e,t,a){}addInfoBox(e,t){let a=document.createElement("div");a.className="infobox";let i=document.createElement("div");i.className="infobox-title",i.innerText=t.title;let s=document.createElement("div");if(s.className="infobox-description",s.innerText=t.description,a.append(i),a.append(s),!this.infoBoxGroups[t.group]){let a=document.createElement("div");a.className="infobox-group",this.infoBoxGroups[t.group]=a,"object"==typeof e?this.subScreens[e[0]][e[1]].append(a):this.screens[e].append(a)}this.infoBoxGroups[t.group].append(a)}addCopyRight(e){var t=new Date().getFullYear();let a=document.createElement("p");a.className="ds-copyright",a.innerText="CopyRight \xa9️ ".concat(t," Divine Star LLC"),"object"==typeof e?this.subScreens[e[0]][e[1]].append(a):this.screens[e].append(a)}addImage(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=document.createElement("img");i.className="main-menu-img ".concat(a),i.src=t,"object"==typeof e?this.subScreens[e[0]][e[1]].append(i):this.screens[e].append(i)}addText(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=document.createElement("p");i.className="main-menu-text ".concat(a),i.innerText=t,"object"==typeof e?this.subScreens[e[0]][e[1]].append(i):this.screens[e].append(i)}addCredit(e,t,a){let i=document.createElement("p"),s=document.createElement("span"),o=document.createElement("span");o.className="credit-label",s.className="person-label",s.innerText=a,o.innerText=t+":",i.append(o),i.append(s),"object"==typeof e?this.subScreens[e[0]][e[1]].append(i):this.screens[e].append(i)}addSpacer(e,t){this.GUI.createGUIContainer(e,"rectangle",t)}addTitle(e,t,a,i){let s=10,o="white";"h1"==a&&(s=20,o="purple"),"h2"==a&&(s=15,o="white"),this.GUI.createText(e,t,o,s)}enterScreen(e){this.GUI.enterContainer(e)}_getTextInput(e,t){let a=document.createElement("label");a.innerHTML=t.label,a.className="input-text-label";let i=document.createElement("input");return i.spellcheck=!1,i.type="text",i.dataset.screen=e,i.dataset.id=t.name,t.maxLength&&(i.maxLength=t.maxLength),this.inputs[e]||(this.inputs[e]={}),this.inputs[e][t.name]=i,a.append(i),a}_getInputRange(e,t){let a=document.createElement("label");a.innerHTML=t.label,a.className="input-range-label";let i=document.createElement("input");return i.spellcheck=!1,i.type="range",i.dataset.screen=e,i.dataset.id=t.name,i.max="".concat(t.max),i.min="".concat(t.min),i.value="".concat(t.value),t.maxLength&&(i.maxLength=t.maxLength),this.inputs[e]||(this.inputs[e]={}),this.inputs[e][t.name]=i,a.append(i),a}_getID(e){return"object"==typeof e?e[0]:e}_addTextInput(e,t){let a=JSON.parse(JSON.stringify({type:"string",value:""})),i=this._getID(e);this.inputs[i]||(this.inputs[i]={}),this.inputs[i][t.name]=a;let s=e=>{a.value=e};this.GUI.createTextInput(e,t.label,"",s)}_addOptionButton(e,t){if(!t.func)throw Error("Error when creating button ".concat(t.name," no on click function provided."));this.GUI.createButton(e,t.label,t.func)}_addRotateSelect(e,t){let a=t.rotateSelectOptions,i=this._getID(e);this.rotateSelects[i]||(this.rotateSelects[i]={}),this.rotateSelects[i][t.name]={rotateSelectOptions:a,maxOptions:a.length,currentOptions:0,currentValue:a[0]};let s=(e,a)=>{console.log(e,a),this.rotateSelects[i][t.name].currentValue=e,this.rotateSelects[i][t.name].currentOptions=a};this.GUI.createRotateSelect(e,t.name,t.label,a,s)}addOptionToScreen(e,t){let a=t.type;"button"==a&&this._addOptionButton(e,t),"text-input"==a&&this._addTextInput(e,t),"rotate-select"==a&&this._addRotateSelect(e,t)}constructor(){this.screenContainers={},this.screens={},this.subScreens={},this.mainOptions={},this.rotateSelects={},this.screenOptions={},this.infoBoxGroups={},this.inputs={},this.gridSelects={},this.dataDisplays={}}}class h{hideMenu(){DIVINESTAR.screenCreator.hideScreenContrainer(this.screenContainer)}showMenu(){DIVINESTAR.screenCreator.showScreenContrainer(this.screenContainer),DIVINESTAR.screenCreator.enterScreen(this.mainScreen)}createMenu(){let e=DIVINESTAR.screenCreator,t=DIVINESTAR.languageManager;e.createScreenContainer(this.screenContainer),e.createScreen(this.screenContainer,this.mainScreen),e.createSubScreen(this.mainScreen,this.mainScreenTop[1]),e.createSubScreen(this.mainScreen,this.mainScreenMiddle[1]),e.createSubScreen(this.mainScreen,this.mainScreenBottom[1]),e.addTitle(this.mainScreenTop,t.getText("menu-screen","paused"),"h1"),e.addOptionToScreen(this.mainScreenMiddle,{type:"button",name:"exit-to-level-select",label:t.getText("menu-screen","exit-to-level-select"),func:()=>{DIVINESTAR.eventHooks.triggerHook("exit-level"),e.enterScreen("level-select")}}),e.addOptionToScreen(this.mainScreenMiddle,{type:"button",name:"exit-to-varation-select",label:t.getText("menu-screen","exit-to-varation-select"),func:()=>{DIVINESTAR.eventHooks.triggerHook("exit-level"),e.enterScreen("level-varation-select")}}),e.addOptionToScreen(this.mainScreenMiddle,{type:"button",name:"exit-to-main-menu",label:t.getText("menu-screen","exit-to-main-menu"),func:()=>{DIVINESTAR.eventHooks.triggerHook("exit-level"),e.enterScreen("main")}}),e.addOptionToScreen(this.mainScreenMiddle,{type:"button",name:"options",label:t.getText("menu-screen","options"),func:()=>{DIVINESTAR.optionsMenu.showMenu()}}),e.addOptionToScreen(this.mainScreenMiddle,{type:"button",name:"unpause",label:t.getText("menu-screen","back-to-game"),func:()=>{DIVINESTAR.eventHooks.triggerHook("un-pause")}}),this._setUpHooks(),this.hideMenu()}_setUpHooks(){let e=this;DIVINESTAR.eventHooks.addToHook("pause",()=>{DIVINESTAR.levelManager.activeLevel&&e.showMenu()}),DIVINESTAR.eventHooks.addToHook("un-pause",()=>{DIVINESTAR.levelManager.activeLevel&&e.hideMenu()})}constructor(){this.screenContainer="pause-menu",this.mainScreen="pause-menu-main",this.mainScreenTop=[this.mainScreen,"pause-menu-main-top"],this.mainScreenMiddle=[this.mainScreen,"pause-menu-main-middle"],this.mainScreenBottom=[this.mainScreen,"pause-menu-main-bottom"]}}class d{createMenu(){this._createLevelCategoryScreen(),this._createLevelSelectScreen(),this.createLevelVarationsScreen(),this.createLevelVarationDisplayScreen(),this.createLevelOptionsScreen(),this.createConfirmDeleteSceen()}enterLevel(){DIVINESTAR.screenCreator,DIVINESTAR.loadingScreen.showLoadingScreen(),DIVINESTAR.levelManager.setActiveLevel(this.currentLevelSelected,this.currentLevelCategorySelected);let e=DIVINESTAR.profileManager.levelVarations[this.currentLevelSelected].infinite[this.currentLevelVarationSelected];DIVINESTAR.levelManager.activeLevel&&(DIVINESTAR.levelManager.activeLevel.createLevel({seed1:e.seed1,seed2:e.seed2,seed3:e.seed3,mode:"infinite",difficulity:e.difficulity,hardcore:e.hardcore}),DIVINESTAR.levelManager.inLevel=!0,DIVINESTAR.mainMenu.hideMenu(),DIVINESTAR.eventHooks.triggerHook("enter-level"))}saveLevelVaration(){let e=DIVINESTAR.screenCreator,t={difficulity:e.getRotateSelectValue("level-options","difficulty"),hardcore:e.getRotateSelectValue("level-options","hardcore"),seed3:e.getInputValue("level-options","seed3"),seed2:e.getInputValue("level-options","seed2"),seed1:e.getInputValue("level-options","seed1")};DIVINESTAR.profileManager.levelVarations[this.currentLevelSelected].infinite.push(t),DIVINESTAR.profileManager.saveLevelVarationData()}_createLevelCategoryScreen(){let e=DIVINESTAR.screenCreator,t=DIVINESTAR.languageManager;e.createScreen("main-menu",this.levelCategoryScreen),e.addTitle(this.levelCategoryScreen,"Level Categories","h1");let a={id:this.levelCategoryScreen,height:250,width:400,orientation:"vertical",collumns:3,rows:5,collumnWidth:300,rowHeight:100,populate:()=>{let t=[];return Object.keys(DIVINESTAR.levelManager.levelCategories).forEach(a=>{let i=DIVINESTAR.levelManager.levelCategories[a];DIVINESTAR.levelManager.getPreviewImagePath("void");let s={title:i.name,description:i.description,img:i.imagePath,value:i.id,imgWidth:200,imgHeight:100,func:()=>{this.currentLevelCategorySelected=i.id,e.enterScreen(this.levelSelectScreen),e.populateGridSelect(this.levelSelectScreen,this.levelSelectScreen)}};t.push(s)}),t}};e.addGridItemSelect(this.levelCategoryScreen,a),e.populateGridSelect(this.levelCategoryScreen,a.id),e.addOptionToScreen(this.levelCategoryScreen,{type:"button",name:"back",label:t.getText("menu-screen","back"),func:()=>{e.enterScreen("main")}})}_createLevelSelectScreen(){let e=DIVINESTAR.screenCreator,t=DIVINESTAR.languageManager;e.createScreen("main-menu",this.levelSelectScreen),e.addTitle(this.levelSelectScreen,"Level Select","h1");let a={id:"level-select",height:250,width:400,orientation:"vertical",collumns:3,rows:5,collumnWidth:300,rowHeight:100,populate:()=>{let t=[];return Object.keys(DIVINESTAR.levelManager.levelDescriptionData[this.currentLevelCategorySelected]).forEach(a=>{let i=DIVINESTAR.levelManager.levelDescriptionData[this.currentLevelCategorySelected][a],s={title:i.name,img:i.imagePath,description:i.description,value:i.name,imgWidth:200,imgHeight:100,func:()=>{this.currentLevelSelected=i.id,e.enterScreen(this.levelVarationSelectScreen),e.populateGridSelect(this.levelVarationSelectScreen,"level-varation-select")}};t.push(s)}),t}};e.addGridItemSelect(this.levelSelectScreen,a),e.populateGridSelect(this.levelSelectScreen,a.id),e.addOptionToScreen(this.levelSelectScreen,{type:"button",name:"back",label:t.getText("menu-screen","back"),func:()=>{e.enterScreen(this.levelCategoryScreen)}})}createLevelVarationDisplayScreen(){let e=DIVINESTAR.screenCreator,t=DIVINESTAR.languageManager;e.createScreen("main-menu",this.levelVarationDisplayScreen),e.addTitle(this.levelVarationDisplayScreen,"Level Data","h1");let a={blank:"blank"};e.addDataDisplay(this.levelVarationDisplayScreen,"level-varation-data",{type:"small",width:200,height:100,initialData:a,changeNames:!1}),e.addOptionToScreen(this.levelVarationDisplayScreen,{type:"button",name:"play",label:t.getText("menu-screen","play-level"),func:()=>{this.enterLevel()}}),e.addOptionToScreen(this.levelVarationDisplayScreen,{type:"button",name:"delete",label:t.getText("menu-screen","delete"),func:()=>{e.enterScreen(this.levelVarationDeleteScreen)}}),e.addOptionToScreen(this.levelVarationDisplayScreen,{type:"button",name:"back",label:t.getText("menu-screen","back"),func:()=>{e.enterScreen(this.levelVarationSelectScreen),e.populateGridSelect(this.levelVarationSelectScreen,"level-varation-select")}})}createConfirmDeleteSceen(){let e=DIVINESTAR.screenCreator,t=DIVINESTAR.languageManager;e.createScreen("main-menu",this.levelVarationDeleteScreen),e.addTitle(this.levelVarationDeleteScreen,"Delete Varation?","h1"),e.addOptionToScreen(this.levelVarationDeleteScreen,{type:"button",name:"delete-varation",label:t.getText("menu-screen","yes"),func:()=>{DIVINESTAR.profileManager.levelVarations[this.currentLevelSelected].infinite[this.currentLevelVarationSelected]=null,DIVINESTAR.profileManager.levelVarations[this.currentLevelSelected].infinite.splice(this.currentLevelVarationSelected,1),DIVINESTAR.profileManager.saveLevelVarationData(),e.populateGridSelect(this.levelVarationSelectScreen,"level-varation-select"),e.enterScreen(this.levelVarationSelectScreen),e.populateGridSelect(this.levelVarationSelectScreen,"level-varation-select")}}),e.addOptionToScreen(this.levelVarationDeleteScreen,{type:"button",name:"cancel-delete-varation",label:t.getText("menu-screen","no"),func:()=>{e.enterScreen(this.levelVarationSelectScreen),e.populateGridSelect(this.levelVarationSelectScreen,"level-varation-select")}})}createLevelVarationsScreen(){let e=DIVINESTAR.screenCreator,t=DIVINESTAR.languageManager;e.createScreen("main-menu",this.levelVarationSelectScreen),e.addTitle(this.levelVarationSelectScreen,"Level Varations","h1"),e.addOptionToScreen(this.levelVarationSelectScreen,{type:"button",name:"create-varation",label:t.getText("menu-screen","create-varation"),func:()=>{e.enterScreen("level-options")}});let a={id:"level-varation-select",orientation:"vertical",height:220,width:400,collumns:3,rows:5,collumnWidth:300,rowHeight:100,populate:()=>{let t=DIVINESTAR.levelManager.levelDescriptionData[this.currentLevelCategorySelected][this.currentLevelSelected].imagePath,a=[];return DIVINESTAR.profileManager.levelVarations["".concat(this.currentLevelCategorySelected,"-").concat(this.currentLevelSelected)].infinite.forEach((i,s)=>{let o={title:"".concat(s),img:t,value:s,imgWidth:200,imgHeight:100,func:()=>{this.currentLevelVarationSelected=s;let t=DIVINESTAR.profileManager.levelVarations["".concat(this.currentLevelCategorySelected,"-").concat(this.currentLevelSelected)].infinite[this.currentLevelVarationSelected];e.populateDataDisplay(this.levelVarationDisplayScreen,"level-varation-data",t),e.enterScreen(this.levelVarationDisplayScreen)}};a.push(o)}),a}};e.addGridItemSelect(this.levelVarationSelectScreen,a),e.addOptionToScreen(this.levelVarationSelectScreen,{type:"button",name:"back",label:t.getText("menu-screen","back"),func:()=>{e.enterScreen("level-select"),e.populateGridSelect(this.levelSelectScreen,"level-select")}})}createLevelOptionsScreen(){let e=DIVINESTAR.screenCreator,t=DIVINESTAR.languageManager;e.createScreen("main-menu","level-options"),e.addTitle("level-options","Level Options","h1"),e.addOptionToScreen("level-options",{type:"text-input",name:"seed1",label:t.getText("level-lingo","seed-1"),maxLength:20}),e.addOptionToScreen("level-options",{type:"text-input",name:"seed2",label:t.getText("level-lingo","seed-2"),maxLength:20}),e.addOptionToScreen("level-options",{type:"text-input",name:"seed3",label:t.getText("level-lingo","seed-3"),maxLength:20}),e.addOptionToScreen("level-options",{type:"rotate-select",name:"difficulty",label:t.getText("level-lingo","difficulity"),rotateSelectOptions:["novice","easy","medium","hard","extreme"]}),e.addOptionToScreen("level-options",{type:"rotate-select",name:"hardcore",label:t.getText("level-lingo","hard-core"),rotateSelectOptions:[t.getText("menu-screen","false"),t.getText("menu-screen","true")]}),e.addOptionToScreen("level-options",{type:"button",name:"create",label:t.getText("menu-screen","create"),func:()=>{this.saveLevelVaration(),e.enterScreen(this.levelVarationSelectScreen),e.populateGridSelect(this.levelVarationSelectScreen,"level-varation-select")}}),e.addOptionToScreen("level-options",{type:"button",name:"back",label:t.getText("menu-screen","back"),func:()=>{e.enterScreen(this.levelVarationSelectScreen),e.populateGridSelect(this.levelVarationSelectScreen,"level-varation-select")}})}constructor(){this.currentLevelSelected="",this.currentLevelCategorySelected="voids",this.currentLevelVarationSelected=0,this.levelCategoryScreen="level-category-screen",this.levelOptionsScreen="level-options",this.levelSelectScreen="level-select",this.levelSelectScreenTop=["level-select","level-select-top"],this.levelSelectScreenMiddle=["level-select","level-select-middle"],this.levelSelectScreenBottom=["level-select","level-select-bottom"],this.levelVarationSelectScreen="level-varation-select",this.levelVarationSelectScreenTop=[this.levelVarationSelectScreen,"level-varation-select-top"],this.levelVarationSelectScreenMiddle=[this.levelVarationSelectScreen,"level-varation-select-middle"],this.levelVarationSelectScreenBottom=[this.levelVarationSelectScreen,"level-varation-select-bottom"],this.levelVarationDisplayScreen="level-varation-display",this.levelVarationDisplayScreenTop=[this.levelVarationDisplayScreen,"level-varation-display-top"],this.levelVarationDisplayScreenMiddle=[this.levelVarationDisplayScreen,"level-varation-display-middle"],this.levelVarationDisplayScreenBottom=[this.levelVarationDisplayScreen,"level-varation-display-bottom"],this.levelVarationDeleteScreen="level-varation-delete",this.levelVarationDeleteScreenTop=[this.levelVarationDeleteScreen,"level-varation-delete-top"],this.levelVarationDeleteScreenMiddle=[this.levelVarationDeleteScreen,"level-varation-delete-middle"],this.levelVarationDeleteScreenBottom=[this.levelVarationDeleteScreen,"level-varation-delete-bottom"]}}class p{createMenu(){let e=DIVINESTAR.screenCreator;e.createScreen("main-menu","credits"),e.addTitle("credits","Credits","h1","hoist-up"),e.addSpacer("credits",40),e.addText("credits","Divine Star Presents The Long Walk Home. This game was produced by Divine Star which is soley own and operated by Lucas D. Johnson. All music, graphics, and code belong to Divine Star.",""),e.addTitle("credits","Programming","h2"),e.addCredit("credits","Lead Programmer","Lucas D. Johnson"),e.addTitle("credits","Music and Sound","h2"),e.addCredit("credits","Sound Designer","Tyler Quinn"),e.addCredit("credits","Music","Lucas D. Johnson"),e.addTitle("credits","Graphics And Art","h2"),e.addCredit("credits","Lead artist","Lucas D. Johnson"),e.addTitle("credits","Post Processing And Special Effects","h2"),e.addCredit("credits","Post Processing Effects","Haithem Chirane"),e.addCredit("credits","Special Materials","Haithem Chirane"),e.addSpacer("credits",50),e.addCopyRight("credits"),e.addOptionToScreen("credits",{type:"button",name:"back",label:"Back",func:()=>{e.enterScreen("main")}})}constructor(){}}class u{createMenu(){let e=DIVINESTAR.screenCreator;e.createScreen("main-menu","bugs"),e.addTitle("bugs","Known Bugs","h2"),e.addInfoBox("bugs",{title:"Objects Vanish",description:"Some game objects will vanish or be added on top of each other.",group:"bugs"}),e.addInfoBox("bugs",{title:"Checkpoints Overlap Other Objects",description:"Sometime checkpoints generate on top of other objects.",group:"bugs"}),e.addInfoBox("bugs",{title:"Level One Water Moves Off Screen",description:"The water in level one will occasionaly get messed up and move off screen.",group:"bugs"}),e.addSpacer("bugs",50),e.addOptionToScreen("bugs",{type:"button",name:"back",label:"Back",func:()=>{e.enterScreen("beta-tester")}})}constructor(){}}class S{createMenu(){let e=DIVINESTAR.screenCreator;e.createScreen("main-menu","features"),e.addTitle("features","Upcoming Features","h2"),e.addInfoBox("features",{title:"Point Pickups",description:"Point picksup will be added into the game. They will generate on the track. They will be used to buy cool things.",group:"features"}),e.addInfoBox("features",{title:"Level Augments",description:"Special items that change the generation of levels even more.",group:"features"}),e.addInfoBox("features",{title:"Stuff For Level One",description:"I plan to add rain and other effects to level one.",group:"features"}),e.addInfoBox("features",{title:"Story Mode",description:"There will eventually be a story mode.",group:"features"}),e.addInfoBox("features",{title:"Dash Recharge",description:"A little powerup that will allow you to dash as soon as you pick it up.",group:"features"}),e.addInfoBox("features",{title:"More Obstacles",description:"Ladders, stairs, ramps, different jumpads, monkey bars, and maybe even more.",group:"features"}),e.addInfoBox("features",{title:"More Powerups",description:"Gravity Switch, Grappiling Hook, Double Jump, High Jump, and possiably more.",group:"features"}),e.addInfoBox("features",{title:"More Levels and Structures",description:"Once I get everything figured out adding levels will be pretty easy.",group:"features"}),e.addInfoBox("features",{title:"Options Screen",description:"A fully fleshed out options screen.",group:"features"}),e.addInfoBox("features",{title:"Controller Controled Menu",description:"Soon you will be able to use the menu with a gamepad.",group:"features"}),e.addSpacer("features",50),e.addOptionToScreen("features",{type:"button",name:"back",label:"Back",func:()=>{e.enterScreen("beta-tester")}})}constructor(){}}class g{createMenu(){let e=DIVINESTAR.screenCreator;e.createScreen("main-menu","options"),e.addTitle("options","Options","h2"),e.addOptionToScreen("options",{type:"rotate-select",name:"test",label:"Test",rotateSelectOptions:["option1","option2","option3","option4","option5","option6"]}),e.addOptionToScreen("options",{type:"input-range",name:"test",label:"Test",max:5,min:0,value:0}),e.addSpacer("options",50),e.addOptionToScreen("options",{type:"button",name:"back",label:"Back",func:()=>{e.enterScreen("main")}})}constructor(){}}class m{createMenu(){let e=DIVINESTAR.screenCreator;e.createScreen("main-menu","how-to-play"),e.createSubScreen(this.screenTop[0],this.screenTop[1]),e.createSubScreen(this.infoScreen[0],this.infoScreen[1]),e.createSubScreen(this.screenBottom[0],this.screenBottom[1]),e.addSpacer("how-to-play",50),e.addTitle(this.screenTop,"How To Play","h1"),e.addTitle(this.infoScreen,"Controlls","h2"),e.addText(this.infoScreen,"You have full control over your jump. If you want to go farther hold down forward. If you want to stop just let go. The same goes for the dash move. If you want to stop just release the dash button."),e.addTitle(this.infoScreen,"XBox Controller/GamePad","h3"),e.addCredit(this.infoScreen,"A","Jump"),e.addCredit(this.infoScreen,"X","Dash"),e.addCredit(this.infoScreen,"D-Pad Up","Run"),e.addTitle(this.infoScreen,"KeyBoard","h3"),e.addCredit(this.infoScreen,"Space","Jump"),e.addCredit(this.infoScreen,"Shift | A","Dash"),e.addCredit(this.infoScreen,"W","Run"),e.addTitle(this.infoScreen,"Moves","h2"),e.addTitle(this.infoScreen,"Dash","h3"),e.addText(this.infoScreen,"The player jets forward very quickly. If done on repeat you can basically fly."),e.addTitle(this.infoScreen,"CheckPoints","h2"),e.addImage(this.infoScreen,"assets/objects/checkpoint/texture_1.png"),e.addText(this.infoScreen,"If you touch a checkpoint when you fall off a platform you will reset there."),e.addTitle(this.infoScreen,"Powerups","h2"),e.addTitle(this.infoScreen,"Dash Power Up","h3"),e.addImage(this.infoScreen,"assets/objects/dash/texture_1.png"),e.addText(this.infoScreen,"The dash power up will for a peroid of time allow the player to dash continuously."),e.addTitle(this.infoScreen,"Collectables","h2"),e.addTitle(this.infoScreen,"Point Orb","h3"),e.addImage(this.infoScreen,"assets/objects/pointorb/texture_1.png"),e.addText(this.infoScreen,"They currently have no use. But you will find these scattered around. They will be used for cool things in the future."),e.addTitle(this.infoScreen,"Game Objects","h2"),e.addTitle(this.infoScreen,"Jump Pad","h3"),e.addImage(this.infoScreen,"assets/objects/jumppad/texture_1.png"),e.addText(this.infoScreen,"If you come in contact with a jumppad you will be shot up into the air."),e.addSpacer(this.infoScreen,50),e.addOptionToScreen(this.screenBottom,{type:"button",name:"back",label:"Back",func:()=>{e.enterScreen("main")}})}constructor(){this.infoScreen=["how-to-play","htp-info"],this.screenTop=["how-to-play","htp-top"],this.screenBottom=["how-to-play","htp-bottom"]}}class v{activateProfile(e){console.log("activate profile"),console.log(e);let t=document.getElementsByClassName("profile-card-container"),a=t.length;for(;a--;){let i=t[a],s=i.dataset.id;console.log(s),s==e?(this.currentlySelectedProfile=e,i.classList.add("profile-selected")):i.classList.remove("profile-selected")}}createMenu(){let e=DIVINESTAR.screenCreator,t=DIVINESTAR.languageManager;e.createScreen("main-menu","user-profile-select"),e.addTitle(this.profileScreen,"Select Profile","h1"),e.addOptionToScreen(this.profileScreen,{type:"button",name:"create-profile",label:t.getText("menu-screen","create-profile"),func:()=>{e.enterScreen(this.profileCreateScreen),e.populateGridSelect(this.profileCreateScreen,this.profileIconGridID)}});let a={id:"user-profile-select",height:200,orientation:"horizontal",width:400,collumns:4,rows:4,collumnWidth:300,rowHeight:50,populate:()=>{let e=[];return DIVINESTAR.profileManager.profiles.forEach(t=>{let a=DIVINESTAR.profileManager.getIconUrl(t.profileIconId),i={title:t.name,img:a,imgWidth:60,imgHeight:60,value:t.id};e.push(i)}),e}};e.addGridItemSelect(this.profileScreen,a),e.populateGridSelect(this.profileScreen,a.id),e.addOptionToScreen(this.profileScreen,{type:"button",name:"select-profile",label:t.getText("menu-screen","select-profile"),func:()=>{let t=e.getGridSelectValue("user-profile-select","user-profile-select");""!==t&&(DIVINESTAR.profileManager.setActiveProfile(t),e.enterScreen("main"))}}),this.createProfileCreateMenu()}createProfileCreateMenu(){let e=DIVINESTAR.screenCreator,t=DIVINESTAR.languageManager;e.createScreen("main-menu",this.profileCreateScreen),e.addTitle(this.profileCreateScreen,"Create Profile","h1"),e.addOptionToScreen(this.profileCreateScreen,{type:"text-input",name:"profile-name",label:t.getText("menu-screen","name"),maxLength:20}),e.addTitle(this.profileCreateScreen,"Select Icon","h3");let a={id:"user-profile-icon-select",height:100,width:200,orientation:"horizontal",collumns:8,rows:8,collumnWidth:100,rowHeight:22,populate:()=>{let e=[];return DIVINESTAR.profileManager.iconPaths.forEach((t,a)=>{let i={img:t,imgWidth:60,imgHeight:60,value:a};e.push(i)}),e}};e.addGridItemSelect(this.profileCreateScreen,a),e.addOptionToScreen(this.profileCreateScreen,{type:"button",name:"create-profile",label:t.getText("menu-screen","create"),func:()=>{let t=e.getInputValue(this.profileCreateScreenBottom[0],"profile-name"),i=e.getGridSelectValue(this.profileCreateScreenBottom[0],a.id);if(""!==t&&""!==i){let a={name:t,icon:i};DIVINESTAR.profileManager.createProfile(a),e.enterScreen(this.profileScreen),e.populateGridSelect(this.profileScreen,"user-profile-select")}}}),e.addOptionToScreen(this.profileCreateScreen,{type:"button",name:"back",label:t.getText("menu-screen","back"),func:()=>{e.enterScreen(this.profileScreen),e.populateGridSelect(this.profileScreen,"user-profile-select")}})}constructor(){this.profileSelectScreenTop=["user-profile-select","user-profile-select-top"],this.profileSelectScreenBottom=["user-profile-select","user-profile-select-bottom"],this.profileSelectScreenCards=["user-profile-select","user-profile-cards"],this.userProfilesGridID="user-profile-select",this.profileIconGridID="user-profile-icon-select",this.profileScreen="user-profile-select",this.profileCreateScreen="user-profile-create",this.profileCreateScreenTop=["user-profile-create","user-profile-create-top"],this.profileCreateScreenMiddle=["user-profile-create","user-profile-create-middle"],this.profileCreateScreenBottom=["user-profile-create","user-profile-create-bottom"]}}class y{createMenu(){let e=DIVINESTAR.screenCreator,t=DIVINESTAR.languageManager;e.createScreenContainer("main-menu"),e.createScreen("main-menu","main"),e.addTitle("main","Divine Star Presents","h2","hoist-up"),e.addTitle("main","Infinite Realm Runner","h1","main-title"),e.addTitle("main","Alpha .2","h3","hoist-down"),e.addSpacer("main",5),e.addOptionToScreen("main",{type:"button",name:"play-game",label:t.getText("menu-screen","play-game"),func:()=>{e.enterScreen("level-category-screen"),e.populateGridSelect("level-category-screen","level-category-screen")}}),e.addOptionToScreen("main",{type:"button",name:"change-profile",label:t.getText("menu-screen","change-profile"),func:()=>{e.enterScreen("user-profile-select")}}),e.addOptionToScreen("main",{type:"button",name:"how-to-play",label:t.getText("menu-screen","how-to-play"),func:()=>{e.enterScreen("how-to-play")}}),e.addOptionToScreen("main",{type:"button",name:"options",label:t.getText("menu-screen","options"),func:()=>{DIVINESTAR.optionsMenu.showMenu()}}),e.addOptionToScreen("main",{type:"button",name:"credits",label:t.getText("menu-screen","credits"),func:()=>{e.enterScreen("credits")}}),e.addOptionToScreen("main",{type:"button",name:"for-beta-testers",label:t.getText("menu-screen","for-beta-testers"),func:()=>{e.enterScreen("beta-tester")}}),e.addOptionToScreen("main",{type:"button",name:"exit-game",label:t.getText("menu-screen","exit-game"),func:()=>{DIVINESTAR.eventHooks.triggerHook("program-exit")}}),e.createScreen("main-menu","beta-tester"),e.addTitle("beta-tester","For Beta Testers","h1"),e.addOptionToScreen("beta-tester",{type:"button",name:"upcoming-features",label:"Upcoming Features",func:()=>{e.enterScreen("features")}}),e.addOptionToScreen("beta-tester",{type:"button",name:"known-bugs",label:"Known Bugs",func:()=>{e.enterScreen("bugs")}}),e.addOptionToScreen("beta-tester",{type:"button",name:"back",label:t.getText("menu-screen","back"),func:()=>{e.enterScreen("main")}}),e.addSpacer("main",50),this.userProfileScreen.createMenu(),this.levelSelect.createMenu(),e.enterScreen("user-profile-select")}hideMenu(){DIVINESTAR.screenCreator.hideScreenContrainer("main")}showMenu(){}constructor(){this.levelSelect=new d,this.creditsScreen=new p,this.bugsScreen=new u,this.featuresScreen=new S,this.howToPlayScreen=new m,this.optionsScreen=new g,this.userProfileScreen=new v,this.screens={},this.subScreens={},this.mainOptions={},this.screenOptions={},this.infoBoxGroups={},this.inputs={}}}class f{createMenu(){let e=DIVINESTAR.screenCreator;e.createScreenContainer(this.screenContainer),e.createScreen(this.screenContainer,this.mainScreen),e.createSubScreen(this.mainScreen,this.mainScreenTop[1]),e.createSubScreen(this.mainScreen,this.mainScreenMiddle[1]),e.createSubScreen(this.mainScreen,this.mainScreenBottom[1]),e.addTitle(this.mainScreenTop,"Options","h1"),e.addOptionToScreen(this.mainScreenMiddle,{type:"button",name:"sound-options",label:"Sound",func:()=>{e.enterScreen(this.soundScreen)}}),e.addOptionToScreen(this.mainScreenMiddle,{type:"button",name:"video-options",label:"Video",func:()=>{e.enterScreen(this.videoScreen)}}),e.addOptionToScreen(this.mainScreenBottom,{type:"button",name:"back",label:"Back",func:()=>{DIVINESTAR.paused?DIVINESTAR.pauseMenu.showMenu():DIVINESTAR.mainMenu.showMenu()}}),this._createSoundScreen(),this._createVideoScreen()}_createSoundScreen(){let e=DIVINESTAR.screenCreator;e.createScreen(this.screenContainer,this.soundScreen),e.createSubScreen(this.soundScreen,this.soundScreenTop[1]),e.createSubScreen(this.soundScreen,this.soundScreenMiddle[1]),e.createSubScreen(this.soundScreen,this.soundScreenBottom[1]),e.addTitle(this.soundScreenTop,"Sound","h1")}_createVideoScreen(){let e=DIVINESTAR.screenCreator;e.createScreen(this.screenContainer,this.videoScreen),e.createSubScreen(this.videoScreen,this.vidoScreenTop[1]),e.createSubScreen(this.videoScreen,this.videoScreenMiddle[1]),e.createSubScreen(this.videoScreen,this.videoScreenBottom[1]),e.addTitle(this.vidoScreenTop,"Video","h1")}hideMenu(){DIVINESTAR.screenCreator.hideScreenContrainer(this.screenContainer)}showMenu(){let e=DIVINESTAR.screenCreator;e.showScreenContrainer(this.screenContainer),e.enterScreen(this.mainScreen)}constructor(){this.screenContainer="options-menu-container",this.mainScreen="options-menu",this.mainScreenTop=[this.mainScreen,"options-menu-top"],this.mainScreenMiddle=[this.mainScreen,"options-menu-Middle"],this.mainScreenBottom=[this.mainScreen,"options-menu-Bottom"],this.soundScreen="sound-options-menu",this.soundScreenTop=[this.soundScreen,"sound-options-menu-top"],this.soundScreenMiddle=[this.soundScreen,"sound-options-menu-Middle"],this.soundScreenBottom=[this.soundScreen,"sound-options-menu-Bottom"],this.videoScreen="video-options-menu",this.vidoScreenTop=[this.videoScreen,"video-options-menu-top"],this.videoScreenMiddle=[this.videoScreen,"video-options-menu-Middle"],this.videoScreenBottom=[this.videoScreen,"video-options-menu-Bottom"]}}class I{update(){if(this.intervalCount--,0==this.intervalCount&&(this.intervalCount=this.maxInterval),this.mainIntervalHooks[this.intervalCount]){let e=this.mainIntervalHooks[this.intervalCount].length;for(;e--;){let t=this.mainIntervalHooks[this.intervalCount][e];this._checkVars(t),this._setVars(t)}}let e=this.customIntervalHooksCount;for(;e--;){let t=this.customIntervalHooks[e];t.customIntervalCount--,0==t.customIntervalCount&&(this.triggerVarChangeHook(t.id),t.customIntervalCount=t.customInterval,this._checkVars(t.id),this._setVars(t.id))}let t=this.timeHooksCount;for(;t--;){let e=this.timeHookIds[t],a=this.timedHooks[e];a.intervalCount--,0==a.intervalCount&&(a.intervalCount=a.interval,this.triggerTimeHook(a.id))}}registerHook(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.hooks[e]={id:e,hasParams:t,funcs:[]}}registerCustomHook(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.customHooks[e]={id:e,hasParams:t,funcs:[]}}_setVars(e){let t=this.varChangeHooks[e].type,a=this.varChangeHooks[e].varID;if("array"==t){var i;if(!this.varChangeHooks[e].indexes)return;let t=null===(i=this.varChangeHooks[e].indexes)||void 0===i?void 0:i.length;for(;t--;){let i=this.varChangeHooks[e].indexes[t];this.cachedWatchVars[e][i]=this.watchVars[a][i]}}}_checkVars(e){let t=this.varChangeHooks[e].type,a=this.varChangeHooks[e].varID;if("array"==t){var i;if(!this.varChangeHooks[e].indexes)return;let t=null===(i=this.varChangeHooks[e].indexes)||void 0===i?void 0:i.length;for(;t--;){let i=this.varChangeHooks[e].indexes[t];if(this.cachedWatchVars[e][i]!=this.watchVars[a][i]){this.triggerVarChangeHook(e);break}}}}registerVarChangeHook(e,t,a){let i=this.watchVars.length;if(this.watchVars.push(t),this.varChangeHooks[e]={id:e,varID:i,type:a.type,funcs:[]},a.mainIntervalBound){if(!a.interval)return;this.mainIntervalHooks[a.interval]||(this.mainIntervalHooks[a.interval]=[]),this.mainIntervalHooks[a.interval].push(e)}if(a.customIntervalBound){if(!a.customInterval)return;this.varChangeHooks[e].customIntervalCount=a.customInterval,this.varChangeHooks[e].customInterval=a.customInterval,this.customIntervalHooksCount++,this.customIntervalHooks.push(this.varChangeHooks[e])}if("array"==a.type){var s;if(!a.indexes)return;let i=null===(s=a.indexes)||void 0===s?void 0:s.length;for(;i--;){let s=a.indexes[i];this.cachedWatchVars[e]||(this.cachedWatchVars[e]=[]),this.cachedWatchVars[e][s]=t[s]}this.varChangeHooks[e].indexes=a.indexes}this.varIdHooks[i]=e}triggerHook(e,t){let a=this.hooks[e];a.funcs.forEach(e=>{a.hasParams?e(t):e()})}triggerCustomHook(e,t){let a=this.customHooks[e];a.funcs.forEach(e=>{a.hasParams?e(t):e()})}triggerVarChangeHook(e){this.varChangeHooks[e].funcs.forEach(e=>{e()})}addToVarChangeHook(e,t){this.varChangeHooks[e].funcs.push(t)}addToHook(e,t){this.hooks[e].funcs.push(t)}addToCustomHook(e,t){this.customHooks[e].funcs.push(t)}triggerTimeHook(e){this.timedHooks[e].funcs.forEach(e=>{e()})}addToTimeHook(e,t){this.timedHooks[e].funcs.push(t)}addTimeHook(e,t){this.timeHookIds[this.timeHooksCount]=e,this.timeHooksCount++,this.timedHooks[e]={id:e,interval:t,intervalCount:t,funcs:[]}}constructor(){this.hooks={},this.customHooks={},this.varChangeHooks={},this.timeHooksCount=0,this.timedHooks={},this.timeHookIds={},this.mainIntervalHooks={},this.customIntervalHooks=[],this.customIntervalHooksCount=0,this.varIdHooks=[],this.watchVars=[],this.maxInterval=250,this.intervalCount=this.maxInterval,this.cachedWatchVars={}}}var D,P=a(29723);class b{sendObjectUpdate(e){if("door"==e.data.objectdata.type){let t=this.usedParticles[e.data.objectdata.id];switch(e.data.objectdata.side){case"left":DIVINESTAR.animationHelper.addAnimationPropertyDown(t,["rotation","z"],DIVINESTAR.degtoRad(90),DIVINESTAR.degtoRad(90),DIVINESTAR.degtoRad(2),1);break;case"right":DIVINESTAR.animationHelper.addAnimationPropertyUp(t,["rotation","z"],DIVINESTAR.degtoRad(-90),DIVINESTAR.degtoRad(-90),DIVINESTAR.degtoRad(2),1)}}}_getDefaultsVars(){return JSON.parse(JSON.stringify(this.defaultsVars))}init(){if(!DIVINESTAR.scene)return;let e=this;this.SPS=new P.Jyq("Physics",DIVINESTAR.scene,{useModelMaterial:!0,expandable:!0}),this.SPS.initParticles=()=>{for(let t=0;t<e.SPS.nbParticles;t++){let a=e.SPS.particles[t];a.position.z=-1e3,a.alive=!1,e.particles[a.shapeId].modelName.includes("dash")&&(a.scaling.x=.75,a.scaling.y=.75,a.scaling.z=.75),e.particles[a.shapeId].modelName.includes("point")&&(a.scaling.x=.4,a.scaling.y=.4,a.scaling.z=.4)}this.usedParticles={}},this.SPS.counter=0,this.SPS.vars=this._getDefaultsVars(),this.SPS.updateParticle=t=>{e.objects[t.shapeId].modelid.includes("dash")&&(t.rotation.z+=.05,t.position.y=t.position.y+.008*Math.sin(e.SPS.vars.animTime/25)),e.objects[t.shapeId].modelid.includes("jump")&&(t.rotation.z+=.08,t.position.y=t.position.y+.01*Math.sin(e.SPS.vars.animTime/25)),e.objects[t.shapeId].modelid.includes("point")&&(t.rotation.z+=.08,t.position.y=t.position.y+.01*Math.sin(e.SPS.vars.animTime/25)),e.SPS.counter++,e.SPS.vars.needCull&&(t.position.z<DIVINESTAR.playerABSPosition.z||t.position.z>DIVINESTAR.playerABSPosition.z+512)&&(t.position.z=-1e3,t.alive=!1);e:if(e.SPS.vars.needUpdate){if(t.position.z>DIVINESTAR.playerABSPosition.z&&t.position.z<DIVINESTAR.playerABSPosition.z+512)break e;let a=this.objects[t.shapeId].modelid;if(e.SPS.vars.updateData[a]&&e.SPS.vars.updateDataCounts[a].current<e.SPS.vars.updateDataCounts[a].max){let i=e.SPS.vars.updateData[a][e.SPS.vars.updateDataCounts[a].current],s=i.id;if(e.removedParticles[s]||e.usedParticles[s])break e;(null==i?void 0:i.scaling)&&(t.scaling={...i.scaling}),t.position.x=i.position.x,t.position.y=i.position.y,t.position.z=i.position.z,t.rotation.x=i.rotation.x,t.rotation.y=i.rotation.y,t.rotation.z=i.rotation.z,t.alive=!0,e.usedParticles[i.id]=t,e.SPS.vars.updateDataCounts[a].current++}}return e.SPS.counter>=e.SPS.nbParticles&&(e.SPS.vars.needCull=!1,e.SPS.vars.needUpdate=!1,e.SPS.counter=0,e.SPS.vars.updateData={},e.SPS.vars.updateDataCounts={},e.SPS.vars.animTime++),t}}buildSPS(){this.SPS.initParticles(),this.mesh=this.SPS.buildMesh(),this.mesh.renderingGroupId=1,this.SPS.isAlwaysVisible=!0,this.SPS.setParticles()}async resetAll(){return this.SPS.initParticles(),!0}addGameObject(e,t,a){let i=this.particleCount,s=i+a;this.objects[this.objectCount]={id:this.objectCount,modelid:e,counter:0,max:a,particleRange:[i,s]},this.particles[this.objectCount]={modelName:e},this.SPS.addShape(t,a),this.objectCount++,this.particleCount+=a}resetParticle(e){console.log(this.usedParticles[e]),this.usedParticles[e].position.z=-1e3,this.usedParticles[e].isVisible=!1,this.removedParticles[e]=!0,this.set()}setUpdate(e,t){for(let e in t)this.SPS.vars.updateDataCounts[e]={current:0,max:t[e].length};this.SPS.vars.needUpdate=!0,this.SPS.vars.updateData=t}cullParticles(){this.SPS.vars.needCull=!0}setAndBuild(){return this.SPS.setParticles(),this.SPS.refreshVisibleSize(),this.mesh.renderingGroupId=1,this.mesh}set(){this.SPS.setParticles(),this.SPS.refreshVisibleSize()}update(){this.SPS.setParticles()}fullReset(){this.particleCount=0,this.objectCount=0,this.objects={},this.usedParticles={},this.removedParticles={},this.particles={},this.SPS.dispose(),this.SPS=null}constructor(){this.objects={},this.particles={},this.objectCount=0,this.usedParticles={},this.removedParticles={},this.particleCount=0,this.defaultsVars={x:0,needUpdate:!1,positionData:!1,positionDataLength:0,particleCount:1,animDuration:10,animCount:50,needCull:!1,needResset:!1,updateData:{},updateDataCounts:{},animTime:0}}}var T=a(47079),w=a(39019),A=a(71579);class E{updateWater(){if(this.waterMesh.position.z<this.waterMesh2.position.z){this.waterMesh.position.z=this.waterMesh2.position.z+599.5,this.waterWaves.position.z=this.waterWaves2.position.z+599.5;return}if(this.waterMesh.position.z>this.waterMesh2.position.z){this.waterMesh2.position.z=this.waterMesh.position.z+599.5,this.waterWaves2.position.z=this.waterWaves.position.z+599.5;return}}setCheckPoint(){this.snapShot={waterWaves:this.waterWaves.position,waterMesh:this.waterMesh.position,waterWaves2:this.waterWaves2.position,waterMesh2:this.waterMesh2.position}}resetWater(){this.waterWaves.position=this.snapShot.waterWaves,this.waterMesh.position=this.snapShot.waterMesh,this.waterWaves2.position=this.snapShot.waterWaves2,this.waterMesh2.position=this.snapShot.waterMesh2}async createWater(){let e=this.newWaterMaterial(),t=e.water,a=e.waterMesh,i=e.reflectionProbe,s=e.waterWaves,o=e.waterWaves2;i.renderList.push(DIVINESTAR.assetsManager.skyBox),t.addToRenderList(DIVINESTAR.assetsManager.skyBox),a.renderingGroupId=1,a.material=t,a.position.y=-3,s.position.z=0,a.position.z=0;let n=a.createInstance("water2");n.position.z=599.5,o.position.z=599.5,a.receiveShadows=!0,Object.keys(DIVINESTAR.assetsManager.ManagedSPS).forEach(e=>{let a=DIVINESTAR.assetsManager.ManagedSPS[e];t.addToRenderList(a.setAndBuild()),a.mesh.receiveShadows=!0,a.mesh.material.receiveShadows=!0,s.receiveShadows=!0}),this.waterWaves=s,this.waterMesh=a,this.waterWaves2=o,this.waterMesh2=n,this.water=t,this.probe=i,this.setCheckPoint()}newWaterMaterial(){let e=(0,P.pTP)("plane",{width:800,height:600});e.position.y=-3,e.renderingGroupId=1,e.rotation.x=DIVINESTAR.degtoRad(90);var t=new A.Hv("water",DIVINESTAR.scene,new P.FM8(512,512));t.backFaceCulling=!0,t.bumpTexture=new P.xEZ("".concat(DIVINESTAR.fileHandler.basePath,"/assets/water/bumpnew.png"),DIVINESTAR.scene),t.windForce=-5,t.waveHeight=0,t.bumpHeight=.15,t.windDirection=new P.FM8(1,1),t.waterColor=new P.Wot(22/255,37/255,67/255),t.colorBlendFactor=.8,t.reflectionTexture._wrapU=1,t.reflectionTexture._wrapV=1,t.reflectionTexture._wrapR=1,t.reflectionTexture.pre=!1,t.reflectionTexture._prefiltered=!1,t.reflectionTexture.invertZ=!1,t.reflectionTexture._cachedUOffset=-1,t.reflectionTexture._cachedVOffset=-1,t.fogEnabled=!0,e.material=t,new P.xEZ("".concat(DIVINESTAR.fileHandler.basePath,"/assets/water/bumpnew.png"),DIVINESTAR.scene)._texture=t.reflectionTexture;var a=(0,P.$6X)("waterWaves",{width:800,height:600,subdivisions:1e3,updatable:!0},DIVINESTAR.scene),i=(0,P.$6X)("waterWaves",{width:800,height:600,subdivisions:1e3,updatable:!0},DIVINESTAR.scene);a.position.y=-3,a.renderingGroupId=1,i.position.y=-3,i.renderingGroupId=1;var s=new P.xNJ("main",512,DIVINESTAR.scene);return s.refreshRate=P._iX.REFRESHRATE_RENDER_ONEVERYFRAME,DIVINESTAR.scene.customRenderTargets.push(s.cubeTexture),s.attachToMesh(a),P.Oie.ParseFromFileAsync("waterMaterial","".concat(DIVINESTAR.fileHandler.basePath,"/private/shaders/water-new.json"),DIVINESTAR.scene).then(e=>{e.name="waterMaterial",e.needDepthPrePass=!0,e.getBlockByName("causticMode").value=1,e.getBlockByName("Reflection texture").texture=t._reflectionRTT,e.getBlockByName("Probe texture").texture=s.cubeTexture,e.getBlockByName("waterDetails").texture=new P.xEZ("".concat(DIVINESTAR.fileHandler.basePath,"/assets/water/bumpnew.png"),DIVINESTAR.scene),e.getBlockByName("VeronoiScale"),e.getBlockByName("Water Color").value={r:40/255,g:40/255,b:47/255},e.getBlockByName("FoamColor").value={r:20/255,g:20/255,b:25/255},e.getBlockByName("FoamLevel").value=10,e.getBlockByName("verenoiHeight").value=.14,e.getBlockByName("fogColor").value={r:.3,g:.3,b:.3},a.material=e,i.material=e}).fogEnabled=!0,a.fogEnabled=!0,a.hasAlpha=!0,i.fogEnabled=!0,i.hasAlpha=!0,e.getVerticesData(P.oZy.PositionKind),a.getVerticesData(P.oZy.PositionKind),DIVINESTAR.scene.registerBeforeRender(function(){t.reflectionTexture._prefiltered=!0}),{water:t,waterWaves:a,waterWaves2:i,waterMesh:e,reflectionProbe:s}}update(){}constructor(){this.snapShot={}}}class V{constructor(){}}class M{setCheckPoint(){this.snapShot={mtn1:this.mtn1.position,mtn2:this.mtn2.position,mtn3:this.mtn3.position,mtn4:this.mtn4.position}}resetMountains(){this.mtn1.position=this.snapShot.mtn1,this.mtn2.position=this.snapShot.mtn2,this.mtn3.position=this.snapShot.mtn3,this.mtn4.position=this.snapShot.mtn4}updateMountains(){console.log("%c time to update mtns","font-size:35px; color:red");let e=DIVINESTAR.playerZoneArrayBufferView[0];this.mtn1.position.z<this.mtn3.position.z?(this.mtn1.position.z=e+this.mtnLength,this.mtn2.position.z=e+this.mtnLength):(this.mtn3.position.z=e+this.mtnLength,this.mtn4.position.z=e+this.mtnLength)}initMontains(e){this.mtn1=DIVINESTAR.assetsManager.environmentModels["1-mtns"],this.mtn1.position.z=this.mtnLength,this.mtn1.position.y=-20,this.mtn1.position.x=220,this.mtn1.scaling.x=60,this.mtn1.scaling.y=50,this.mtn1.scaling.z=25,this.mtn1.renderingGroupId=1,this.mtn2=this.mtn1.createInstance("mtn2"),this.mtn2.position.x=-220,this.mtn2.rotation.y=DIVINESTAR.degtoRad(180),this.mtn3=this.mtn1.createInstance("mtn3"),this.mtn3.rotation.y=DIVINESTAR.degtoRad(180),this.mtn3.position.z=-this.mtnLength,this.mtn4=this.mtn1.createInstance("mtn3"),this.mtn4.position.x=-220,this.mtn4.rotation.y=DIVINESTAR.degtoRad(180),this.mtn4.position.z=-this.mtnLength;let t=e.water;t.addToRenderList(this.mtn1),t.addToRenderList(this.mtn2),t.addToRenderList(this.mtn3),t.addToRenderList(this.mtn4);let a=e.probe;a.renderList.push(this.mtn1),a.renderList.push(this.mtn2),a.renderList.push(this.mtn3),a.renderList.push(this.mtn4),this.setCheckPoint()}constructor(){this.mtnLength=1500}}class R{update(){this.oldZone=this.newZone,this.newZone=DIVINESTAR.playerABSPosition.z>>9,this.oldZone,this.newZone}async init(){await Promise.all([this._createLights(),this.water.createWater()]),this.mountains.initMontains(this.water),this._addHooks()}_addHooks(){let e=this;DIVINESTAR.eventHooks.addToVarChangeHook("player-512-zone-change",()=>{e.water.updateWater()}),DIVINESTAR.eventHooks.addToVarChangeHook("player-2056-zone-change",()=>{e.mountains.updateMountains()}),DIVINESTAR.eventHooks.addToHook("set-checkpoint",()=>{e.water.setCheckPoint(),e.mountains.setCheckPoint()}),DIVINESTAR.eventHooks.addToHook("reset-after",t=>{e.water.resetWater(),e.mountains.resetMountains()})}async _createLights(){var e=new P.Ox3("DirectionalLight",new P.Pa4(0,-1,1),DIVINESTAR.scene);e.diffuse=new P.Wot(.6,.8,.8),e.specular=new P.Wot(0,1,0),e.intensity=1.5,DIVINESTAR.mainLight=e}async _start(){await DIVINESTAR.levelConstructor.buildLevel("level1-infinite","level1"),await this.init(),DIVINESTAR.levelDataGenerator.generateLevelSectionFromWorker(),await DIVINESTAR.startLevel(),DIVINESTAR.rendering=!0}async _setUpLevelDataGenerator(e){await DIVINESTAR.levelDataGenerator.loadLevelDataIntoWorker("level1-infinite",e)}async createLevel(e,t){await this._setUpLevelDataGenerator(t),await this.createScene(e)}async createScene(e){e.useRightHandedSystem=!0,e.useGeometryIdsMap=!0;var t=P.ywH.HighDegradationAllowed();t.addOptimization(new P.frz(0,1)),new P.GY9(e,t),e.clearCachedVertexData(),e.cleanCachedTextureBuffer(),DIVINESTAR.setScene(e);var a=new P.cMO("glow",e,{mainTextureFixedSize:1024,blurKernelSize:128});a.intensity=0;let i=()=>{DIVINESTAR.animationHelper.addAnimationPropertyUp(a,["intensity"],2,2,.1,5,s)},s=()=>{DIVINESTAR.animationHelper.addAnimationPropertyDown(a,["intensity"],.25,.25,.1,5,i)};return DIVINESTAR.glow=a,DIVINESTAR.lightsManager.createLights(),await this._start(),P.voY.IDBStorageEnabled=!0,DIVINESTAR.imageProcessing.createImagePostProcessor(),DIVINESTAR.imageProcessing.createFog(),e.onBeforeAnimationsObservable.add(()=>{DIVINESTAR.update()}),e}_updateMountains(){}async reset(e){console.log("%c triggered level one reset","font-size:35px; color:cyan")}constructor(){this.levelId="level1",this.water=new E,this.rain=new V,this.mountains=new M}}class x{getPreviewImagePath(e){return"./assets/screens/level-preview/".concat(e,".png")}async loadLevelData(){let e=await DIVINESTAR.fileHandler.getDataAsStringAsync("/data/globalleveldata.json");this.levelData=JSON.parse(e)}setActiveLevel(e,t){this.activeLevel=new this.levelReference[t][e]}registerLevelObject(e,t,a){if(this.levelReference[a][t])throw Error("The level ".concat(t," you are tyring to create already exist."));this.levelReference[a][t]=e}registerLevel(e,t,a,i,s){if(void 0==this.levelReference[i])throw Error("The level ".concat(i," you are tyring to add a level too does not exist."));if(void 0!==this.levelReference[i][t])throw Error("The level ".concat(t," you are tyring to create already exist."));this.levelDescriptionData[i][t]={id:t,name:a,description:s,imagePath:"./mods/".concat(e,"/levels/images/levels/").concat(i,"-").concat(t,".PNG")}}unSetLevel(){this.activeLevel=null,this.inLevel=!1}registerLevelCategory(e,t,a,i){if(this.levelCategories[t])throw Error("The level category ".concat(t," you are tyring to create already exist."));this.levelCategories[a]={id:t,name:a,description:i,imagePath:"./mods/".concat(e,"/levels/images/categories/").concat(t,".PNG")},this.levelDescriptionData[t]={},this.levelReference[t]={}}update(){}init(){}reset(e){}constructor(){this.levelReference={},this.levelCategories={},this.levelDescriptionData={},this.inLevel=!1,this.levelReference.default={},this.levelReference.default["1"]=R}}class k{closeWorker(){this.worker.terminate()}onResponseFromWorker(e){let t=DIVINESTAR.levelDataGenerator,a=e.data[0].completed,i=e.data[0].data;if("load-level-data"==a&&(t.resolveLoadLevelDataPromise=!0),"get-levelsection-data"==a){let a=e.data[0].requestID;t.resolveFetchDataPromise[a]=!0,t.returnedLevelSectionData||(t.returnedLevelSectionData=[]),t.returnedLevelSectionData[i.zone]=i}}getLevelSectionFronWorker(e){let t=this;return new Promise(function(a,i){let s=e=>{t.resolveFetchDataPromise[e]?a(!0):setTimeout(()=>{s(e)},1)},o=DIVINESTAR.unqiueId();t.resolveFetchDataPromise[o]=!1,t.worker.postMessage({action:"get-levelsection-data",data:{zone:e,requestID:o}}),s(o)})}generateLevelSectionFromWorker(){this.worker.postMessage({action:"generate-level-section"})}loadLevelDataIntoWorker(e,t){let a=this;return a.resolveLoadLevelDataPromise=!1,new Promise(function(i,s){let o=()=>{a.resolveLoadLevelDataPromise?i(!0):setTimeout(()=>{o()},1)};o(),a.worker.postMessage({action:"load-level-data",data:{levelId:e,levelData:t}})})}sendMessagetoRenderWorker(){this.worker.postMessage({action:"update-render-worker"})}async syncData(e){return this.returnedLevelSectionData[e]||await this.getLevelSectionFronWorker(e),this.returnedLevelSectionData[e]}constructor(){this.currentPosition={x:0,y:0,z:0},this.resolveFetchDataPromise={},this.resolveLoadLevelDataPromise=!1,this.returnedLevelSectionData={},this.worker=new Worker(a.tu(new URL(a.p+a.u(1125),a.b)),{type:void 0}),this.worker.onmessage=this.onResponseFromWorker,this.worker.onerror=e=>{console.log("error happened!!!!!!")}}}class N{createLights(){}positionLight(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("spot"==e){let e;if(this.aviableLights.spot.forEach(t=>{if(t.position.z<DIVINESTAR.playerABSPosition.z-10){e=t;return}}),!e)return;e.position=t,e.canUse=!1,a&&(e.intensity=a.intensity,e.range=a.range)}}constructor(){this.aviableLights={spot:[],point:[]},this.numPointLights=1,this.numSpotLights=10}}class C{_init(){this.addKeyBoardControls(),this.addGamePadControls()}registerPlayerState(e,t){this.playerStates[e]=t}addKeyBoardControls(){let e=this;window.addEventListener("keydown",t=>{var a;if(void 0!==t.key){a=t.key,e.doKeyDown(t.key);return}}),window.addEventListener("keyup",t=>{var a;if(void 0!==t.key){a=t.key,e.doKeyUp(t.key);return}})}addGamePadControls(){window.addEventListener("gamepadconnected",function(e){navigator.getGamepads()[e.gamepad.index],console.log("%c Game Pad is connected!","font-size: 30px; color: blue;")})}gamePadButtonPressed(e){return"object"==typeof e?e.pressed:1==e}update(){var e=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[];if(e)for(var t=0;t<e.length;t++){var a=e[t];a&&(this.gamePadButtonPressed(a.buttons[this.gamePadControlMapping.start])&&!this.gamePadButtonPressedData.start&&(DIVINESTAR.paused?DIVINESTAR.eventHooks.triggerHook("un-pause"):DIVINESTAR.eventHooks.triggerHook("pause"),this.gamePadButtonPressedData.start=!0),!this.gamePadButtonPressed(a.buttons[this.gamePadControlMapping.start])&&this.gamePadButtonPressedData.start&&(this.gamePadButtonPressedData.start=!1),this.gamePadButtonPressed(a.buttons[this.gamePadControlMapping.forward])&&!this.gamePadButtonPressedData.forward&&(this.setPlayerState("running",!0),this.gamePadButtonPressedData.forward=!0),!this.gamePadButtonPressed(a.buttons[this.gamePadControlMapping.forward])&&this.gamePadButtonPressedData.forward&&(this.setPlayerState("idle",!0),this.gamePadButtonPressedData.forward=!1),this.gamePadButtonPressed(a.buttons[this.gamePadControlMapping.jump])&&!this.gamePadButtonPressedData.jump&&this.setPlayerState("jumping"),!this.gamePadButtonPressed(a.buttons[this.gamePadControlMapping.jump])&&this.gamePadButtonPressedData.jump&&(this.setPlayerState("inair"),this.gamePadButtonPressedData.jump=!1),this.gamePadButtonPressed(a.buttons[this.gamePadControlMapping.dash])&&this.playerStateArray[1]!=this.playerStates.dashing&&this.setPlayerState("dashing"),this.gamePadButtonPressed(a.buttons[this.gamePadControlMapping.dash])||this.playerStateArray[1]!=this.playerStates.dashing||this.setPlayerState("inair"))}}doKeyDown(e){this.controls.forward.indexOf(e)>-1&&this.setPlayerState("running",!0),this.controls.jump.indexOf(e)>-1&&this.setPlayerState("jumping"),this.controls.dash.indexOf(e)>-1&&this.setPlayerState("dashing"),this.controls.pause.indexOf(e)>-1&&(DIVINESTAR.paused?DIVINESTAR.eventHooks.triggerHook("un-pause"):DIVINESTAR.eventHooks.triggerHook("pause"))}doKeyUp(e){this.controls.forward.indexOf(e)>-1&&this.setPlayerState("idle",!0),this.controls.jump.indexOf(e)>-1&&this.setPlayerState("inair"),this.controls.dash.indexOf(e)}sendPhysicsWorkerStateArray(){}setPlayerState(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=this.playerStates[e];if(t)this.playerStateArray[0]=a;else{if(this.playerStateArray[1]==a)return;this.playerStateArray[1]=a}}constructor(){this.controls={forward:["w","W"],jump:[" "],dash:["Shift","a","A"],pause:["p","P"]},this.gamePadControlMapping={forward:12,jump:0,dash:2,start:9,select:8},this.gamePadButtonPressedData={forward:!1,jump:!1,dash:!1,start:!1,select:!1},this.playerStateArray=C.playerStateArray,this.playerStates={idle:0,running:1,onobject:0,inair:1,jumping:2,dashing:3},this._init()}}C.playerStateArray=new Int8Array(10);class O{registerTexture(e,t,a){this.textures.push({texture:e,t:0,offset:t,delay:a})}animateUpdate(){this.textures.forEach(e=>{0==e.t?(1==e.texture.uOffset||e.texture.uOffset+e.offset>.9?e.texture.uOffset=0:e.texture.uOffset+=e.offset,e.t=e.delay):e.t--})}constructor(){this.textures=[],this.count=5,this.t=this.count}}class j{addAnimationPropertyDown(e,t,a,i,s,o){let n=arguments.length>6&&void 0!==arguments[6]?arguments[6]:()=>{};this.animationsToDo.push({object:e,t:0,property:t,lowerlimit:a,final:i,downBy:s,delay:o,finsihedCallBack:n,direction:"down"})}addAnimationPropertyUp(e,t,a,i,s,o){let n=arguments.length>6&&void 0!==arguments[6]?arguments[6]:()=>{};this.animationsToDo.push({object:e,t:0,property:t,upperlimit:a,final:i,upBy:s,delay:o,finsihedCallBack:n,direction:"up"})}update(){for(let e in this.animationsToDo){let t=this.animationsToDo[e];if(0==t.t){let a=t.object,i=t.property,s=!1;2==i.length&&("down"==t.direction&&(a[i[0]][i[1]]-=t.downBy,a[i[0]][i[1]]<=t.lowerlimit&&(a[i[0]][i[1]]=t.final,s=!0)),"up"==t.direction&&(a[i[0]][i[1]]+=t.upBy,a[i[0]][i[1]]>=t.upperlimit&&(a[i[0]][i[1]]=t.final,s=!0))),1==i.length&&("down"==t.direction&&(a[i[0]]-=t.downBy,a[i[0]]<=t.lowerlimit&&(a[i[0]]=t.final,s=!0)),"up"==t.direction&&(a[i[0]]+=t.upBy,a[i[0]]>=t.upperlimit&&(a[i[0]]=t.final,s=!0))),s?(t.finsihedCallBack&&t.finsihedCallBack(),this.animationsToDo[e]=null,delete this.animationsToDo[e]):t.t=t.delay}else t.t--}}animatePropertyDown(e,t,a,i,s,o){let n=arguments.length>6&&void 0!==arguments[6]?arguments[6]:()=>{};var r=setInterval(l,o);function l(){e[t[0]][t[1]]<=a?(e[t[0]][t[1]]=i,n(),clearInterval(r)):e[t[0]][t[1]]-=s}}animatePropertyUp(e,t,a,i,s,o){let n=arguments.length>6&&void 0!==arguments[6]?arguments[6]:()=>{};var r=setInterval(l,o);function l(){e[t[0]][t[1]]>=a?(clearInterval(r),e[t[0]][t[1]]=i,n()):e[t[0]][t[1]]+=s}}constructor(){this.animationsToDo=[]}}class L{static _xfnv1a(e){let t=2166136261;for(let a=0;a<e.length;a++)t=Math.imul(t^e.charCodeAt(a),16777619);return()=>(t+=t<<13,t^=t>>>7,t+=t<<3,t^=t>>>17,(t+=t<<5)>>>0)}}var B=L;class H extends B{next(){let e=this.a+=1831565813;return e=Math.imul(e^e>>>15,1|e),(((e^=e+Math.imul(e^e>>>7,61|e))^e>>>14)>>>0)/4294967296}constructor(e){super(),this.a=H._xfnv1a(e)()}}var z=H;class _ extends B{next(){this.a>>>=0,this.b>>>=0,this.c>>>=0,this.d>>>=0;let e=this.a+this.b|0;return this.a=this.b^this.b>>>9,this.b=this.c+(this.c<<3)|0,this.c=this.c<<21|this.c>>>11,this.d=this.d+1|0,e=e+this.d|0,this.c=this.c+e|0,(e>>>0)/4294967296}constructor(e){super();let t=_._xfnv1a(e);this.a=t(),this.b=t(),this.c=t(),this.d=t()}}var G=_;class U extends B{next(){let e=this.b<<9,t=5*this.a;return t=t<<7|(t>>>25)*9,this.c^=this.a,this.d^=this.b,this.b^=this.c,this.a^=this.d,this.c^=e,this.d=this.d<<11|this.d>>>21,(t>>>0)/4294967296}constructor(e){super();let t=U._xfnv1a(e);this.a=t(),this.b=t(),this.c=t(),this.d=t()}}var W=U;let F=e=>void 0===e,Z=e=>null===e,J=e=>Z(e)||F(e);!function(e){e.sfc32="sfc32",e.mulberry32="mulberry32",e.xoshiro128ss="xoshiro128ss"}(D||(D={}));class Y{next(){return this.generator.next()}_initializeGenerator(){if(J(this.str))return this.wrap();switch(this.prng){case"sfc32":return new G(this.str);case"mulberry32":return new z(this.str);case"xoshiro128ss":return new W(this.str);default:return this.wrap()}}wrap(){return{next:()=>Math.random()}}constructor(e,t="sfc32"){this.str=e,this.prng=t,this.generator=this._initializeGenerator()}}i=new Y;let K=e=>{let t=e>>8<<8;return["".concat(t+256),"".concat(t)]},X=()=>Math.floor((1+Math.random())*16777216).toString(16),q=e=>JSON.parse(JSON.stringify(e)),$=e=>Math.PI/180*e,Q=e=>180/Math.PI*e,ee=(e,t,a)=>({r:e/255,g:t/255,b:a/255}),et=(e,t)=>Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every((e,a)=>e===t[a]),ea=(e,t)=>e+Math.floor(i.next()*t+1*i.next()),ei=e=>!!e&&i.next()<=e;class es{fullReset(){Object.keys(this.levelModels).forEach(e=>{this.levelModels[e].dispose(),this.levelModels[e]=null}),this.levelModels={},this.SPStoAdjust=[],this.MSPStoAdjust={},this.previousLocation=null,this.levelModelLocationsData=[],this.levelModelLocations=[]}addModel(e,t){this.levelModels[e]=t}removeAllModelSets(){return new Promise(function(e,t){for(let e in DIVINESTAR.assetsManager.ManagedSPS)DIVINESTAR.assetsManager.ManagedSPS[e].cullParticles();e(!0)})}disposeModelSet(e){return new Promise(function(e,t){for(let e in DIVINESTAR.assetsManager.ManagedSPS)DIVINESTAR.assetsManager.ManagedSPS[e].cullParticles();e(!0)})}async setModelUpdate(e,t){let a=this;for(let i in t){let s=t[i];(a.levelModelLocations[e]||DIVINESTAR.scene.getMeshByID(s.id))&&a.levelModelLocations[e][i]||a.addModelInstance(s)}for(let t in a.MSPStoAdjust){let i=DIVINESTAR.assetsManager.ManagedSPS[t],s=q(a.MSPStoAdjust[t]);i.setUpdate(e,s),i.setAndBuild()}return!0}doneAddingModels(){let e=this;for(let t in e.MSPStoAdjust)e.MSPStoAdjust[t]={}}addModelInstanceData(e){let t=e.position.z,a=e.id,i=100*Math.ceil(t/100);for(let t=0;t<3;t++)if((i=100+i)%200==0){let t=i-200,s="".concat(t);if(this.levelModelLocationsData[s]){this.levelModelLocationsData[s][a]=e;break}this.levelModelLocationsData[s]=[],this.levelModelLocationsData[s][a]=e;break}}addModelInstance(e){if(!DIVINESTAR.scene)return;let t=DIVINESTAR.assetData.levelModels[e.modelId];if((null==t?void 0:t.SPS)&&"infinite"==DIVINESTAR.gameMode){this.SPStoAdjust[t.forms]||(this.SPStoAdjust[t.forms]=[]),this.SPStoAdjust[t.forms].push(e);return}if((null==t?void 0:t.ManagedSPS)&&"infinite"==DIVINESTAR.gameMode){this.MSPStoAdjust[t.forms]||(this.MSPStoAdjust[t.forms]={}),this.MSPStoAdjust[t.forms][e.modelId]||(this.MSPStoAdjust[t.forms][e.modelId]=[]),this.MSPStoAdjust[t.forms][e.modelId].push(e);return}}showModels(e){var t=this.levelModelLocations[e];for(var a in t)t[a].setEnabled(!0)}hideModels(e){var t=this.levelModelLocations[e];for(var a in t)t[a].setEnabled(!1)}update(){let e=DIVINESTAR.playerABSPosition.z;for(var t in DIVINESTAR.playerPositionArray){var a=DIVINESTAR.playerPositionArray[t],i=this.levelModelLocations[a];for(var s in i){let t=i[s],a=t.position.z;a<e-50&&t.setEnabled(!1),a>e-50&&t.setEnabled(!0),a>e+200&&t.setEnabled(!1),a<e+200&&a>e&&t.setEnabled(!0)}}}constructor(){this.levelModels=[],this.levelModelLocations=[],this.levelModelLocationsData=[],this.previousLocation,this.modelsToMerge=[],this.mergedModels=[],this.SPStoAdjust=[],this.MSPStoAdjust={}}}class eo{async loadAssetData(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]}addLevelModel(e,t){this.levelModels[e]=t}constructor(){this.SPS={},this.SPSmeshes={},this.ManagedSPS={},this.levelModels={},this.environmentModels={},this.gameObjects={},this.cubeTextures={},this.sprites={},this.sounds={},this.levelModelsData={}}}class en{createImagePostProcessor(){var e;(null===(e=DIVINESTAR.scene)||void 0===e?void 0:e.cameras)&&(this.imagePostProcessor=new P.eiL("DefaultRenderingPipeline",!0,DIVINESTAR.scene,DIVINESTAR.scene.cameras),this.imagePostProcessor.samples=1,this.imagePostProcessor.depthOfFieldEnabled=!0,this.imagePostProcessor.depthOfField.focusDistance=400,this.imagePostProcessor.depthOfField.focalLength=1,this.imagePostProcessor.depthOfField.fStop=1.6)}createFog(){DIVINESTAR.scene&&(DIVINESTAR.scene.fogMode=P.xsS.FOGMODE_EXP,DIVINESTAR.scene.fogDensity=.007,DIVINESTAR.scene.fogColor=new P.Wot(.6,.6,.6))}async createLightEffects(){console.log("%c\uD83D\uDCA1created light effects","font-size:30px; color: yellow;");let e=await DIVINESTAR.fileHandler.getJSONFromFileAsync("/private/shaders/lightpostprocesson");console.log(e);var t=P.Oie.Parse(e,DIVINESTAR.scene);t.createPostProcess(DIVINESTAR.camera.camera,1),t.getBlockByName("Saturation"),t.getBlockByName("Brightness");var a=t.getBlockByName("Contrast"),i=t.getBlockByName("MidPoint");t.getBlockByName("MaxWhite"),t.getBlockByName("MinBlack"),t.getBlockByName("ShadowValue"),t.getBlockByName("HighLightValue"),t.getBlockByName("Float"),t.getBlockByName("Cyan/Red"),t.getBlockByName("Magenta/Green/"),t.getBlockByName("Yellow/Blue"),t.getBlockByName("MidTone"),a.value=0,i.value=0,this.lightEffects=t}updateLightEffectValue(e,t){this.lightEffects.getBlockByName(e).value=t}constructor(){}}class er{setWorker(e){e.onmessage=this.physicsWorkerOnMessage,this.worker=e}physicsWorkerOnMessage(e){let t=e.data,a=t.message;DIVINESTAR.physicsMessageReciver.physicsWorkerFunctions[a](t)}constructor(){this.physicsWorkerFunctions={"set-player-positon":e=>{let t=null==e?void 0:e.position,a=null==e?void 0:e.rotation;DIVINESTAR.camera.setPositionRotation(t,a),DIVINESTAR.playerABSPosition=t},"play-sfx":e=>{this.ipcRenderer.send("play-sfx",e)},"object-action":e=>{DIVINESTAR.gameObjectSPS.sendObjectUpdate(e)},"remove-object":e=>{var t;let a=null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.objectdata.id;console.log(a),DIVINESTAR.gameObjectSPS.resetParticle(a)},"delete-game-zone":e=>{var t;DIVINESTAR.deleteGameZone(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.zone)},"add-game-zone":e=>{var t;DIVINESTAR.addGameZone(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.zone)},"player-reset":e=>{var t;DIVINESTAR.isReseting=!0,console.log("%c player reset","font-size:30px;color:blue;"),console.log(e.data.position);let a=null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.position._z;console.log(a),DIVINESTAR.reset(a)},"set-checkpoint":e=>{DIVINESTAR.eventHooks.triggerHook("set-checkpoint")},"register-player-state":e=>{var t,a;let i=null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.stateName,s=null==e?void 0:null===(a=e.data)||void 0===a?void 0:a.stateNum;DIVINESTAR.globalControls.registerPlayerState(i,s)},"register-new-control":e=>{}}}}var el=a(57665);class ec{async _loadFont(){let e=document.createElement("style");e.innerHTML="\n    @font-face {\n        font-family: 'pixel';\n        src: url('private/fonts//PressStart2P-Regular.ttf') format('truetype');\n    }\n    ",document.head.appendChild(e);let t=document.createElement("span");return t.style.fontFamily="pixel",document.body.appendChild(t),await document.fonts.ready,!0}async $initalize(){this.menuScene=DIVINESTAR.SM.getNewScene("GUI"),this.menuScene.clearColor=new P.HEv(0,0,0,1),new P.cEJ("camera1",new P.Pa4(0,5,-10),this.menuScene).setTarget(P.Pa4.Zero());let e=new P.pcH("",1e3,this.menuScene);e.emitter=new P.Pa4(0,25,90),e.renderingGroupId=1,await this._loadFont(),this.GUI=el.in.CreateFullscreenUI("UI"),this.GUI.isPointerBlocker=!0,this.GUI.idealWidth=600,DIVINESTAR.SM.setActiveScene("GUI"),DIVINESTAR.SM.renderOn(),this._registerHooks()}_registerHooks(){let e=this;window.innerWidth,DIVINESTAR.eventHooks.addToHook("screen-resize",()=>{Object.keys(e.scrollViews).forEach(t=>{Object.keys(e.scrollViews[t]).forEach(e=>{let a=this.scrollViews[t][e];a.scrollView.freezeControls=!1,a.children.forEach(e=>{e.descriptionBlock&&(window.innerWidth<1300&&window.innerWidth>750?(e.descriptionBlock.width="200px",console.log("changing block 1")):window.innerWidth<750?(e.descriptionBlock.width="100px",console.log("changing block 2")):(e.descriptionBlock.width="300px",console.log("changing block 3")))}),setTimeout(()=>{a.scrollView.freezeControls=!0},10)})})})}enterContainer(e){Object.keys(this.containers).forEach(e=>{this.containers[e].isVisible=!1,this.subContainers[e]&&Object.keys(this.subContainers[e]).forEach(t=>{this.subContainers[e][t].isVisible=!1})}),this.containers[e].isVisible=!0,this.subContainers[e]&&Object.keys(this.subContainers[e]).forEach(t=>{this.subContainers[e][t].isVisible=!0})}showContainer(e){Array.isArray(e)?(this.containers[e[0]].isVisible=!0,this.subContainers[e[0]]&&Object.keys(this.subContainers[e[0]]).forEach(t=>{this.subContainers[e[0]][t].isVisible=!0})):this.containers[e].isVisible=!0}hideContainer(e){Array.isArray(e)?(this.containers[e[0]].isVisible=!1,this.subContainers[e[0]]&&Object.keys(this.subContainers[e[0]]).forEach(t=>{this.subContainers[e[0]][t].isVisible=!1})):this.containers[e].isVisible=!1}createContainer(e,t){if(this.containers[t])throw Error("Can not create screen ".concat(t," because it already exist."));let a=new el.eL;a.paddingTop="10px",a.adaptWidthToChildren=!0,a.verticalAlignment=0,a.isPointerBlocker=!0,this.metaContainers[e].addControl(a),this.containers[t]=a}createSubContainer(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;if(!this.containers[e])throw Error("Can not create sub screen ".concat(t," because screen ").concat(e," does not exist"));if(this.subContainers[e][t])throw Error("Can not create sub screen ".concat(t," because it already exist."));let s=new el.eL(t);s.height=i,s.adaptWidthToChildren=!0,s.verticalAlignment=a,this.containers[e].addControl(s),this.subContainers[e]||(this.subContainers[e]={}),this.subContainers[e][t]=s}createMetaContainer(e){if(this.containers[e])throw Error("Can not create meta container ".concat(e," because it already exist."));let t=new el.Ae;t.adaptWidthToChildren=!0,t.thickness=0,this.GUI.addControl(t),this.metaContainers[e]=t}_getContainer(e){return Array.isArray(e)?this.subContainers[e[0]][e[1]]:this.containers[e]}createGUIContainer(e,t,a,i,s){if(this._getContainer(e),"rectangle"==t){let e=new el.Ae;e.alpha=0,a&&(e.height="".concat(a,"px")),i&&(e.width="".concat(i,"px"))}}createRotateSelect(e,t,a,i,s){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"white",n=(arguments.length>6&&void 0!==arguments[6]&&arguments[6],arguments.length>7&&void 0!==arguments[7]?arguments[7]:25),r=arguments.length>8&&void 0!==arguments[8]?arguments[8]:300,l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:8,c=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"cyan",h=arguments.length>11&&void 0!==arguments[11]?arguments[11]:"",d=arguments.length>12&&void 0!==arguments[12]?arguments[12]:25,p=arguments.length>13&&void 0!==arguments[13]?arguments[13]:300,u=arguments.length>14&&void 0!==arguments[14]?arguments[14]:8,S=this._getContainer(e),g=new el.eL("rotate-select-panel");g.isVertical=!1,g.height="".concat(n+5,"px");let m=new el.al("".concat(a,"-label"));m.text=a,m.height="".concat(n,"px"),m.width="".concat(r,"px"),m.color=o,m.fontSize=l,m.fontFamily="pixel",m.textHorizontalAlignment=0,m.textWrapping=!0,m.resizeToFit=!0;let v=el.zx.CreateSimpleButton("but","");v.isPointerBlocker=!0,v.thickness=1,v.height="".concat(d,"px"),v.width="".concat(p,"px"),v.fontSize=u,v.fontFamily="pixel",v.color=c,v.background=h;let y=-1,f=i.length;function I(){return++y==f&&(y=0),i[y]}let D=()=>{let e=I();e&&(v.textBlock.text=e,s(e,y))};v.textBlock.text=I(),v.onPointerDownObservable.add(D);let P=()=>{v.color=h,v.background=c};v.onPointerEnterObservable.add(P);let b=()=>{v.color=c,v.background=h};v.onPointerOutObservable.add(b),g.addControl(m),g.addControl(v),S.addControl(g)}createButton(e,t,a){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"purple",s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:25,n=arguments.length>6&&void 0!==arguments[6]?arguments[6]:300,r=this._getContainer(e),l=el.zx.CreateSimpleButton("but",t);l.isPointerBlocker=!0,l.textWrapping=!1,l.thickness=0,l.height="".concat(o,"px"),l.width="".concat(n,"px"),l.fontSize=8,l.fontFamily="pixel",l.color=i,l.background=s,l.onPointerDownObservable.add(a),r.addControl(l);let c=()=>{l.color=s,l.background=i};l.onPointerEnterObservable.add(c);let h=()=>{l.color=i,l.background=s};l.onPointerOutObservable.add(h)}createTextInput(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3?arguments[3]:void 0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"cyan",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";arguments.length>6&&void 0!==arguments[6]&&arguments[6],arguments.length>7&&void 0!==arguments[7]&&arguments[7],arguments.length>8&&void 0!==arguments[8]&&arguments[8];let n=this._getContainer(e),r=new el.eL("".concat(t,"-textinput-panel"));r.isVertical=!1,r.width="500px",r.height="40px";let l=new el.oH("".concat(t,"-textinput-input-text"));l.height="15px",l.width="300px;",l.text=a,l.color=s,l.fontFamily="pixel",l.fontSize="10px",l.background=o,l.onTextChangedObservable.add(()=>{let e=l.text;i(e),console.log(e)});let c=new el.al("".concat(t,"-textinput-label"));c.text=t,c.color=s,c.fontSize="10px",c.width="100px",c.height="15px",c.fontFamily="pixel",r.addControl(c),r.addControl(l),n.addControl(r)}createText(e,t,a,i){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{left:0,top:0},o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],n=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2,r=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2,l=this._getContainer(e),c=new el.al("".concat(t,"-text"));return c.left=s.left,c.top=s.top,c.text=t,c.height="20px",c.color=a,c.fontSize=i,c.fontFamily="pixel",c.textVerticalAlignment=n,c.textHorizontalAlignment=r,c.textWrapping=o,c.resizeToFit=!0,l.addControl(c),c}populateScrollView(e,t,a,i,s){let o;let n=this.scrollViews[e][t];n.scrollView.freezeControls=!1,n.children.forEach(e=>{e.panel.dispose(),e.titleBlock&&e.titleBlock.dispose(),e.descriptionBlock&&e.descriptionBlock.dispose(),e.image&&e.image.dispose()}),n.children=null,n.children=[];let r=s.length,l=Math.ceil(r/a);o="vertical"!==n.orientation?l*i:s.length*i;let c=n.width/a,h=n.container,d=0;"vertical"!==n.orientation?h.height="".concat(o+2*d,"px"):(d=0,h.height="".concat(o,"px"));let p=0,u=0,S=0,g=0;for(let e=0;e<r;e++){let t,o;let r=s[e],l={},m=new el.eL("".concat(n.scrollView.name,"-").concat(e,"-panel"));if("vertical"!==n.orientation&&r.title){let e=new el.Ae;e.width="".concat(c,"px");let t=0;r.title&&(t=10),e.height="".concat(t,"px"),e.alpha=0,m.addControl(e)}if(r.img){let t=new el.Ee("".concat(n.scrollView.name,"-").concat(e,"-img"),r.img);t.width="20px",t.height="20px",t.verticalAlignment=0,m.addControl(t),l.image=t,"vertical"==n.orientation&&(t.verticalAlignment=2,t.width="200px",t.height="100px")}if(r.title&&((t=new el.al("".concat(n.scrollView.name,"-").concat(e,"-title"))).fontFamily="pixel",t.fontSize=5,t.textVerticalAlignment=1,t.color="purple",t.height="10px",t.width="50px",t.text=r.title,m.addControl(t),l.titleBlock=t,"vertical"==n.orientation&&(t.top=-30,t.paddingLeft="20px",t.width="50px",t.textVerticalAlignment=0,t.textHorizontalAlignment=0)),r.description&&((o=new el.al("".concat(n.scrollView.name,"-").concat(e,"-title"))).fontFamily="pixel",o.fontSize=5,o.textVerticalAlignment=1,o.color="white",o.height="200px",o.width="300px",o.textWrapping=!0,o.resizeToFit=!0,o.text=r.description,m.addControl(o),l.descriptionBlock=o,"vertical"==n.orientation&&(o.top=-10,o.paddingLeft="-40px",o.textVerticalAlignment=1,o.textHorizontalAlignment=0)),r.func)m.onPointerDownObservable.add(r.func);else{let e=()=>{console.log("CLICKING"),n.children.forEach(e=>{e.panel.active=!1,e.panel.background="",e.titleBlock&&(e.titleBlock.color="purple")}),m.active=!0,m.color="white",m.background="purple",r.title&&(t.color="white"),n.clickFunction&&n.clickFunction(r.value)};m.onPointerDownObservable.add(e)}let v=()=>{m.color="white",m.background="purple",r.title&&(t.color="white")};m.onPointerEnterObservable.add(v);let y=()=>{!m.active&&(m.color="purple",m.background="",r.title&&(t.color="purple"))};m.onPointerOutObservable.add(y),m.resizeToFit=!0,S=u*i+d,g=p*c,m.height="".concat(i,"px"),m.top=S,"vertical"!==n.orientation?(m.left=g,m.width="".concat(c,"px")):(m.width=1,m.isVertical=!1),m.verticalAlignment=0,m.horizontalAlignment=0,l.panel=m,n.children.push(l),h.addControl(m),"vertical"!==n.orientation?++p==a&&(p=0,u++):u++}n.scrollView.freezeControls=!0}createScrollView(e,t,a,i){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:400,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:200,n=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{left:0,top:0},r=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:2,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:"purple",h=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"rgba(29, 29, 29, 0.5)",d=arguments.length>11&&void 0!==arguments[11]?arguments[11]:"default",p=this._getContainer(t),u=new el.am(e);u.thickness=3,u.color=c,u.top=n.top,u.left=n.left,u.verticalAlignment=r,u.horizontalAlignment=l,u.width="".concat(s,"px"),u.height="".concat(o,"px"),u.background=h,u.thumbLength=.5,u.barSize=5,"default"==d?(u.verticalBar.color="purple",u.horizontalBar.color="purple"):(u.verticalBar.color=d.vertical.color,u.horizontalBar.color=d.horizontal.color),p.addControl(u);let S=new el.W2("".concat(e,"-container"));u.addControl(S);let g=this._getID(t);this.scrollViews[g]||(this.scrollViews[g]={}),this.scrollViews[g][e]=this._getScrollViewData(),this.scrollViews[g][e].scrollView=u,this.scrollViews[g][e].width=s,this.scrollViews[g][e].container=S,this.scrollViews[g][e].orientation=a,i&&(this.scrollViews[g][e].clickFunction=i)}_getScrollViewData(){return JSON.parse(JSON.stringify({scrollView:null,container:null,orientation:"horizontal",width:0,children:[]}))}_getID(e){return Array.isArray(e)?e[0]:e}populateDataView(e,t,a){let i=this._getID(t),s=this.dataViews[i][e],o=s.scrollView;s.panel&&(s.panel.dispose(),s.panel=null),s.children.forEach(e=>{var t,a;null===(t=e.labelBlock)||void 0===t||t.dispose(),null===(a=e.valueBlock)||void 0===a||a.dispose(),e.panel.dispose()}),s.children=null,s.children=[];let n=new el.eL;n.width="".concat(s.width),Object.keys(a).forEach(e=>{let t=[],i=new el.eL;i.isVertical=!1;let o=new el.al;o.fontFamily="pixel",o.fontSize=5,o.textVerticalAlignment=1,o.textHorizontalAlignment=0,o.color="purple",o.height="10px",o.width="50px",o.text=e,o.resizeToFit=!0,o.paddingLeft="50px",i.addControl(o),t.labelBlock=o;let r=new el.al;r.fontFamily="pixel",r.fontSize=5,r.textVerticalAlignment=1,r.textHorizontalAlignment=2,r.color="white",r.height="10px",r.width="10px",r.paddingLeft="10px",r.text=a[e],r.resizeToFit=!0,i.addControl(r),i.height="10px",i.width="".concat(s.width,"px"),t.valueBlock=r,t.panel=i,i.horizontalAlignment=1,s.children.push(t),n.addControl(i)}),n.horizontalAlignment=1,o.addControl(n),s.panel=n}createDataView(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{left:0,top:0},o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2,n=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2,r=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"purple",l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"rgba(29, 29, 29, 0.5)",c=this._getContainer(t),h=new el.am(e);h.thickness=3,h.color=r,h.top=s.top,h.left=s.left,h.verticalAlignment=o,h.horizontalAlignment=n,h.width="".concat(a,"px"),h.height="".concat(i,"px"),h.background=l,h.thumbLength=.5,h.barSize=5;let d=new el.W2("".concat(e,"-container"));h.addControl(d);let p=this._getDataViewData();p.scrollView=h;let u=this._getID(t);this.dataViews[u]||(this.dataViews[u]={}),p.scrollView=h,p.container=d,p.width=a,p.height=i,this.dataViews[u][e]=p,c.addControl(h)}_getDataViewData(){return JSON.parse(JSON.stringify({scrollView:null,width:0,height:0,container:null,panel:null,children:[]}))}constructor(){this.dataViews={},this.scrollViews={},this.containers={},this.subContainers={},this.metaContainers={}}}class eh{async addGameZone(e){this.levelModelManager.doneAddingModels();let t=await this.levelDataGenerator.syncData("".concat(e));console.log(t),await Promise.all([this.objectManager.addGameObjectSet("".concat(e),t.gameObjects),this.levelModelManager.setModelUpdate("".concat(e),t.levelModels)])}async deleteGameZone(e){for(let e in this.assetsManager.ManagedSPS)this.assetsManager.ManagedSPS[e].cullParticles();DIVINESTAR.gameObjectSPS.cullParticles()}setUpWorkers(){new Worker("./js/Physics/PhysicsWorker",{type:"module"});let e=new ArrayBuffer(32);this.playerPoistionArrayBufferView=new Int32Array(e);let t=new ArrayBuffer(32);this.playerZoneArrayBufferView=new Int32Array(t)}setUpHooks(){this.eventHooks.addTimeHook("game-tick",100),this.eventHooks.addToTimeHook("game-tick",()=>{}),this.eventHooks.registerVarChangeHook("player-zone-change",this.playerZoneArrayBufferView,{type:"array",indexes:[0],customIntervalBound:!0,customInterval:50}),this.eventHooks.registerVarChangeHook("player-512-zone-change",this.playerZoneArrayBufferView,{type:"array",indexes:[1],mainIntervalBound:!0,interval:100}),this.eventHooks.registerVarChangeHook("player-1024-zone-change",this.playerZoneArrayBufferView,{type:"array",indexes:[2],mainIntervalBound:!0,interval:100}),this.eventHooks.registerVarChangeHook("player-2056-zone-change",this.playerZoneArrayBufferView,{type:"array",indexes:[3],mainIntervalBound:!0,interval:100}),this.eventHooks.addToHook("program-refresh",()=>{}),this.eventHooks.addToHook("program-start",()=>{this.postMessageToPhysicsWorker("program-start",{})}),this.eventHooks.addToHook("program-exit",()=>{this.postMessageToPhysicsWorker("program-exit",{}),setTimeout(()=>{window.close()},2e3)}),this.eventHooks.addToHook("reset-before",()=>{this.postMessageToPhysicsWorker("reset-before",{})}),this.eventHooks.addToHook("reset-after",()=>{this.postMessageToPhysicsWorker("reset-after",{})}),this.eventHooks.addToHook("start-level",()=>{this.postMessageToPhysicsWorker("start-level",{})}),this.eventHooks.addToHook("pause",()=>{this.postMessageToPhysicsWorker("pause",{}),this.paused=!0}),this.eventHooks.addToHook("un-pause",()=>{this.postMessageToPhysicsWorker("un-pause",{}),this.paused=!1}),this.eventHooks.addToHook("enter-level",()=>{this.postMessageToPhysicsWorker("enter-level",{})}),this.eventHooks.addToHook("exit-level",()=>{this.postMessageToPhysicsWorker("exit-level",{}),Object.keys(DIVINESTAR.assetsManager.ManagedSPS).forEach(e=>{DIVINESTAR.assetsManager.ManagedSPS[e].fullReset(),DIVINESTAR.assetsManager.ManagedSPS[e]=null,delete DIVINESTAR.assetsManager.ManagedSPS[e]}),DIVINESTAR.assetsManager.ManagedSPS={},Object.keys(DIVINESTAR.assetsManager.levelModels).forEach(e=>{DIVINESTAR.assetsManager.levelModels[e].dispose(),DIVINESTAR.assetsManager.levelModels[e]=null,delete DIVINESTAR.assetsManager.levelModels[e]}),Object.keys(DIVINESTAR.assetsManager.gameObjects).forEach(e=>{DIVINESTAR.assetsManager.gameObjects[e].dispose(),DIVINESTAR.assetsManager.gameObjects[e]=null,delete DIVINESTAR.assetsManager.gameObjects[e]}),this.paused&&(this.paused=!1),DIVINESTAR.gameObjectSPS.fullReset(),DIVINESTAR.objectManager.fullReset(),DIVINESTAR.levelModelManager.fullReset(),DIVINESTAR.assetsManager.levelModels={},DIVINESTAR.assetsManager.levelModelsData={},DIVINESTAR.scene.dispose(),DIVINESTAR.scene=null,DIVINESTAR.rendering=!1,this.levelManager.unSetLevel(),this.pauseMenu.hideMenu(),this.mainMenu.showMenu()})}rednerLoop(){this.rendering&&this.scene&&this.scene.render()}postMessageToPhysicsWorker(e,t){}setDebug(e){this.debug=e}setScene(e){this.scene=e,this.gameObjectSPS.init()}resetScene(){this.rendering=!1}setPlayerPosition(){let e=.01*this.playerPoistionArrayBufferView[1];this.playerPoistionArrayBufferView[2];let t=.01*this.playerPoistionArrayBufferView[3];this.playerPoistionArrayBufferView[4],this.playerPoistionArrayBufferView[5],this.playerPoistionArrayBufferView[6],this.playerABSPosition.x=e,this.playerABSPosition.y=t,this.playerABSPosition.z=t}update(){this.setPlayerPosition(),this.isReseting||(this.globalControls.update(),this.animatedTextures.animateUpdate(),this.objectManager.update(),this.gameObjectSPS.update(),this.levelManager.update(),this.eventHooks.update(),this.levelManager.activeLevel&&this.levelManager.activeLevel.update(),this.animationHelper.update())}async startLevel(){return setTimeout(()=>{console.warn("Send stsrt level")},1e3),this.levelModelManager.doneAddingModels(),this.eventHooks.triggerHook("start-level"),!0}async reset(e){console.log("%c reseting player","font-size:25px;color:red"),console.log(e),this.eventHooks.triggerHook("reset-before"),this.isReseting=!0,this.gameMode;let t=this,a=t.calculateGameZone(e);this.levelModelManager.doneAddingModels(),console.log(a[0],a[1]);let[i,s,o]=await Promise.all([this.levelDataGenerator.syncData(a[0]),this.levelDataGenerator.syncData(a[1]),this.levelModelManager.removeAllModelSets()]),n=[];return Object.keys(DIVINESTAR.assetsManager.ManagedSPS).forEach(e=>{n.push(DIVINESTAR.assetsManager.ManagedSPS[e].resetAll())}),await Promise.all(n),t.gameObjectSPS.resetAll(),await Promise.all([this.objectManager.addGameObjectSet(a[0],i.gameObjects),this.objectManager.addGameObjectSet(a[1],s.gameObjects),this.levelModelManager.setModelUpdate(a[0],i.levelModels),this.levelModelManager.setModelUpdate(a[1],s.levelModels)]),this.eventHooks.triggerHook("reset-after",{zone:parseInt(a[1])}),t.isReseting=!1,!0}calculateGameZone(e){return K(e)}cloneJson(e){return q(e)}degtoRad(e){return $(e)}RGBtoRatio(e,t,a){return ee(e,t,a)}radToDeg(e){return Q(e)}arrayEquals(e,t){return et(e,t)}getRange(e,t){return ea(e,t)}probability(e){return ei(e)}constructor(){this.gameObjectSPS=new b,this.levelConstructor=new w.T,this.levelDataGenerator=new k,this.levelModelManager=new es,this.levelManager=new x,this.assetsManager=new eo,this.animationHelper=new j,this.animatedTextures=new O,this.globalControls=new C,this.imageProcessing=new en,this.objectManager=new T.a,this.lightsManager=new N,this.eventHooks=new I,this.mainMenu=new y,this.pauseMenu=new h,this.optionsMenu=new f,this.screenCreator=new c,this.profileManager=new l,this.languageManager=new r,this.physicsMessageReciver=new er,this.GUI=new ec,this.debug=!1,this.assetData={},this.levelStructuresData={},this.currentLevelData={},this.rendering=!1,this.playerABSPosition={x:0,y:0,z:0},this.playerPreviousPositionArray=["0","0"],this.playerPositionArray=["200","0"],this.zoneToDelete=[],this.isReseting=!1,this.gameMode="infinite",this.oldZone=0,this.newZone=0,this.unqiueId=()=>X()}}function ed(e,t){let a=JSON.parse(e),i={};return t.dataExport=i,t.GAME_ZONE_SIZE=a.GAME_ZONE_SIZE,i.GAME_ZONE_SIZE=GAME_ZONE_SIZE,t.OBJECT_UPDATE_ZONE_SIZE=a.OBJECT_UPDATE_ZONE_SIZE,i.OBJECT_UPDATE_ZONE_SIZE=OBJECT_UPDATE_ZONE_SIZE,t.RENDER_DISTANCE=a.RENDER_DISTANCE,i.RENDER_DISTANCE=RENDER_DISTANCE,t.GOD_MODE=a.GOD_MODE,i.GOD_MODE=GOD_MODE,t.DEVELOPMENT=a.DEVELOPMENT,i.DEVELOPMENT=DEVELOPMENT,t.START_IN_LEVEL=a.START_IN_LEVEL,i.START_IN_LEVEL=START_IN_LEVEL,t.STARTING_LEVEL=a.STARTING_LEVEL,i.STARTING_LEVEL=STARTING_LEVEL,t.RANDOM_SEED=a.RANDOM_SEED,i.RANDOM_SEED=RANDOM_SEED,t.SET_SEED=a.SET_SEED,i.SET_SEED=SET_SEED,t.START_IN_SCREEN=a.START_IN_SCREEN,i.START_IN_SCREEN=START_IN_SCREEN,t.STARTING_SCREEN=a.STARTING_SCREEN,i.STARTING_SCREEN=STARTING_SCREEN,i}class ep{getId(){return this.id}getData(){return this.data}setPosition(e){if(this.model.position=e)return!0}setRotation(e){if(this.data.spriteid&&(this.model.rotation=e))return!0}disposeModel(){this.model.dispose()}constructor(e,t,a,i){this.id=e,this.active=!0,this.data=t,this.model=i,this.model.objectRefernce=this,this.modelName=a,this.model.name=a}}a.g.GameObject=ep;class eu extends ep{update(){let e=this;e.active&&(0==e.t?(e.t=e.count,P.Pa4.Distance(e.model.position,DSP.playerABSPosition)<=this.distance&&e.action()):e.t--),this.onUpdate&&this.onUpdate()}onUpdate(){}action(){}constructor(e,t,a,i,s=3){super(e,t,a,i),this.count=4,this.distance=s,this.t=this.count}}a.g.PlayerDependentObject=eu;class eS extends eu{action(){DSP.player.enableDashPowerUp(this.data),DSP.postMessageToMainThread("play-sfx",{sfx:"dash-power-up-pick-up"});let e=this;e.active=!1,setTimeout(()=>{e.active=!0},1e3)}constructor(e,t,a){a.isPickable=!1,(null==a?void 0:a.material)&&(a.material.backFaceCulling=!1),super(e,t,"dash",a),this.onUpdate=()=>{}}}class eg extends eu{action(){let e=this;e.active=!1,setTimeout(()=>{e.active=!0},250),DSP.player.switchGravity(this.data)}constructor(e,t,a){switch(super(e,t,"GravitySwitch",a),this.model=a,this.facing=t.facing,this.facing){case"L":break;case"R":this.model.angle=Math.PI/180*180;break;case"U":this.model.angle=-(Math.PI/180*90);break;case"D":this.model.angle=Math.PI/180*90}}}class em extends eu{action(){DSP.player.jumpPad(this.data.velocity)}constructor(e,t,a){super(e,t,"jumppad",a)}}class ev extends eu{action(){DSP.objectManager.updateCheckPoint(this.model.position,this.data.id),DSP.player.setResetPoint(this.model.position),DSP.postMessageToMainThread("set-checkpoint",{objectdata:this.data}),DSP.eventHooks.triggerHook("set-checkpoint"),this.model.position.z=-1e3,this.active=!1}constructor(e,t,a){super(e,t,"checkpoint",a)}}class ey extends eu{action(){this.model.dispose(),DSP.postMessageToMainThread("remove-object",{objectdata:this.data}),DSP.postMessageToMainThread("play-sfx",{sfx:"pointorb-pickup"}),DSP.objectManager.updatePointOrb(this.model.position,this.data.id),this.active=!1}constructor(e,t,a){super(e,t,"checkpoint",a,5)}}class ef extends eu{action(){let e=this;e.active&&(DSP.postMessageToMainThread("object-action",{object:"door",type:"animate",objectdata:e.data}),"right"==e.data.side||e.data.side,e.active=!1)}constructor(e,t,a){a.isPickable=!1,super(e,t,"Door",a,30)}}class eI extends eu{action(){DSP.actionManager.doAction(this.data.action)}constructor(e,t){let a=new P.Pa4(t.position.x,t.position.y,t.position.z),i=new P.YOI(e);i.position=a,super(e,t,"ActionNode",i,t.distance)}}class eD{registerUpdateFunction(e,t){switch(e){case"start":this._updateStart.push(t),this._updateStartLength++;break;case"middle":this._updateMiddle.push(t),this._updateMiddleLength++;break;case"end":this._updateEnd.push(t),this._updateEndLength++}}addActionState(e){if(this.playerStates[e])throw Error("No overlapping state names allowed for player.");let t=Object.keys(this.playerActionStates).length;this.playerActionStates[t]=e,this.playerStates[e]=t}addWalkState(e){if(this.playerStates[e])throw Error("No overlapping state names allowed for player.");let t=Object.keys(this.playerWalkStates).length;this.playerWalkStates[t]=e,this.playerStates[e]=t}registerStateFunction(e,t){if(!this.playerStates[e])throw Error("The state you are attempting to attatch a function to does not exist.");this.states[e]=t}loadCheckPoint(){this.dashPowerUp=this.checkPointSnapShot.hasDashPowerUp||!1,this.dashPowerUpT=this.checkPointSnapShot.dashPowerUpT||0,this.dashPowerUpCount=this.checkPointSnapShot.dashPowerUpCount||0,this.candash=this.checkPointSnapShot.canDash,this.dashT=this.checkPointSnapShot.dashT,this.dashCoolDownCount=this.checkPointSnapShot.dashCoolDownCount,this.dashTCoolDown=this.checkPointSnapShot.dashTCoolDown}setCheckPoint(){this.checkPointSnapShot={hasDashPowerUp:this.dashPowerUp,dashPowerUpT:this.dashPowerUpT,dashPowerUpCount:this.dashPowerUpCount,canDash:this.candash,dashT:this.dashT,dashCoolDownCount:this.dashCoolDownCount,dashTCoolDown:this.dashTCoolDown}}addHooks(){let e=this;DSP.eventHooks.addToHook("set-checkpoint",()=>{console.log("%c set checkpoint player","font-size:25px;color:red"),e.setCheckPoint(),console.log(this.checkPointSnapShot)}),DSP.eventHooks.addToHook("reset-after",()=>{console.log("%c reseting in player","font-size:25px;color:red"),console.log(this.checkPointSnapShot),e.loadCheckPoint()}),DSP.eventHooks.addToHook("exit-level",()=>{this.fullReset()}),DSP.eventHooks.addToHook("pause",()=>{this.stopMoving()}),DSP.eventHooks.addToHook("un-pause",()=>{this.startMoving()}),this.setCheckPoint()}fullReset(){this.resetPoint=new P.Pa4(0,2,3),this.checkPointSnapShot=JSON.parse(JSON.stringify(this.defaultCheckpointSnapShop))}setWalkState(e){let t=this.playerStates[e];this.playerStateArray[0]=t}setState(e){let t=this.playerStates[e];this.playerStateArray[1]=t}_onobject(){DSP.player.jumpingEnabled=!0}_inair(){DSP.player.onObject?(DSP.postMessageToMainThread("play-sfx",{sfx:"land"}),DSP.player.jumpingEnabled=!0,DSP.player.setState("onobject")):DSP.player.jumpingEnabled=!1}_idle(){DSP.player.touchingWall||(DSP.player.playerhitbox.position.z+=DSP.player.baseSpeed),DSP.player.onObject&&DSP.postMessageToMainThread("play-sfx",{sfx:"step"})}_running(){DSP.player.touchingWall||(DSP.player.playerhitbox.position.z+=.1+DSP.player.speed),DSP.player.onObject&&DSP.postMessageToMainThread("play-sfx",{sfx:"run"})}_jumping(){if(DSP.player.onObject&&DSP.player.jumpingEnabled){switch(DSP.player.gravityDirection){case"U":DSP.player.velocity.y=-.25;break;case"D":DSP.player.velocity.y=.25;break;case"L":DSP.player.velocity.x=.25;break;case"R":DSP.player.velocity.x=-.25}DSP.physicsObjectsManager.resetPhysics(),DSP.postMessageToMainThread("play-sfx",{sfx:"jump"}),DSP.player.onObject=!1,DSP.player.setState("inair"),DSP.player.jumpingEnabled=!1,"running"!=DSP.player.currentWalkState||(DSP.camera.camUpRunning&&DSP.camera.stopCameraUp(),DSP.camera.camUpRunning||DSP.camera.camDownRunning||DSP.camera.cameraDown())}else DSP.player.setState("onobject")}_dashing(){if(DSP.player.touchingWall){DSP.player.candash=!1,DSP.player.isdashing=!1,DSP.player.dashT=DSP.player.dashCount,DSP.player.setState("inair");return}DSP.player.candash&&(DSP.player.isdashing=!0,DSP.player.candash=!1,DSP.camera.stopCameraDown(),DSP.camera.cameraUp(),DSP.postMessageToMainThread("play-sfx",{sfx:"dash"})),DSP.player.isdashing||DSP.player.candash||DSP.player.setState("inair"),DSP.player.isdashing&&(DSP.player.onObject||(DSP.player.velocity.y=0),0==DSP.player.dashT?(DSP.player.setState("inair"),DSP.player.isdashing=!1,DSP.player.dashT=DSP.player.dashCount,DSP.player.dashPowerUp?DSP.player.candash=!0:setTimeout(()=>{DSP.player.candash=!0},2e3)):(DSP.player.dashT--,DSP.player.dashT>=12?DSP.player.playerhitbox.position.z+=.6:DSP.player.playerhitbox.position.z+=.3))}setResetPoint(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.playerhitbox.position;this.resetPoint=new P.Pa4(e.x,e.y-1,e.z-1)}getRotation(){return this.playerhitbox.rotation}getPosition(){return this.playerhitbox.position}setPosition(e){this.playerhitbox.position=e}showHitBox(){this.playerhitbox.isVisible=!0}hideHitBox(){this.playerhitbox.isVisible=!1}disableControl(){this.canControl=!1}enableControl(){this.canControl=!0}setBaseSpeed(e){this.baseSpeed=e}setBaseSpeedToDefault(){this.baseSpeed=this.baseSpeedDefault}stopMoving(){this.lastVelocity=this.velocity,this.allowedMovement=!1}startMoving(){this.allowedMovement=!0,this.velocity=this.lastVelocity,this.setState("idle")}reset(){if(!this.canReset)return!1;this.resetPoint?this.playerhitbox.position=new P.Pa4(this.resetPoint.x,this.resetPoint.y+2,this.resetPoint.z):this.playerhitbox.position=new P.Pa4(0,2,3)}showPlayerHitbox(){this.playerhitbox.isVisible=!0}createPlayer(){this.playerhitbox=P.VO7.CreateCylinder("playerhitbox",{diameter:1.5,height:2},DSP.scene),this.playerhitbox.position.y=100,this.playerhitbox.position.z=10;var e=new P.KuD("mat0",DSP.scene);e.diffuseColor.copyFromFloats(.8,.2,.2),e.backFaceCulling=!1,this.playerhitbox.material=e,this.playerhitbox.isPickable=!1,this.playerhitbox.rotation.y=2*Math.PI/2,this.playerhitbox.isVisible=!1,this.playerhitbox.renderingGroupId=1}enableDashPowerUp(e){this.dashPowerUp=!0,this.dashPowerUpCount=e.duration,this.dashPowerUpT=e.duration}jumpPad(e){DSP.camera.stopCameraUp(),DSP.camera.cameraDown(),this.velocity.y=e,DSP.physicsObjectsManager.resetPhysics(),DSP.postMessageToMainThread("play-sfx",{sfx:"jumppad"}),this.onObject=!1,this.setState("inair")}switchGravity(e){let t=this;if("D"==t.gravityDirection){if(t.velocity.y=0,t.gravityDirection=e.direction,e.direction,"U"==e.direction){if(!e.trackX)return;DSP.animationHelper.animatePropertyUp(this.playerhitbox,["position","x"],e.trackX,e.trackX,.5,15,()=>{});let t=Math.PI/180*180;DSP.animationHelper.animatePropertyUp(this.playerhitbox,["rotation","z"],t,t,.04,13,()=>{})}if(e.direction,e.direction,"L"==e.direction){if(!e.trackY)return;DSP.animationHelper.animatePropertyUp(this.playerhitbox,["position","y"],e.trackY,e.trackY,.5,15,()=>{});let t=Math.PI/180*90;DSP.animationHelper.animatePropertyUp(this.playerhitbox,["rotation","z"],t,t,.04,13,()=>{})}}if("U"==t.gravityDirection&&(t.velocity.y=0,t.gravityDirection=e.direction,e.direction,e.direction,e.direction,"R"==e.direction)){if(!e.trackY)return;DSP.animationHelper.animatePropertyDown(this.playerhitbox,["position","y"],e.trackY,e.trackY,.5,15,()=>{});let t=this.playerhitbox.rotation.z+Math.PI/180*90,a=-(Math.PI/180*90);DSP.animationHelper.animatePropertyUp(this.playerhitbox,["rotation","z"],t,a,.04,13,()=>{})}if("L"==t.gravityDirection){if(t.velocity.x=0,t.gravityDirection=e.direction,e.direction,"U"==e.direction){if(!e.trackX)return;t.gravityDirection=e.direction,DSP.animationHelper.animatePropertyUp(this.playerhitbox,["position","x"],e.trackX,e.trackX,.5,15,()=>{});let a=Math.PI/180*180;DSP.animationHelper.animatePropertyUp(this.playerhitbox,["rotation","z"],a,a,.04,13,()=>{})}if("D"==e.direction){if(!e.trackX)return;DSP.animationHelper.animatePropertyUp(this.playerhitbox,["position","x"],e.trackX,e.trackX,.5,15,()=>{}),DSP.animationHelper.animatePropertyDown(this.playerhitbox,["rotation","z"],0,0,.04,13,()=>{})}e.direction}if("R"==t.gravityDirection){if(t.velocity.x=0,t.gravityDirection=e.direction,e.direction,e.direction,"D"==e.direction){if(!e.trackX)return;DSP.animationHelper.animatePropertyDown(this.playerhitbox,["position","x"],e.trackX,e.trackX,.5,15,()=>{});let t=this.playerhitbox.rotation.z+Math.PI/180*90;DSP.animationHelper.animatePropertyUp(this.playerhitbox,["rotation","z"],t,0,.04,13,()=>{})}e.direction}}_startUpdate(){let e=this._updateStartLength;for(;e--;)this._updateStart[e]()}_middleUpdate(){let e=this._updateMiddleLength;for(;e--;)this._updateMiddle[e]()}_endUpdate(){let e=this._updateEndLength;for(;e--;)this._updateEnd[e]()}$update(){if(this.playerhitbox&&this.allowedMovement){this._startUpdate(),this.currentWalkState=this.playerWalkStates[this.playerStateArray[0]],this.currentState=this.playerActionStates[this.playerStateArray[1]],this.states[this.currentState](),this.states[this.currentWalkState](),this._middleUpdate();var e=DSP.scene.getEngine().getDeltaTime();if(this.velocity.y<=0&&"D"==this.gravityDirection||this.velocity.x<=0&&"L"==this.gravityDirection||this.velocity.x>=0&&"R"==this.gravityDirection||this.velocity.y>=0&&this.gravityDirection,this.allowedMovement){switch(this.gravityDirection){case"U":this.velocity.y+=e/3e3;break;case"D":this.velocity.y-=e/3e3;break;case"R":this.velocity.x+=e/3e3;break;case"L":this.velocity.x-=e/3e3}if(this.onObject)switch(DSP.camera.camUpRunning||DSP.camera.camDownRunning||0==DSP.camera.camYAxis.rotation.x||DSP.camera.cameraUp(),this.gravityDirection){case"U":case"D":this.velocity.y=Math.max(0,this.velocity.y);break;case"R":case"L":this.velocity.x=0}}this.touchingWall&&!this.onObject&&(this.velocity.y=-.4),this.allowedMovement&&this.playerhitbox.moveWithCollisions(this.velocity),this._endUpdate()}}constructor(){this.vars={},this.playerFacing="N",this.onObject=!1,this.jumpingEnabled=!0,this.touchingWall=!1,this.velocity=P.Pa4.Zero(),this.lastVelocity=this.velocity,this.speed=.05,this.dashCount=20,this.dashPowerUp=!1,this.dashPowerUpCount=500,this.dashPowerUpT=this.dashPowerUpCount,this.dashT=this.dashCount,this.dashCoolDownCount=300,this.dashCoolDownCountDefault=this.dashCoolDownCount,this.dashTCoolDown=this.dashCoolDownCount,this.candash=!0,this.isdashing=!1,this.doingAction=!1,this.resetPoint=new P.Pa4(0,2,3),this.allowedMovement=!1,this.canControl=!1,this.baseSpeed=.05,this.baseSpeedDefault=.05,this.canReset=!0,this.currentWalkState="idle",this.currentState="onobject",this.states={idle:this._idle,running:this._running,jumping:this._jumping,inair:this._inair,onobject:this._onobject,dashing:this._dashing},this.playerWalkStates={0:"idle",1:"running"},this.playerActionStates={0:"onobject",1:"inair",2:"jumping",3:"dashing"},this.playerStates={idle:0,running:1,onobject:0,inair:1,jumping:2,dashing:3},this._updateStart=[],this._updateStartLength=0,this._updateMiddle=[],this._updateMiddleLength=0,this._updateEnd=[],this._updateEndLength=0,this.gravityDirection="D",this.playerStateArray=C.playerStateArray,this.defaultCheckpointSnapShop={hasDashPowerUp:this.dashPowerUp,dashPowerUpT:this.dashPowerUpT,dashPowerUpCount:this.dashPowerUpCount,canDash:this.candash,dashT:this.dashT,dashCoolDownCount:this.dashCoolDownCount,dashTCoolDown:this.dashTCoolDown}}}var eP=a(84887);class eb{doAction(e){for(let t in e){let a=e[t];this.actions[a]()}}createActions(){this.actions["lvl1-updateParticleSystem"]=()=>{},this.actions.enableControl=()=>{},this.actions.enableBaseSpeedDefault=()=>{}}constructor(){this.actions={},this.createActions()}}class eT{removePhysicsDataSet(e){this.physicsObjectLocations[e]=void 0}toggleVisibleParticles(){this.SPS.materials.forEach(e=>{0==e.alpha?e.alpha=1:e.alpha=0})}createObjects(){var e=new P.KuD("mat0",DSP.scene);e.diffuseColor.copyFromFloats(.8,.8,.8),e.backFaceCulling=!1,this.material=e;let t=P.VO7.CreateBox("box",{height:.5,width:2,depth:2},DSP.scene);t.material=e;let a=this;t.renderingGroupId=2;let i=[],s=0;for(let e=2;e<102;e++)s+=1*e,i.push({position:{x:0,y:10,z:s},rotation:{x:0,y:0,z:0}});a.buildSPS([t],i)}checkPick(e){if(-1!=e.faceId&&!e.pickedMesh){var t=this.SPS.pickedParticle(e);if(!t)return!1;var a=t.idx;return this.SPS.particles[a],!0}}fullReset(){this.SPS.vars=this._getVars(),this.SPS.initParticles()}buildSPS(e,t){let a=this,i=e[0];this.SPS=new P.Jyq("Physics",DSP.scene,{useModelMaterial:!0,particleIntersection:!0}),this.SPS.addShape(i,400);let s=this.SPS.buildMesh();this.SPS.isAlwaysVisible=!0,s.renderingGroupId=1,s.isVisible=!1,this.SPS.initParticles=()=>{for(let e=0;e<a.SPS.nbParticles;e++)a.SPS.particles[e].position.z=-1e3},this.SPS.initParticles(),this.placeObjects(t)}update(){this.SPS&&this.SPS.setParticles()}_getVars(){return JSON.parse(JSON.stringify(this.defaultVars))}sendUpdate(e,t){console.log("set update",e,t),t&&(this.SPS.vars.needUpdate?(this.SPS.vars.positionData=this.SPS.vars.positionData.concat(t),this.SPS.vars.positionDataLength=this.SPS.vars.positionData.length):(this.SPS.vars.positionData=t,this.SPS.vars.positionDataLength=t.length,this.SPS.vars.needUpdate=!0))}resetPhysics(){this.SPS.vars.intersectArray=[],this.SPS.vars.triggerWall=!1,this.SPS.vars.triggerGround=!1}placeObjects(e){let t=this;this.SPS.counter=0,this.SPS.vars=this._getVars(),this.SPS.updateParticle=function(e){if(e.position.z<DSP.playerABSPosition.z+10&&e.position.z>DSP.playerABSPosition.z-50&&(e.intersectsMesh(DSP.player.playerhitbox)?(t.SPS.vars.intersectArray["particle-".concat(e.idx)]=!0,e.position.y>DSP.playerABSPosition.y?t.SPS.vars.triggerWall=!0:t.SPS.vars.triggerGround=!0):(t.SPS.vars.intersectArray["particle-".concat(e.idx)]=!1,delete t.SPS.vars.intersectArray["particle-".concat(e.idx)])),Object.keys(t.SPS.vars.intersectArray).length>0?(t.SPS.vars.triggerWall&&(DSP.player.touchingWall=!0),t.SPS.vars.triggerGround&&(DSP.player.onObject=!0)):(t.SPS.vars.triggerGround=!1,t.SPS.vars.triggerWall=!1,DSP.player.onObject=!1,DSP.player.touchingWall=!1),t.SPS.vars.needUpdate){if(e.position.z<DSP.playerABSPosition.z||e.position.z>DSP.playerABSPosition.z+500){if(t.SPS.counter<t.SPS.vars.positionDataLength){let a=t.SPS.vars.positionData[t.SPS.counter];if(!a){console.log("%c Error index for physics particles out of bounds -> ".concat(t.SPS.counter),"font-size: 15px; color: red;"),t.SPS.counter=0,t.SPS.vars.particleCount=0,t.SPS.vars.needUpdate=!1;return}a.scaling&&(e.scaling.x=a.scaling.x,e.scaling.y=a.scaling.y,e.scaling.z=a.scaling.z),e.position.x=a.position.x,e.position.y=a.position.y,e.position.z=a.position.z,e.rotation.x=a.rotation.x,e.rotation.y=a.rotation.y,e.rotation.z=a.rotation.z,t.SPS.counter++}else t.SPS.counter=0,t.SPS.vars.particleCount=0,t.SPS.vars.needUpdate=!1}t.SPS.vars.particleCount++,t.SPS.vars.particleCount==t.SPS.nbParticles&&(t.SPS.vars.needUpdate=!1,t.SPS.counter=0,t.SPS.vars.particleCount=0)}},this.SPS.setParticles();let a=this.SPS.buildMesh();this.SPS.isAlwaysVisible=!0,a.renderingGroupId=1}constructor(){this.psychicObjects=!1,this.defaultVars={needUpdate:!1,positionData:!1,positionDataLength:0,intersectArray:[],particleCount:1,triggerWall:!1,triggerGround:!1},this.physicsObjectLocations={},this.objectDataList={"wall-2":{shapeId:0},"wall-4":{shapeId:1},"wall-6":{shapeId:2},"wall-8":{shapeId:3},"wall-20":{shapeId:4},"slope-2":{shapeId:5}},this.showParticles=!0}}class ew{getRotation(){return this.camYAxis.rotation}attatchToPlayer(){let e=DSP.player;this.cameraRoot.parent=e.playerhitbox}buildCamera(){this.cameraRoot=new P.YOI("cameraRoot"),this.cameraRoot.position=new P.Pa4(0,0,0),this.cameraRoot.rotation=new P.Pa4(0,Math.PI,0),this.camYAxis=new P.YOI("camYAxis"),this.camYAxis.rotation=new P.Pa4(0,0,0),this.camYAxis.parent=this.cameraRoot,this.camera=new P.xcu("playercamera",new P.Pa4(0,1,-1),DSP.scene),this.camera.fov=.6,this.camera.parent=this.camYAxis,this.camera.checkCollisions=!1,this.camera.isPickable=!1,this.camera.maxZ=600,DSP.scene.activeCamera=this.camera}rotateFreeCamera(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15;this.rotateBy=DSP.degtoRad(a),"X"==e&&("up"==t&&(this.debugFreeCameraRoot.rotation.x+=this.rotateBy),"down"==t&&(this.debugFreeCameraRoot.rotation.x-=this.rotateBy)),"Y"==e&&("up"==t&&(this.debugFreeCameraRoot.rotation.y+=this.rotateBy),"down"==t&&(this.debugFreeCameraRoot.rotation.y-=this.rotateBy)),"Z"==e&&("up"==t&&(this.debugFreeCameraRoot.rotation.z+=this.rotateBy),"down"==t&&(this.debugFreeCameraRoot.rotation.z-=this.rotateBy))}stopCameraDown(){this.camDownRunning=!1}stopCameraUp(){this.camUpRunning=!1}cameraDown(){this.camDownRunning=!0}cameraUp(){this.camUpRunning=!0}update(){this.camUpRunning&&(this.camYAxis.rotation.x<=0?(this.camUpRunning=!1,this.camYAxis.rotation.x=0):this.camYAxis.rotation.x-=.08),this.camDownRunning&&(this.camYAxis.rotation.x>=.7?this.camDownRunning=!1:(this.camDownRunning=!0,this.camYAxis.rotation.x+=.08)),this.camUpRunning&&this.camDownRunning&&(this.stopCameraDown(),this.stopCameraUp())}constructor(){this.camDownRunning=!1,this.camUpRunning=!1,this.animateUpId=null,this.animateDownId=null,this.canMoveDebugCamera=!0,this.canRotateDebugCamera=!1,this.delay=2,this.t=this.delay,this.animateUpId=null,this.animateDownId=null,this.animateDownId=null,this.canMoveDebugCamera=!0,this.canRotateDebugCamera=!1}}class eA{initPhysics(){this.physicsObjectsManager=new eT}postMessageToMainThread(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]}addHooks(){this.player.addHooks(),this.eventHooks.addToHook("exit-level",()=>{this.isReseting=!0,this.player.setPosition(new P.Pa4(0,2,3)),this.physicsObjectsManager.fullReset(),this.objectManager.fullReset(),this.playerPreviousPositionArray=["0","0"],this.playerPositionArray=["200","0"],this.zoneToDelete=[],this.isReseting=!1})}update(){let e=this;if(!e.isReseting&&e.player.playerhitbox){e.playerABSPosition=e.player.playerhitbox.getAbsolutePosition();let n=this.camera.getRotation();this.playerPositionArrayBuffer[1]=100*this.playerABSPosition.x,this.playerPositionArrayBuffer[2]=100*this.playerABSPosition.y,this.playerPositionArrayBuffer[3]=100*this.playerABSPosition.z,this.playerPositionArrayBuffer[4]=100*n.x,this.playerPositionArrayBuffer[5]=100*n.y,this.playerPositionArrayBuffer[6]=100*n.z;let r=this.playerABSPosition.z,l=this.calculateGameZone(r),c=parseInt(l[1]),h=c>>9,d=c>>10,p=c>>11;if(this.playerZoneArrayBuffer[0]=c,this.playerZoneArrayBuffer[1]=h,this.playerZoneArrayBuffer[2]=d,this.playerZoneArrayBuffer[3]=p,e.playerABSPosition.y<=-5){e.reset();return}if(e.objectManager.update(),this.zoneToDelete&&(this.zoneToDelete.forEach((t,a)=>{var i=parseInt(t)+210;(r>i||r+400<i)&&(e.physicsObjectsManager.removePhysicsDataSet(t),e.objectManager.removeGameZone(t))}),DSP.zoneToDelete=[]),this.playerPreviousPositionArray=this.playerPositionArray,this.playerPositionArray=l,this.playerPreviousPositionArray[1]!=this.playerPositionArray[1]){var t=this.playerPositionArray[1],a=this.playerPositionArray[0],i=this.playerPreviousPositionArray[1],s=this.playerPreviousPositionArray[0];if(i==t||i==a||this.isReseting||(this.zoneToDelete||(this.zoneToDelete=[]),this.zoneToDelete.push(i)),s!=a&&s!=t&&(this.zoneToDelete||(this.zoneToDelete=[]),this.zoneToDelete.push(s)),s!=t&&e.addGameZone("".concat(a)),s!=a){var o=parseInt(t);o+=200,"infinite"==DSP.gameMode&&DIVINESTAR.levelDataGenerator.generateLevelSectionFromWorker(),e.isReseting||e.addGameZone("".concat(a))}}e.physicsObjectsManager.update(),e.player.$update(),e.camera.update()}}async addGameZone(e){let t=await DIVINESTAR.levelDataGenerator.syncData(e);return await Promise.all([this.objectManager.addGameObjectSet(e,t.gameObjects),this.physicsObjectsManager.sendUpdate(e,t.physicsObjects),DIVINESTAR.objectManager.addGameObjectSet(e,null==t?void 0:t.gameObjects),DIVINESTAR.levelModelManager.setModelUpdate(e,t.levelModels)]),!0}async removeGameZone(e){await Promise.all([this.objectManager.removeGameZone(e),this.physicsObjectsManager.removePhysicsDataSet(e)])}async startLevel(){let[e,t]=await Promise.all([DIVINESTAR.levelDataGenerator.syncData("0"),DIVINESTAR.levelDataGenerator.syncData("256")]);return console.warn(e,t,e.physicsObjects),await Promise.all([this.objectManager.addGameObjectSet("0",e.gameObjects),this.objectManager.addGameObjectSet("256",t.gameObjects),this.physicsObjectsManager.sendUpdate("0",e.physicsObjects),this.physicsObjectsManager.sendUpdate("256",t.physicsObjects),DIVINESTAR.objectManager.addGameObjectSet("0",null==e?void 0:e.gameObjects),DIVINESTAR.objectManager.addGameObjectSet("256",null==t?void 0:t.gameObjects),DIVINESTAR.levelModelManager.setModelUpdate("0",e.levelModels),DIVINESTAR.levelModelManager.setModelUpdate("256",t.levelModels)]),!0}async reset(){this.eventHooks.triggerHook("reset-before");let e=this;e.player.stopMoving(),e.isReseting=!0;let t=e.calculateGameZone(e.player.resetPoint.z);this.playerPositionArray=t,this.playerPreviousPositionArray=t,await e.objectManager.reset(),e.player.reset();let[a,i]=await Promise.all([DIVINESTAR.levelDataGenerator.syncData(t[1]),DIVINESTAR.levelDataGenerator.syncData(t[0])]);return await Promise.all([this.objectManager.addGameObjectSet(t[1],a.gameObjects),this.objectManager.addGameObjectSet(t[0],i.gameObjects),this.physicsObjectsManager.sendUpdate(t[1],a.physicsObjects),this.physicsObjectsManager.sendUpdate(t[0],i.physicsObjects),DIVINESTAR.objectManager.addGameObjectSet(t[1],null==a?void 0:a.gameObjects),DIVINESTAR.objectManager.addGameObjectSet(t[0],null==i?void 0:i.gameObjects),DIVINESTAR.levelModelManager.setModelUpdate(t[1],a.levelModels),DIVINESTAR.levelModelManager.setModelUpdate(t[0],i.levelModels)]),e.player.startMoving(),e.isReseting=!1,this.eventHooks.triggerHook("reset-after"),!0}calculateGameZone(e){return K(e)}cloneJson(e){return q(e)}degtoRad(e){return Math.PI/180*e}radToDeg(e){return 180/Math.PI*e}arrayEquals(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every((e,a)=>e===t[a])}getRange(e,t){return ea(e,t)}probability(e){return ei(e)}constructor(){this.camera=new ew,this.player=new eD,this.objectManager=new eP.a,this.actionManager=new eb,this.eventHooks=new I,this.playerPositionArrayBuffer=new Int32Array(20),this.playerZoneArrayBuffer=new Int32Array(20),this.debug=!1,this.rendering=!1,this.playerABSPosition={x:0,y:0,z:0},this.playerPreviousPositionArray=["0","0"],this.playerPositionArray=["200","0"],this.isReseting=!1,this.gameMode="infinite",this.unqiueId=()=>X()}}let eE="undefined"!=typeof self?self:a.g;async function eV(e){s=new eA,window.DSP=s,n(s.eventHooks),s.addHooks(),s.scene=e,s.player.createPlayer(),s.camera.buildCamera(),s.camera.attatchToPlayer(),s.initPhysics(),s.physicsObjectsManager.createObjects(),s.objectManager.init();let t=new P.Pa4(0,10,15);s.player.setPosition(t),setInterval(()=>{s.update()},15),s.rendering=!0}async function eM(){await s.startLevel(),s.player.enableControl(),s.player.startMoving()}eE.PlayerDependentObject=eu,eE.GameObject=ep,eE.JumpPad=em,eE.Dash=eS,eE.CheckPoint=ev,eE.GravitySwitch=eg,eE.Door=ef,eE.PointOrb=ey,eE.ActionNode=eI,eE.onerror=e=>{console.log(e),console.log(e.error),console.log("ERROR HAPPENED!")};let eR=new o({});window.DivineStar=eh;let ex=new eh;window.DIVINESTAR=ex,ex.fileHandler=eR,n(ex.eventHooks),window.onbeforeunload=e=>{ex.levelDataGenerator.closeWorker()},window.onbeforeunload=()=>{ex.eventHooks.triggerHook("program-refresh")};let ek=!1;async function eN(e){if(ek)return;ek=!0;let t=await eR.getDataAsStringAsync("settings/config.json");console.warn("SET UP CONFIG",t),ed(t,window),ex.setUpWorkers(),ex.setUpHooks(),await eV(e),await Promise.all([ex.languageManager.loadLanguageFile(),ex.levelManager.loadLevelData(),ex.profileManager.loadProfileData()]),ex.eventHooks.triggerHook("program-start"),ex.currentLevelData=await ex.fileHandler.getJSONFromFileAsync("data/leveldata/level1-infinite.json"),console.warn("START LEVEL",ex.currentLevelData);let a=new R;ex.levelManager.activeLevel=a,e.clearColor.set(.7,.7,.7,1),await a.createLevel(e,{seed1:crypto.randomUUID(),seed2:crypto.randomUUID(),seed3:crypto.randomUUID(),mode:"infinite",difficulity:"hard",hardcore:"false"}),ex.levelManager.inLevel=!0,await eM()}},9576:function(e,t,a){a.d(t,{$:function(){return s}});var i=a(29723);class s{_init(){let e=this;DIVINESTAR.scene&&(this.SPS=new i.Jyq("Physics",DIVINESTAR.scene,{useModelMaterial:!0,expandable:!0}),this.SPS.initParticles=()=>{for(let t=0;t<e.SPS.nbParticles;t++){let a=e.SPS.particles[t];a.position.z=-1e3,a.alive=!1}},this.SPS.counter=0,this.SPS.vars={needUpdate:!1,positionData:!1,needCull:!1,needResset:!1,positionDataLength:0,particleCount:1,updateData:{},updateDataCounts:{}},this.SPS.counter=0,this.SPS.updateParticle=t=>{this.SPS.counter++,e.SPS.vars.needCull&&(t.position.z<DIVINESTAR.playerABSPosition.z||t.position.z>DIVINESTAR.playerABSPosition.z+512)&&(t.position.z=-1e3,t.alive=!1);e:if(e.SPS.vars.needUpdate){if(t.position.z>DIVINESTAR.playerABSPosition.z&&t.position.z<DIVINESTAR.playerABSPosition.z+512)break e;let a=this.shapes[t.shapeId].modelid;if(e.SPS.vars.updateData[a]&&e.SPS.vars.updateDataCounts[a].current<e.SPS.vars.updateDataCounts[a].max){let i=e.SPS.vars.updateData[a][e.SPS.vars.updateDataCounts[a].current];(null==i?void 0:i.scaling)&&(t.scaling={...i.scaling}),t.position.x=i.position.x,t.position.y=i.position.y,t.position.z=i.position.z,t.rotation.x=i.rotation.x,t.rotation.y=i.rotation.y,t.rotation.z=i.rotation.z,t.alive=!0,e.SPS.vars.updateDataCounts[a].current++}}return e.SPS.counter>=e.SPS.nbParticles&&(e.SPS.vars.needCull=!1,e.SPS.vars.needUpdate=!1,e.SPS.counter=0,e.SPS.vars.updateData={},e.SPS.vars.updateDataCounts={}),t})}logPosition(){let e=this.SPS.nbParticles;for(;e--;)console.log(this.SPS.particles[e].position.z)}buildSPS(){this.SPS.initParticles(),this.mesh=this.SPS.buildMesh(),this.mesh.renderingGroupId=1,this.SPS.setParticles()}addShape(e,t,a){let i=this.particleCount,s=i+a;this.shapes[this.shapeCount]={id:this.shapeCount,modelid:e,counter:0,max:a,particleRange:[i,s]},this.SPS.addShape(t,a),this.shapeCount++,this.particleCount+=a}async resetAll(){return this.SPS.initParticles(),!0}setUpdate(e,t){for(let e in t)this.SPS.vars.updateDataCounts[e]={current:0,max:t[e].length};this.SPS.vars.needUpdate=!0,this.SPS.vars.updateData=t}cullParticles(){this.SPS.vars.needCull=!0}setAndBuild(){return this.SPS.setParticles(),this.SPS.refreshVisibleSize(),this.mesh.renderingGroupId=1,this.mesh}fullReset(){this.SPS.dispose(),this.SPS=null}constructor(e){this.shapes={},this.shapeCount=0,this.particleCount=0,this.id=e,this._init()}}},39019:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{T:function(){return LevelConstructor}});var _levelmodels_ManagedSPS__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(9576),_tools_debug__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(93914),_babylonjs_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(29723),_babylonjs_materials__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(71579);class LevelConstructor{fullReset(){this.currentLevelData={},this.spriteData={},this.currentLevelFile=""}async buildLevel(e,t){if(!DIVINESTAR.scene)return;if(this.currentLevelFile=e,void 0===e||""==e)throw"Level ID must not be blank!";var a=performance.now();let i=this;this.loadedAssets={};let[s,o,n,r]=await Promise.all([fetch("".concat(DIVINESTAR.fileHandler.basePath,"/data/globalassetdata.json")),fetch("".concat(DIVINESTAR.fileHandler.basePath,"/data/assetdata/").concat(t,"/assetdata.json")),fetch("".concat(DIVINESTAR.fileHandler.basePath,"/data/leveldata/").concat(e,".json")),fetch("".concat(DIVINESTAR.fileHandler.basePath,"/data/leveldata/").concat(t,"/structures/structures.json"))]),[l,c,h,d]=await Promise.all([s.json(),o.json(),n.json(),r.json()]);DIVINESTAR.assetData=l.assets;let p=Object.assign(c,DIVINESTAR.assetData);DIVINESTAR.assetData=p.assets,DIVINESTAR.currentLevelData=h,DIVINESTAR.currentLevelData.levelid,DIVINESTAR.levelStructuresData=d;let u=[],S=[];DIVINESTAR.levelStructuresData.includedStructuresFromFiles.forEach(e=>{let t=e.id;u.push(DIVINESTAR.levelStructuresData.structures["".concat(t)]);let a=fetch("".concat(DIVINESTAR.fileHandler.basePath,"/data/leveldata/").concat(e.file));S.push(a)}),u=await Promise.all(S);let g=new _babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.SpM(DIVINESTAR.scene);if(g.useDefaultLoadingScreen=!1,DIVINESTAR.gameMode=DIVINESTAR.currentLevelData.type,DIVINESTAR.currentLevelData.assets.levelModelIds.forEach(e=>{let t=DIVINESTAR.assetData.levelModels[e];DIVINESTAR.assetsManager.levelModelsData[e]=t;let a=g.addMeshTask("model","","".concat(DIVINESTAR.fileHandler.basePath,"/").concat(t.modelFolder),t.modelName);a.onSuccess=function(a){i.processLevelModel(a.loadedMeshes);let s=a.loadedMeshes[0];if(s.receiveShadows=!0,(null==s?void 0:s.material)&&(s.material.needDepthPrePass=!0,s.material.shadowLevel=1,s.material.receiveShadows=!0),s.cullingStrategy=_babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.x23.CULLINGSTRATEGY_BOUNDINGSPHERE_ONLY,DIVINESTAR.assetsManager.levelModels[e]=s,s.setEnabled(!1),s.position.z=-100,t.animatedTextures.length>0&&(null==s?void 0:s.material)&&s.material.subMaterials&&DIVINESTAR.animatedTextures.registerTexture(s.material.subMaterials[0].albedoTexture,t.animatedTextures[0].offset,t.animatedTextures[0].delay),null==t?void 0:t.ManagedSPS){let a=t.forms;if(DIVINESTAR.assetsManager.ManagedSPS[a])DIVINESTAR.assetsManager.ManagedSPS[a].addShape(e,s,t.InitCapacity);else{let i=new _levelmodels_ManagedSPS__WEBPACK_IMPORTED_MODULE_0__.$(t.forms);i.addShape(e,s,t.InitCapacity),DIVINESTAR.assetsManager.ManagedSPS[a]=i}}},a.onError=function(e,t,a){console.log("1"),console.log(t,a)}}),DIVINESTAR.currentLevelData.assets.environmentModelIds.forEach(e=>{let t=DIVINESTAR.assetData.environment.models[e],a=g.addMeshTask(t.id,"","".concat(DIVINESTAR.fileHandler.basePath,"/").concat(t.modelFolder),t.modelName);a.onSuccess=function(t){let a=t.loadedMeshes[0];DIVINESTAR.assetsManager.environmentModels[e]=a},a.onError=function(e,t,a){console.log("2"),console.log(t,a)}}),DIVINESTAR.currentLevelData.assets.modelIds.forEach(e=>{let t=DIVINESTAR.assetData.objects.models[e],a=g.addMeshTask(t.id,"","".concat(DIVINESTAR.fileHandler.basePath,"/").concat(t.modelFolder),t.modelName);a.onSuccess=function(a){i.updateGameObjectModel(a.loadedMeshes);let s=a.loadedMeshes[0];s.setEnabled(!1),s.position.z=-100,s.material&&(e.includes("dash")&&DIVINESTAR.RGBtoRatio(8.9375,229/16,23.4),e.includes("jump")&&DIVINESTAR.RGBtoRatio(6.25,6.25,10),DIVINESTAR.assetsManager.gameObjects[t.id]=s,DIVINESTAR.gameObjectSPS.addGameObject(t.id,s,t.capacity),t.animate&&s.material&&s.material.albedoTexture&&DIVINESTAR.animatedTextures.registerTexture(s.material.albedoTexture,t.animate.offset,t.animate.delay))},a.onError=function(e,t,a){console.log("3"),console.log(t,a)}}),console.log("sup"),DIVINESTAR.currentLevelData.environment.skybox,await g.loadAsync(),Object.keys(DIVINESTAR.assetsManager.ManagedSPS).forEach(e=>{DIVINESTAR.assetsManager.ManagedSPS[e].buildSPS()}),DIVINESTAR.gameObjectSPS.buildSPS(),await i.loadSprites(),"infinite"==DIVINESTAR.currentLevelData.type)return!0;DIVINESTAR.currentLevelData.resetPlanes.forEach(e=>{i.createResetPlane(e)}),await i.assembleLevelModels(),await i.assembleGameObjects(),console.log("%cLevel took "+((performance.now()-a)/1e3).toFixed(2)+" seconds to load.","color: purple; font-size: 25px;")}levelOneMtns(){_babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.n0n.ImportMesh(null,"./assets/models/1/terrain/","mtn1.babylon",DIVINESTAR.scene,function(e){let t=e[0];t.position.z=1e3,t.position.y=-20,t.position.x=220,t.scaling.x=60,t.scaling.y=50,t.scaling.z=25,DIVINESTAR.mtn=t,t.renderingGroupId=1;let a=t.createInstance("yep");a.position.x=-220,a.rotation.y=DIVINESTAR.degtoRad(180),DIVINESTAR.water.addToRenderList(t),DIVINESTAR.water.addToRenderList(a),DIVINESTAR.probe.renderList.push(t),DIVINESTAR.probe.renderList.push(a)})}newWaterMaterial(){let e=_babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.VO7.CreatePlane("plane",{width:800,height:600});e.position.y=-3,e.renderingGroupId=1,e.rotation.x=DIVINESTAR.degtoRad(90);var t=new _babylonjs_materials__WEBPACK_IMPORTED_MODULE_2__.Hv("water",DIVINESTAR.scene,new _babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.FM8(512,512));t.backFaceCulling=!0,t.bumpTexture=new _babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.xEZ("".concat(DIVINESTAR.fileHandler.basePath,"/assets/water/bumpnew.png"),DIVINESTAR.scene),t.windForce=-5,t.waveHeight=0,t.bumpHeight=.15,t.windDirection=new _babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.FM8(1,1),t.waterColor=new _babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.Wot(22/255,37/255,67/255),t.colorBlendFactor=.8,t.reflectionTexture._wrapU=1,t.reflectionTexture._wrapV=1,t.reflectionTexture._wrapR=1,t.reflectionTexture.pre=!1,t.reflectionTexture._prefiltered=!1,t.reflectionTexture.invertZ=!1,t.reflectionTexture._cachedUOffset=-1,t.reflectionTexture._cachedVOffset=-1,t.fogEnabled=!0,e.material=t,new _babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.xEZ("".concat(DIVINESTAR.fileHandler.basePath,"/assets/water/bumpnew.png"),DIVINESTAR.scene)._texture=t.reflectionTexture;var a=new _babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.Kj0.CreateGround("waterWaves",800,600,1e3,DIVINESTAR.scene,!0),i=new _babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.Kj0.CreateGround("waterWaves",800,600,1e3,DIVINESTAR.scene,!0);a.position.y=-3,a.renderingGroupId=1,i.position.y=-3,i.renderingGroupId=1;var s=new _babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.xNJ("main",512,DIVINESTAR.scene);return s.refreshRate=_babylonjs_core__WEBPACK_IMPORTED_MODULE_1__._iX.REFRESHRATE_RENDER_ONEVERYFRAME,DIVINESTAR.scene.customRenderTargets.push(s.cubeTexture),s.attachToMesh(a),_babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.Oie.ParseFromFileAsync("waterMaterial","".concat(DIVINESTAR.fileHandler.basePath,"/private/shaders/water.json"),DIVINESTAR.scene).then(e=>{e.name="waterMaterial",e.needDepthPrePass=!0,e.getBlockByName("causticMode").value=1,e.getBlockByName("Reflection texture").texture=t._reflectionRTT,e.getBlockByName("Probe texture").texture=s.cubeTexture,e.getBlockByName("waterDetails").texture=new _babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.xEZ("".concat(DIVINESTAR.fileHandler.basePath,"/assets/water/bumpnew.png"),DIVINESTAR.scene),e.getBlockByName("VeronoiScale"),e.getBlockByName("Water Color").value={r:40/255,g:40/255,b:47/255},e.getBlockByName("FoamColor").value={r:20/255,g:20/255,b:25/255},e.getBlockByName("FoamLevel").value=10,e.getBlockByName("verenoiHeight").value=.14,e.getBlockByName("fogColor").value={r:.3,g:.3,b:.3},a.material=e,i.material=e}).fogEnabled=!0,a.fogEnabled=!0,a.hasAlpha=!0,i.fogEnabled=!0,i.hasAlpha=!0,e.getVerticesData(_babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.oZy.PositionKind),a.getVerticesData(_babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.oZy.PositionKind),DIVINESTAR.scene.registerBeforeRender(function(){t.reflectionTexture._prefiltered=!0}),{water:t,waterWaves:a,waterWaves2:i,waterMesh:e,reflectionProbe:s}}async addLevelOneStuff(){if(!DIVINESTAR.scene)return;var e=new _babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.Ox3("DirectionalLight",new _babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.Pa4(0,-1,1),DIVINESTAR.scene);e.diffuse=new _babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.Wot(.6,.8,.8),e.specular=new _babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.Wot(0,1,0),e.intensity=1.5,DIVINESTAR.mainLight=e;var t=new _babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.uXA(1024,e);t.bias=0;let a=this.newWaterMaterial(),i=a.water,s=a.waterMesh,o=a.reflectionProbe,n=a.waterWaves,r=a.waterWaves2;o.renderList.push(DIVINESTAR.assetsManager.skyBox),i.addToRenderList(DIVINESTAR.assetsManager.skyBox),s.renderingGroupId=1,s.material=i,s.position.y=-3,n.position.z=0,s.position.z=0;let l=s.createInstance("water2");return l.position.z=599.5,r.position.z=599.5,s.receiveShadows=!0,Object.keys(DIVINESTAR.assetsManager.ManagedSPS).forEach(e=>{let a=DIVINESTAR.assetsManager.ManagedSPS[e];i.addToRenderList(a.setAndBuild()),t.addShadowCaster(a.mesh),a.mesh.receiveShadows=!0,a.mesh.material.receiveShadows=!0,n.receiveShadows=!0}),DIVINESTAR.waterWaves=n,DIVINESTAR.waterMesh=s,DIVINESTAR.waterWaves2=r,DIVINESTAR.waterMesh2=l,DIVINESTAR.water=i,DIVINESTAR.probe=o,!0}loadSprites(){if(DIVINESTAR.scene)return new Promise(function(e,t){DIVINESTAR.currentLevelData.assets.spriteIds.forEach(e=>{DIVINESTAR.assetsManager.sprites[e]=!1});var a=()=>{setTimeout(()=>{let t=!0;DIVINESTAR.currentLevelData.assets.spriteIds.forEach(e=>{!1==DIVINESTAR.assetsManager.sprites[e]&&(t=!1)}),t?e(!0):a()},10)};a(),DIVINESTAR.currentLevelData.assets.spriteIds.forEach(e=>{let t=DIVINESTAR.assetData.objects.sprites[e];if(!DIVINESTAR.scene)return;let a=new _babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.ZmM("".concat(e,"-sm"),"".concat(DIVINESTAR.fileHandler.basePath,"/").concat(t.location),t.capacity,{width:t.animate.width,height:t.animate.height},DIVINESTAR.scene);a.renderingGroupId=1,a.isPickable=!0,a.texture.onLoadObservable.add(()=>{a.texture.updateSamplingMode(_babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.xEZ.NEAREST_NEAREST_MIPLINEAR),DIVINESTAR.assetsManager.sprites[e]=a})})})}createResetPlane(e){if(!DIVINESTAR.scene)return;let t=new _babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.KuD("mat1",DIVINESTAR.scene);t.diffuseColor.copyFromFloats(0,0,0),t.backFaceCulling=!1;let a=_babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.VO7.CreateGround("death1",{width:e.width,height:e.length},DIVINESTAR.scene);a.material=t,a.checkCollisions=!0,a.isPickable=!0,a.isVisible=!0,DIVINESTAR.debug,a.visibility=0,a.position.x=e.position.x,a.position.y=e.position.y,a.position.z=e.position.z,a.renderingGroupId=1}createSkyBox(){if(!DIVINESTAR.scene)return;let e=(0,_babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.QkU)("skyBox",{diameter:800},DIVINESTAR.scene),t=new _babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.KuD("skyBox",DIVINESTAR.scene);t.backFaceCulling=!1,t.diffuseColor=new _babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.Wot(.1,.1,.1),t.specularColor=new _babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.Wot(0,0,0),e.material=t,e.isPickable=!1,e.infiniteDistance=!0,e.renderingGroupId=0,e.disableLighting=!1,DIVINESTAR.assetsManager.skyBox=e}assembleLevelModels(){return new Promise(function(e,t){DIVINESTAR.currentLevelData.levelModels.forEach(e=>{let t="".concat(e.modelId,"-").concat(e.position.x,"-").concat(e.position.y,"-").concat(e.position.z,"--").concat(e.rotation.x,"-").concat(e.rotation.y,"-").concat(e.rotation.z);e.id=t;let a=100*Math.ceil(e.position.z/100);for(let t=0;t<3;t++)if((a=100+a)%200==0){let t=a-200,i="".concat(t);if(DIVINESTAR.levelModelManager.levelModelLocationsData[i]){DIVINESTAR.levelModelManager.levelModelLocationsData[i].push(e);break}DIVINESTAR.levelModelManager.levelModelLocationsData[i]=[],DIVINESTAR.levelModelManager.levelModelLocationsData[i]=[],DIVINESTAR.levelModelManager.levelModelLocationsData[i].push(e);break}}),e(!0)})}assembleGameObjects(){let levelConstructor=this,promise=new Promise(function(resolve,reject){DIVINESTAR.currentLevelData.objects.forEach((data,index)=>{if(data.className){let objClass=eval(data.className);var gameObject=!1;if(data.modelid){var newModel=DIVINESTAR.assetsManager.gameObjects[data.modelid].createInstance("index: "+index);gameObject=new objClass(index,data,newModel),newModel.setEnabled(!0)}else if(data.spriteid){let sprite=new _babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.jyi("sprite",DIVINESTAR.assetsManager.sprites[data.spriteid]);sprite.cellIndex=0,sprite.width=DIVINESTAR.assetData.objects.sprites[data.spriteid].widthScale,sprite.height=DIVINESTAR.assetData.objects.sprites[data.spriteid].heightScale,sprite.isPickable=!0,gameObject=new objClass(index,data,sprite)}else"actionNode"==data.type&&(gameObject=new objClass(index,data));let modelZ=data.position.z,zStart=100*Math.ceil(modelZ/100);for(let index=0;index<3;index++)if((zStart=100+zStart)%200==0){let idNum=zStart-200,id="".concat(idNum);if(DIVINESTAR.objectManager.loadedObjectsLocations[id]){DIVINESTAR.objectManager.loadedObjectsLocations[id].push(gameObject);break}DIVINESTAR.objectManager.loadedObjectsLocations[id]=[],DIVINESTAR.objectManager.loadedObjectsLocations[id].push(gameObject);break}DIVINESTAR.objectManager.addObject("".concat(index,"-").concat(data.type),gameObject)}}),resolve(!0)});return promise}updateGameObjectModel(e){DIVINESTAR.scene&&((0,_tools_debug__WEBPACK_IMPORTED_MODULE_3__.J)("Update game object model",e),e.forEach((e,t)=>{let a=e.material;(0,_tools_debug__WEBPACK_IMPORTED_MODULE_3__.J)("Made it here ⚠️⚠️⚠️⚠️⚠️⚠️");var i=a.albedoTexture.url;if(a.albedoTexture.hasAlpha=!0,a.useAlphaFromAlbedoTexture=!0,a.maxSimultaneousLights=200,a.transparencyMode=_babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.YVB.MATERIAL_ALPHATEST,e.position=new _babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.Pa4(-1,37,125),e.isPickable=!0,e.checkCollisions=!0,e.renderingGroupId=1,a.samplingMode=_babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.xEZ.NEAREST_SAMPLINGMODE,!DIVINESTAR.scene)return;let s=new _babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.xEZ(i,DIVINESTAR.scene);s.onLoadObservable.add(()=>{s.updateSamplingMode(_babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.xEZ.NEAREST_NEAREST_MIPLINEAR)}),s.anisotropicFilteringLevel=0}))}processLevelModel(e){if(!DIVINESTAR.scene)return;let t=[];e.length,e.forEach((e,a)=>{if(e.name.includes("Default")?(e.isPickable=!0,e.renderingGroupId=1,e.checkCollisions=!0):e.name.includes("pillar")||e.name.includes("cube")?(e.isPickable=!0,e.checkCollisions=!0):(e.isPickable=!1,e.checkCollisions=!1),e.material.subMaterials&&e.material.subMaterials.length>0)e.material.subMaterials.forEach((a,i)=>{if(e.material.backFaceCulling=!0,null!=a.albedoTexture){let e=a.albedoTexture.url;if(a.albedoTexture.hasAlpha=!0,a.useAlphaFromAlbedoTexture=!0,a.maxSimultaneousLights=200,a.transparencyMode=_babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.YVB.MATERIAL_ALPHATEST,null==t[e]){if(a.samplingMode=_babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.xEZ.NEAREST_SAMPLINGMODE,!DIVINESTAR.scene)return;let t=new _babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.xEZ(e,DIVINESTAR.scene);t.onLoadObservable.add(()=>{t.updateSamplingMode(_babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.xEZ.NEAREST_NEAREST_MIPLINEAR)}),t.anisotropicFilteringLevel=0}}});else{let a=e.material;if(a.maxSimultaneousLights=200,a.backFaceCulling=!0,null!=a.albedoTexture){a.reflectionTexture=a.albedoTexture;let e=a.albedoTexture.url;if(a.albedoTexture.hasAlpha=!0,a.useAlphaFromAlbedoTexture=!0,a.transparencyMode=_babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.YVB.MATERIAL_ALPHATEST,null==t[e]){if(a.samplingMode=_babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.xEZ.NEAREST_SAMPLINGMODE,!DIVINESTAR.scene)return;let t=new _babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.xEZ(e,DIVINESTAR.scene);t.onLoadObservable.add(()=>{t.updateSamplingMode(_babylonjs_core__WEBPACK_IMPORTED_MODULE_1__.xEZ.NEAREST_NEAREST_MIPLINEAR)}),t.anisotropicFilteringLevel=0}}}})}constructor(){}}},47079:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{a:function(){return ObjectManager}});var _babylonjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(29723);class ObjectManager{fullReset(){this.loadedObjects={},this.loadedObjectsLocations={},this.objectLocationsData={}}addObject(e,t){this.loadedObjects[e]=t}update(){let e=DIVINESTAR.playerPositionArray[1],t=this.loadedObjectsLocations[e];for(let e in t){let a=t[e];a.update&&a.update()}}async addGameObjectSet(e,t){return this.loadedObjectsLocations[e]||(this.loadedObjectsLocations[e]=[]),DIVINESTAR.gameObjectSPS.setUpdate(e,t),DIVINESTAR.gameObjectSPS.setAndBuild(),!0}addGameObject(data){let gameObject=!1;if(this.physicsWorker){let idIndex="".concat(data.className,"-").concat(data.position.x,"-").concat(data.position.y,"-").concat(data.position.z),objClass=eval(data.className);if("actionNode"==data.type)gameObject=new objClass(idIndex,data);else{let newModel=(0,_babylonjs_core__WEBPACK_IMPORTED_MODULE_0__.NRF)("box",{height:.5,width:2,depth:2},DIVINESTAR.scene);newModel.renderingGroupId=1,gameObject=new objClass(idIndex,data,newModel)}DIVINESTAR.objectManager.addObject("".concat(idIndex,"-").concat(data.type),gameObject)}else if(data.className){let objClass=eval(data.className),idIndex="".concat(data.modelid,"-").concat(data.position.x,"-").concat(data.position.y,"-").concat(data.position.z);if(data.modelid){var newModel=DIVINESTAR.assetsManager.gameObjects[data.modelid].createInstance(idIndex);gameObject=new objClass(idIndex,data,newModel)}else if(data.spriteid){let idIndex="".concat(data.spriteid,"-").concat(data.position.x,"-").concat(data.position.y,"-").concat(data.position.z),sprite=new _babylonjs_core__WEBPACK_IMPORTED_MODULE_0__.jyi("sprite",DIVINESTAR.assetsManager.sprites[data.spriteid]);sprite.cellIndex=0,sprite.width=DIVINESTAR.assetData.objects.sprites[data.spriteid].widthScale,sprite.height=DIVINESTAR.assetData.objects.sprites[data.spriteid].heightScale,sprite.isPickable=!0,gameObject=new objClass(idIndex,data,sprite)}else"actionNode"==data.type&&(gameObject=new objClass("".concat(data.type,"-").concat(data.position.x,"-").concat(data.position.y,"-").concat(data.position.z),data));DIVINESTAR.objectManager.addObject("".concat(idIndex,"-").concat(data.type),gameObject)}return gameObject}constructor(e=!1){this.loadedObjects={},this.loadedObjectsLocations={},this.objectLocationsData={},this.physicsWorker=!1,this.loadedObjects={},this.loadedObjectsLocations=[],this.objectLocationsData=[],this.physicsWorker=e}}},84887:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{a:function(){return ObjectManager}});var _babylonjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(29723);class ObjectManager{registerGameObject(e,t){this.aviableObjects[e]=t}init(){let e=100;for(;e--;)this.nodes[e]=new _babylonjs_core__WEBPACK_IMPORTED_MODULE_0__.YOI("node-".concat(e),DSP.scene),this.nodes[e].position.z=-1e3,this.nodes[e].position.y=-1e3,this.nodes[e].used=!1}addObject(e,t){this.loadedObjects[e]=t}update(){let e=DSP.playerPositionArray[1],t=this.loadedObjectsLocations[e];for(let e in t){let a=t[e];a.update&&a.update()}}fullReset(){this.loadedObjectsLocations.forEach((e,t)=>{e&&(e.forEach((e,a)=>{e.model.position.z=-1e3,e.model.position.y=-1e3,e=null,this.loadedObjectsLocations[t][a]=null,delete this.loadedObjectsLocations[t][a]}),this.loadedObjectsLocations[t]=null,delete this.loadedObjectsLocations[t])});let e=50;for(;e--;)this.nodes[e].used=!1;return this.pointOrbs={},this.checkPoints={},this.loadedObjectsLocations=[],this.loadedObjects={},this.objectLocationsData={},!0}async reset(){this.loadedObjectsLocations.forEach((e,t)=>{e&&(e.forEach((e,a)=>{e.model.position.z=-1e3,e.model.position.y=-1e3,e=null,this.loadedObjectsLocations[t][a]=null}),this.loadedObjectsLocations[t]=null)});let e=50;for(;e--;)this.nodes[e].used=!1;return!0}async removeGameZone(e){if(this.loadedObjectsLocations[e])return this.loadedObjectsLocations[e].forEach((t,a)=>{t.model.position.z=-1e3,t.model.position.y=-1e3,t.model.used=!1,t=null,this.loadedObjectsLocations[e][a]=null}),this.loadedObjectsLocations[e]=null,!0}async addGameObjectSet(zone,set){this.loadedObjectsLocations[zone]||(this.loadedObjectsLocations[zone]=[]);let self=this,nodeCount=50;for(let model in set)for(let objectid in set[model]){let data=set[model][objectid],idIndex="".concat(data.className,"-").concat(data.position.x,"-").concat(data.position.y,"-").concat(data.position.z),objClass=eval(data.className);if("PointOrb"==data.className){let exist=!1;if(this.pointOrbs[zone]?exist=!0:this.pointOrbs[zone]={},exist&&this.pointOrbs[zone][data.id])continue;this.pointOrbs[zone][data.id]=!1}if("CheckPoint"==data.className){let exist=!1;if(this.checkPoints[zone]?exist=!0:this.checkPoints[zone]={},exist&&this.checkPoints[zone][data.id])continue;this.checkPoints[zone][data.id]=!1}let newModel=this.nodes[0];for(;nodeCount--;)if(!this.nodes[nodeCount].used){newModel=this.nodes[nodeCount],this.nodes[nodeCount].used=!0,newModel.position=new _babylonjs_core__WEBPACK_IMPORTED_MODULE_0__.Pa4(data.position.x,data.position.y,data.position.z);break}let newObject=new objClass(idIndex,data,newModel);newObject&&self.loadedObjectsLocations[zone].push(newObject)}return!0}updatePointOrb(e,t){let a=DSP.calculateGameZone(e.z)[1];this.pointOrbs[a][t]=!0}updateCheckPoint(e,t){let a=DSP.calculateGameZone(e.z)[1];this.checkPoints[a][t]=!0,console.log(a)}addGameObject(data){let gameObject=!1;if(this.physicsWorker){let idIndex="".concat(data.className,"-").concat(data.position.x,"-").concat(data.position.y,"-").concat(data.position.z),objClass=eval(data.className);gameObject="actionNode"==data.type?new objClass(idIndex,data):new objClass(idIndex,data,this.nodes[0]),DSP.objectManager.addObject("".concat(idIndex,"-").concat(data.type),gameObject)}return gameObject}constructor(e=!0){this.aviableObjects={},this.loadedObjects={},this.loadedObjectsLocations=[],this.objectLocationsData={},this.physicsWorker=!0,this.pointOrbs={},this.checkPoints={},this.nodes={},this.loadedObjects={},this.objectLocationsData=[],this.physicsWorker=e}}},93914:function(e,t,a){a.d(t,{J:function(){return i}});function i(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]}}}]);